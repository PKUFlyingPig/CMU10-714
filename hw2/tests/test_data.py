import sys
sys.path.append("./python")
import needle as ndl
import numpy as np

import mugrade


def test_flip_horizontal():
    tform = ndl.data.RandomFlipHorizontal()
    np.random.seed(0)
    a = np.array([[[0.6788795301189603, 0.7206326547259168, 0.5820197920751071, 0.5373732294490107, 0.7586156243223572], [0.10590760718779213, 0.4736004193466574, 0.18633234332675996, 0.7369181771289581, 0.21655035442437187]], [[0.13521817340545206, 0.3241410077932141, 0.14967486718368317, 0.22232138825158765, 0.38648898112586194], [0.9025984755294046, 0.4499499899112276, 0.6130634578841324, 0.9023485831739843, 0.09928035035897387]], [[0.9698090677467488, 0.6531400357979377, 0.17090958513604515, 0.358152166969525, 0.7506861412184562], [0.6078306687154678, 0.3250472290083525, 0.038425426472734725, 0.634274057957335, 0.9589492686245203]], [[0.6527903170054908, 0.6350588736035638, 0.9952995676778876, 0.5818503294385343, 0.4143685882263688], [0.4746975022884129, 0.6235101011318682, 0.33800761483889175, 0.6747523222590207, 0.3172017420692961]], [[0.778345482025909, 0.9495710534507421, 0.6625268669500443, 0.013571635612109834, 0.6228460955466695], [0.6736596308357894, 0.9719450024996658, 0.878193471347177, 0.5096243767199001, 0.05571469370160631]], [[0.4511592145209281, 0.019987665408758737, 0.44171092124884537, 0.9795867288127285, 0.3594444639693215], [0.4808935308361628, 0.6886611828057704, 0.8804758892525955, 0.9182354663621447, 0.21682213762754288]]])
    b = np.array([[[0.6788795301189603, 0.7206326547259168, 0.5820197920751071, 0.5373732294490107, 0.7586156243223572], [0.10590760718779213, 0.4736004193466574, 0.18633234332675996, 0.7369181771289581, 0.21655035442437187]], [[0.13521817340545206, 0.3241410077932141, 0.14967486718368317, 0.22232138825158765, 0.38648898112586194], [0.9025984755294046, 0.4499499899112276, 0.6130634578841324, 0.9023485831739843, 0.09928035035897387]], [[0.9698090677467488, 0.6531400357979377, 0.17090958513604515, 0.358152166969525, 0.7506861412184562], [0.6078306687154678, 0.3250472290083525, 0.038425426472734725, 0.634274057957335, 0.9589492686245203]], [[0.6527903170054908, 0.6350588736035638, 0.9952995676778876, 0.5818503294385343, 0.4143685882263688], [0.4746975022884129, 0.6235101011318682, 0.33800761483889175, 0.6747523222590207, 0.3172017420692961]], [[0.778345482025909, 0.9495710534507421, 0.6625268669500443, 0.013571635612109834, 0.6228460955466695], [0.6736596308357894, 0.9719450024996658, 0.878193471347177, 0.5096243767199001, 0.05571469370160631]], [[0.4511592145209281, 0.019987665408758737, 0.44171092124884537, 0.9795867288127285, 0.3594444639693215], [0.4808935308361628, 0.6886611828057704, 0.8804758892525955, 0.9182354663621447, 0.21682213762754288]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.5651888666048753, 0.865102561305385, 0.5089689606670145], [0.9167229540194608, 0.9211576102371998, 0.08311249263060239], [0.27771856128103245, 0.009356704856532616, 0.842342079667731], [0.6471741401875555, 0.8413861191973544, 0.26473016428344964], [0.39782075275862905, 0.5528214798875715, 0.16494046024188413]], [[0.36980809274834003, 0.14644176272911225, 0.5696184059233067], [0.7037372792899163, 0.28847643704852866, 0.43328806198204406], [0.7561066938650409, 0.3960982754233623, 0.896038387509077], [0.6389210762313129, 0.8915544372256771, 0.6800555694634123], [0.44919773821837206, 0.978570928420717, 0.1162019096123944]], [[0.7670237035587267, 0.4118201389648447, 0.675439081200236], [0.24979627565497808, 0.31321833194595095, 0.965416220519927], [0.5884650850687494, 0.6596684120694128, 0.5332062539166482], [0.23053302350632987, 0.39486929345022914, 0.6188085645913571], [0.474867515408942, 0.47013218925576516, 0.7160745312286432]], [[0.2879910043632805, 0.38346222503494787, 0.7491698371527247], [0.878452190276042, 0.10286335869343821, 0.0923738894608982], [0.3540466620838102, 0.5518162591332588, 0.033625093498832026], [0.9689617652602737, 0.3209972413734975, 0.22126268518378278], [0.1412639049258967, 0.09725992706317388, 0.9840422413641464]], [[0.2603409275874047, 0.5370225213757797, 0.4479261718707299], [0.09956908911081108, 0.35231166120053303, 0.46924917399024213], [0.8411401297855995, 0.9046477442095134, 0.03755938382814028], [0.5083154485788909, 0.16684751304849965, 0.7790510196090357], [0.8649332956024927, 0.41139672375545455, 0.13997258549320168]]])
    b = np.array([[[0.5651888666048753, 0.865102561305385, 0.5089689606670145], [0.9167229540194608, 0.9211576102371998, 0.08311249263060239], [0.27771856128103245, 0.009356704856532616, 0.842342079667731], [0.6471741401875555, 0.8413861191973544, 0.26473016428344964], [0.39782075275862905, 0.5528214798875715, 0.16494046024188413]], [[0.36980809274834003, 0.14644176272911225, 0.5696184059233067], [0.7037372792899163, 0.28847643704852866, 0.43328806198204406], [0.7561066938650409, 0.3960982754233623, 0.896038387509077], [0.6389210762313129, 0.8915544372256771, 0.6800555694634123], [0.44919773821837206, 0.978570928420717, 0.1162019096123944]], [[0.7670237035587267, 0.4118201389648447, 0.675439081200236], [0.24979627565497808, 0.31321833194595095, 0.965416220519927], [0.5884650850687494, 0.6596684120694128, 0.5332062539166482], [0.23053302350632987, 0.39486929345022914, 0.6188085645913571], [0.474867515408942, 0.47013218925576516, 0.7160745312286432]], [[0.2879910043632805, 0.38346222503494787, 0.7491698371527247], [0.878452190276042, 0.10286335869343821, 0.0923738894608982], [0.3540466620838102, 0.5518162591332588, 0.033625093498832026], [0.9689617652602737, 0.3209972413734975, 0.22126268518378278], [0.1412639049258967, 0.09725992706317388, 0.9840422413641464]], [[0.2603409275874047, 0.5370225213757797, 0.4479261718707299], [0.09956908911081108, 0.35231166120053303, 0.46924917399024213], [0.8411401297855995, 0.9046477442095134, 0.03755938382814028], [0.5083154485788909, 0.16684751304849965, 0.7790510196090357], [0.8649332956024927, 0.41139672375545455, 0.13997258549320168]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.03322238526617727, 0.9825749598251936, 0.3732907507832548, 0.42007536979061066, 0.050588115054237215, 0.36549610626341034], [0.016627973733867263, 0.23074233540679567, 0.7649116989968572, 0.9441235194354546, 0.7499992487701004, 0.3394038194495186], [0.4895489368910937, 0.3389851167797783, 0.1794902609178557, 0.17098659868313149, 0.46345097738448293, 0.8745729576449965], [0.9441197509175635, 0.608252865854013, 0.5966554062950531, 0.7836442453018885, 0.5000262977293014, 0.0503700567575438]], [[0.6990980747185112, 0.9923963988886326, 0.26726253788147825, 0.6790906156274139, 0.8642814426862446, 0.7508442456284316], [0.9644897677894309, 0.5542424350844403, 0.2123904988903086, 0.22244322438681874, 0.21874937373677183, 0.569573534574738], [0.4521090350334257, 0.9702366830961006, 0.6805446911927795, 0.08529556585870057, 0.056418332713966235, 0.48783770435896423], [0.8810045622016749, 0.9764043865930425, 0.6176579160958802, 0.5424987750103974, 0.8546135803107144, 0.7438345453097878]], [[0.4785963256187501, 0.6770815740270854, 0.6070450611164516, 0.7146969362373571, 0.46949718309117094, 0.45601462321786723], [0.9064180870601711, 0.1372204200971946, 0.22921932308657944, 0.8815853992105808, 0.9044249756892315, 0.6457845985018992], [0.32468297206646535, 0.5197111936582762, 5.535686500857118e-05, 0.3118602206821891, 0.42545153795217594, 0.8853376596095855], [0.6798794564067695, 0.456129772122862, 0.48340861659875267, 0.7887394275320365, 0.22944183447104538, 0.8802976031150046]], [[0.3136923925080297, 0.9574508556589537, 0.4717515708928012, 0.7115838170608139, 0.15369430500779646, 0.7304421765667943], [0.6462644373146849, 0.21488073675057817, 0.1864582194893385, 0.8075802688587874, 0.7470794701392341, 0.6748473459286921], [0.276893750817091, 0.17490887430950752, 0.704474258393494, 0.4631501999901332, 0.8404285325354325, 0.20486576218044572], [0.1649588680867573, 0.124833057490086, 0.7220806624027486, 0.030452964941600325, 0.7469942401995034, 0.09259616511851354]], [[0.21745049270557182, 0.7492544170632397, 0.7316937564646905, 0.04561463715088643, 0.20915702948084114, 0.2869150433006046], [0.6772633053384269, 0.06303828966937675, 0.5556492427701452, 0.009240073486540767, 0.8330380975093908, 0.984329434348122], [0.7034947841347021, 0.18163120049204873, 0.5123934632959037, 0.5804471371881301, 0.7875421559550259, 0.6064754600685757], [0.2184028548119228, 0.4551688151933373, 0.8788697417774708, 0.4922682415051587, 0.7155611574590398, 0.48615956031119767]]])
    b = np.array([[[0.03322238526617727, 0.9825749598251936, 0.3732907507832548, 0.42007536979061066, 0.050588115054237215, 0.36549610626341034], [0.016627973733867263, 0.23074233540679567, 0.7649116989968572, 0.9441235194354546, 0.7499992487701004, 0.3394038194495186], [0.4895489368910937, 0.3389851167797783, 0.1794902609178557, 0.17098659868313149, 0.46345097738448293, 0.8745729576449965], [0.9441197509175635, 0.608252865854013, 0.5966554062950531, 0.7836442453018885, 0.5000262977293014, 0.0503700567575438]], [[0.6990980747185112, 0.9923963988886326, 0.26726253788147825, 0.6790906156274139, 0.8642814426862446, 0.7508442456284316], [0.9644897677894309, 0.5542424350844403, 0.2123904988903086, 0.22244322438681874, 0.21874937373677183, 0.569573534574738], [0.4521090350334257, 0.9702366830961006, 0.6805446911927795, 0.08529556585870057, 0.056418332713966235, 0.48783770435896423], [0.8810045622016749, 0.9764043865930425, 0.6176579160958802, 0.5424987750103974, 0.8546135803107144, 0.7438345453097878]], [[0.4785963256187501, 0.6770815740270854, 0.6070450611164516, 0.7146969362373571, 0.46949718309117094, 0.45601462321786723], [0.9064180870601711, 0.1372204200971946, 0.22921932308657944, 0.8815853992105808, 0.9044249756892315, 0.6457845985018992], [0.32468297206646535, 0.5197111936582762, 5.535686500857118e-05, 0.3118602206821891, 0.42545153795217594, 0.8853376596095855], [0.6798794564067695, 0.456129772122862, 0.48340861659875267, 0.7887394275320365, 0.22944183447104538, 0.8802976031150046]], [[0.3136923925080297, 0.9574508556589537, 0.4717515708928012, 0.7115838170608139, 0.15369430500779646, 0.7304421765667943], [0.6462644373146849, 0.21488073675057817, 0.1864582194893385, 0.8075802688587874, 0.7470794701392341, 0.6748473459286921], [0.276893750817091, 0.17490887430950752, 0.704474258393494, 0.4631501999901332, 0.8404285325354325, 0.20486576218044572], [0.1649588680867573, 0.124833057490086, 0.7220806624027486, 0.030452964941600325, 0.7469942401995034, 0.09259616511851354]], [[0.21745049270557182, 0.7492544170632397, 0.7316937564646905, 0.04561463715088643, 0.20915702948084114, 0.2869150433006046], [0.6772633053384269, 0.06303828966937675, 0.5556492427701452, 0.009240073486540767, 0.8330380975093908, 0.984329434348122], [0.7034947841347021, 0.18163120049204873, 0.5123934632959037, 0.5804471371881301, 0.7875421559550259, 0.6064754600685757], [0.2184028548119228, 0.4551688151933373, 0.8788697417774708, 0.4922682415051587, 0.7155611574590398, 0.48615956031119767]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.708548150020003, 0.49814022550747006, 0.8445500794719424, 0.1943422229429832, 0.7733260096105699, 0.9742586638572328], [0.862309777350283, 0.7804266511040134, 0.9850322788832359, 0.753569606672163, 0.004048106368426341, 0.2694794339581177]], [[0.41049213809445695, 0.42822383211640813, 0.2978418185550563, 0.40113234155862765, 0.12065699118611972, 0.9806996740240193], [0.40612049298131103, 0.5692107600936255, 0.3436055031480987, 0.7888727777194641, 0.4113724140379379, 0.3592714170600857]]])
    b = np.array([[[0.708548150020003, 0.49814022550747006, 0.8445500794719424, 0.1943422229429832, 0.7733260096105699, 0.9742586638572328], [0.862309777350283, 0.7804266511040134, 0.9850322788832359, 0.753569606672163, 0.004048106368426341, 0.2694794339581177]], [[0.41049213809445695, 0.42822383211640813, 0.2978418185550563, 0.40113234155862765, 0.12065699118611972, 0.9806996740240193], [0.40612049298131103, 0.5692107600936255, 0.3436055031480987, 0.7888727777194641, 0.4113724140379379, 0.3592714170600857]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.3994989103160902, 0.30183087592751656], [0.7752197774666111, 0.9262129301763149], [0.3253103051589964, 0.9528706723868426]], [[0.013948395933415347, 0.5334656817509289], [0.3045820306759077, 0.882859998043791], [0.25062272019388543, 0.6774118294719442]], [[0.8104240912598908, 0.4321480499248166], [0.7521345209879338, 0.8296022479277191], [0.37903377210381817, 0.09654960982745808]], [[0.25613957741471227, 0.5919351581884497], [0.47647720054983067, 0.4879345689871769], [0.4585145522366506, 0.5245926207548479]]])
    b = np.array([[[0.3253103051589964, 0.9528706723868426], [0.7752197774666111, 0.9262129301763149], [0.3994989103160902, 0.30183087592751656]], [[0.25062272019388543, 0.6774118294719442], [0.3045820306759077, 0.882859998043791], [0.013948395933415347, 0.5334656817509289]], [[0.37903377210381817, 0.09654960982745808], [0.7521345209879338, 0.8296022479277191], [0.8104240912598908, 0.4321480499248166]], [[0.4585145522366506, 0.5245926207548479], [0.47647720054983067, 0.4879345689871769], [0.25613957741471227, 0.5919351581884497]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.44201531779487013, 0.85263492378234], [0.43343897446935586, 0.8268703682806414], [0.5093420653681867, 0.08637698037064123]], [[0.660039862222949, 0.20659460707526944], [0.8472753225073781, 0.6813591290967357], [0.17836734931031717, 0.06985901733934607]], [[0.009688170796795847, 0.8920496580813289], [0.1334652095813622, 0.7791919742513885], [0.9251634258375487, 0.7151787489637426]]])
    b = np.array([[[0.44201531779487013, 0.85263492378234], [0.43343897446935586, 0.8268703682806414], [0.5093420653681867, 0.08637698037064123]], [[0.660039862222949, 0.20659460707526944], [0.8472753225073781, 0.6813591290967357], [0.17836734931031717, 0.06985901733934607]], [[0.009688170796795847, 0.8920496580813289], [0.1334652095813622, 0.7791919742513885], [0.9251634258375487, 0.7151787489637426]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.4908186128508779, 0.4694983029278751, 0.8827092893929042, 0.4884100599403899, 0.4145674851494531], [0.17411195222713227, 0.475289441908616, 0.7836479651212873, 0.5564294271917406, 0.15986708206070577], [0.14382936568105598, 0.649463029783935, 0.5392235974137527, 0.32568476641681543, 0.14701389488880123], [0.1598700671429253, 0.12941233742225133, 0.5789223875388946, 0.09226017040693324, 0.9105447223934636], [0.08297174765619597, 0.8003784621072384, 0.8771309658812383, 0.09345945644411735, 0.4263058803232388], [0.47322067394571043, 0.5801971057632594, 0.7162441742180187, 0.027068984777190108, 0.7313973399998267]], [[0.7669635054509254, 0.009766435596283318, 0.30828616737698467, 0.23286547108097988, 0.5034274279399525], [0.9537213806638318, 0.5578113008828718, 0.09746868872548986, 0.6216784907560882, 0.86302261666035], [0.1576322757366576, 0.9924295232856558, 0.08500106751482528, 0.09445791415049454, 0.6336078897001911], [0.9492974733018349, 0.9367464737894553, 0.4473782946071331, 0.7276963431316488, 0.7422379779316829], [0.30698605596261264, 0.11977134909755616, 0.4438786756746984, 0.39177431923395767, 0.5318491770716929], [0.8453576818202398, 0.5362745443678752, 0.6802701510460296, 0.609177581558388, 0.09847800336397083]], [[0.09202758561195723, 0.055965828349447855, 0.08653249019938802, 0.23717329363871142, 0.8395129668196633], [0.5223705322713111, 0.5130748631715455, 0.6498319735234533, 0.5445908773835076, 0.03246529565126377], [0.5801517162709772, 0.7710890481699647, 0.3762265742721872, 0.49102474090072723, 0.9816396804040689], [0.24465141426217707, 0.3743231966372207, 0.04565964198897843, 0.3100676399689497, 0.8315193998721372], [0.807022835987101, 0.6400241552994383, 0.3681024019815341, 0.3127532957735243, 0.8018361500531322], [0.07044718594415944, 0.6835729603655977, 0.38072924499260763, 0.6339309563179247, 0.9268790894546248]]])
    b = np.array([[[0.47322067394571043, 0.5801971057632594, 0.7162441742180187, 0.027068984777190108, 0.7313973399998267], [0.08297174765619597, 0.8003784621072384, 0.8771309658812383, 0.09345945644411735, 0.4263058803232388], [0.1598700671429253, 0.12941233742225133, 0.5789223875388946, 0.09226017040693324, 0.9105447223934636], [0.14382936568105598, 0.649463029783935, 0.5392235974137527, 0.32568476641681543, 0.14701389488880123], [0.17411195222713227, 0.475289441908616, 0.7836479651212873, 0.5564294271917406, 0.15986708206070577], [0.4908186128508779, 0.4694983029278751, 0.8827092893929042, 0.4884100599403899, 0.4145674851494531]], [[0.8453576818202398, 0.5362745443678752, 0.6802701510460296, 0.609177581558388, 0.09847800336397083], [0.30698605596261264, 0.11977134909755616, 0.4438786756746984, 0.39177431923395767, 0.5318491770716929], [0.9492974733018349, 0.9367464737894553, 0.4473782946071331, 0.7276963431316488, 0.7422379779316829], [0.1576322757366576, 0.9924295232856558, 0.08500106751482528, 0.09445791415049454, 0.6336078897001911], [0.9537213806638318, 0.5578113008828718, 0.09746868872548986, 0.6216784907560882, 0.86302261666035], [0.7669635054509254, 0.009766435596283318, 0.30828616737698467, 0.23286547108097988, 0.5034274279399525]], [[0.07044718594415944, 0.6835729603655977, 0.38072924499260763, 0.6339309563179247, 0.9268790894546248], [0.807022835987101, 0.6400241552994383, 0.3681024019815341, 0.3127532957735243, 0.8018361500531322], [0.24465141426217707, 0.3743231966372207, 0.04565964198897843, 0.3100676399689497, 0.8315193998721372], [0.5801517162709772, 0.7710890481699647, 0.3762265742721872, 0.49102474090072723, 0.9816396804040689], [0.5223705322713111, 0.5130748631715455, 0.6498319735234533, 0.5445908773835076, 0.03246529565126377], [0.09202758561195723, 0.055965828349447855, 0.08653249019938802, 0.23717329363871142, 0.8395129668196633]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.8539401175386383, 0.49767797853565066], [0.42783437883147235, 0.822559451360812], [0.7382265807305043, 0.44714384049583633], [0.9689030410994359, 0.3631612578404464], [0.397533491596634, 0.738682659213446]], [[0.4490834277012896, 0.9372843639177566], [0.25723348547139335, 0.3817598072362818], [0.6971416168283547, 0.8970701046031435], [0.12105987960108544, 0.24154568649396324], [0.2282636099003713, 0.4895093288343594]]])
    b = np.array([[[0.8539401175386383, 0.49767797853565066], [0.42783437883147235, 0.822559451360812], [0.7382265807305043, 0.44714384049583633], [0.9689030410994359, 0.3631612578404464], [0.397533491596634, 0.738682659213446]], [[0.4490834277012896, 0.9372843639177566], [0.25723348547139335, 0.3817598072362818], [0.6971416168283547, 0.8970701046031435], [0.12105987960108544, 0.24154568649396324], [0.2282636099003713, 0.4895093288343594]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.8915226774917562, 0.3581074751151223], [0.38523741854992766, 0.9167270193301819], [0.11381664038986117, 0.6311255415710575], [0.13281499876869385, 0.3742445809714211], [0.3244048636316378, 0.6801155376270952]], [[0.7955347461391471, 0.5039336118794355], [0.2962423883711427, 0.885962269002118], [0.35187056092725555, 0.7383903376936126], [0.5553612630261748, 0.20151771332321833], [0.5485190962798103, 0.519642829449547]], [[0.34878266417059944, 0.0246199570564557], [0.14882930344317524, 0.13185203816295255], [0.7079174626754349, 0.7090721135651303], [0.6117484144329579, 0.671907016279956], [0.4475158707610247, 0.6960771689660051]], [[0.37832614484517124, 0.10003204928940568], [0.9602567843749067, 0.0724344474657973], [0.019300606451071012, 0.9795732518644896], [0.14847808772497184, 0.25870232207150123], [0.21552881156454484, 0.5799123983985056]]])
    b = np.array([[[0.8915226774917562, 0.3581074751151223], [0.38523741854992766, 0.9167270193301819], [0.11381664038986117, 0.6311255415710575], [0.13281499876869385, 0.3742445809714211], [0.3244048636316378, 0.6801155376270952]], [[0.7955347461391471, 0.5039336118794355], [0.2962423883711427, 0.885962269002118], [0.35187056092725555, 0.7383903376936126], [0.5553612630261748, 0.20151771332321833], [0.5485190962798103, 0.519642829449547]], [[0.34878266417059944, 0.0246199570564557], [0.14882930344317524, 0.13185203816295255], [0.7079174626754349, 0.7090721135651303], [0.6117484144329579, 0.671907016279956], [0.4475158707610247, 0.6960771689660051]], [[0.37832614484517124, 0.10003204928940568], [0.9602567843749067, 0.0724344474657973], [0.019300606451071012, 0.9795732518644896], [0.14847808772497184, 0.25870232207150123], [0.21552881156454484, 0.5799123983985056]]])
    np.testing.assert_allclose(tform(a), b)

    a = np.array([[[0.9757516851399299, 0.27300890129390465, 0.9700750738510008, 0.02549734896729483, 0.8880437054177104], [0.7086088382481099, 0.2777736736315105, 0.8948631921780887, 0.026522552598975735, 0.6256366173439284], [0.32954271081208253, 0.967121130692352, 0.16857640481509484, 0.9014829863134214, 0.32993565087121357], [0.8892333217310002, 0.5124516587590872, 0.51062890693618, 0.38682715356733255, 0.530088935959223], [0.9447074808964758, 0.8928622469672834, 0.6771143998332181, 0.6390273844915813, 0.548361337775251]], [[0.27268311786411736, 0.1482686421476278, 0.8563029768335465, 0.6350567989821495, 0.2996434942475267], [0.4602197063913872, 0.02452739723427, 0.558065100924011, 0.3611515171043168, 0.5027095407690281], [0.15362753737206158, 0.4255076374308092, 0.9061718405949403, 0.008511590056627494, 0.9688640997540201], [0.6908937254227938, 0.09941639436140837, 0.28977587592057885, 0.5390735467669154, 0.7241478484039084], [0.3888674304090679, 0.2270839709579695, 0.45485987961584495, 0.9720825075264246, 0.8338182342258864]], [[0.9147906602686022, 0.667284844044465, 0.44066609303413806, 0.6850919910505949, 0.6485983083692556], [0.02910001420110575, 0.919531435498915, 0.5424570027145418, 0.9911416509743957, 0.38310289154914323], [0.8066693253136108, 0.46100682934939485, 0.8268242136411484, 0.5391182349867721, 0.8872648394626437], [0.8801068635197443, 0.32830330828921095, 0.40442494288519115, 0.5446473574026356, 0.6216928996348438], [0.3793560782249866, 0.5421294535799384, 0.12091936113913404, 0.6806972386680347, 0.28711926168416746]]])
    b = np.array([[[0.9447074808964758, 0.8928622469672834, 0.6771143998332181, 0.6390273844915813, 0.548361337775251], [0.8892333217310002, 0.5124516587590872, 0.51062890693618, 0.38682715356733255, 0.530088935959223], [0.32954271081208253, 0.967121130692352, 0.16857640481509484, 0.9014829863134214, 0.32993565087121357], [0.7086088382481099, 0.2777736736315105, 0.8948631921780887, 0.026522552598975735, 0.6256366173439284], [0.9757516851399299, 0.27300890129390465, 0.9700750738510008, 0.02549734896729483, 0.8880437054177104]], [[0.3888674304090679, 0.2270839709579695, 0.45485987961584495, 0.9720825075264246, 0.8338182342258864], [0.6908937254227938, 0.09941639436140837, 0.28977587592057885, 0.5390735467669154, 0.7241478484039084], [0.15362753737206158, 0.4255076374308092, 0.9061718405949403, 0.008511590056627494, 0.9688640997540201], [0.4602197063913872, 0.02452739723427, 0.558065100924011, 0.3611515171043168, 0.5027095407690281], [0.27268311786411736, 0.1482686421476278, 0.8563029768335465, 0.6350567989821495, 0.2996434942475267]], [[0.3793560782249866, 0.5421294535799384, 0.12091936113913404, 0.6806972386680347, 0.28711926168416746], [0.8801068635197443, 0.32830330828921095, 0.40442494288519115, 0.5446473574026356, 0.6216928996348438], [0.8066693253136108, 0.46100682934939485, 0.8268242136411484, 0.5391182349867721, 0.8872648394626437], [0.02910001420110575, 0.919531435498915, 0.5424570027145418, 0.9911416509743957, 0.38310289154914323], [0.9147906602686022, 0.667284844044465, 0.44066609303413806, 0.6850919910505949, 0.6485983083692556]]])
    np.testing.assert_allclose(tform(a), b)



# ----------------------------------------------------------------------------
def submit_flip_horizontal():
    tform = ndl.data.RandomFlipHorizontal(0.5)
    np.random.seed(0)
    for _ in range(2):
        size_a, size_b, size_c = np.random.randint(1,5), np.random.randint(1,5), np.random.randint(1,5)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))

    tform = ndl.data.RandomFlipHorizontal(0)
    for _ in range(2):
        size_a, size_b, size_c = np.random.randint(1,5), np.random.randint(1,5), np.random.randint(1,5)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))

    tform = ndl.data.RandomFlipHorizontal(1.0)
    for _ in range(2):
        size_a, size_b, size_c = np.random.randint(1,5), np.random.randint(1,5), np.random.randint(1,5)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))



def test_random_crop():
    tform = ndl.data.RandomCrop(2)
    np.random.seed(0)
    a = np.array([[[0.26455561210462697, 0.7742336894342167, 0.45615033221654855, 0.5684339488686485, 0.018789800436355142], [0.6176354970758771, 0.6120957227224214, 0.6169339968747569, 0.9437480785146242, 0.6818202991034834]], [[0.359507900573786, 0.43703195379934145, 0.6976311959272649, 0.06022547162926983, 0.6667667154456677], [0.6706378696181594, 0.2103825610738409, 0.1289262976548533, 0.31542835092418386, 0.3637107709426226]], [[0.5701967704178796, 0.43860151346232035, 0.9883738380592262, 0.10204481074802807, 0.2088767560948347], [0.16130951788499626, 0.6531083254653984, 0.2532916025397821, 0.4663107728563063, 0.24442559200160274]], [[0.15896958364551972, 0.11037514116430513, 0.6563295894652734, 0.1381829513486138, 0.1965823616800535], [0.3687251706609641, 0.8209932298479351, 0.09710127579306127, 0.8379449074988039, 0.09609840789396307]], [[0.9764594650133958, 0.4686512016477016, 0.9767610881903371, 0.604845519745046, 0.7392635793983017], [0.039187792254320675, 0.2828069625764096, 0.1201965612131689, 0.29614019752214493, 0.11872771895424405]], [[0.317983179393976, 0.41426299451466997, 0.06414749634878436, 0.6924721193700198, 0.5666014542065752], [0.2653894909394454, 0.5232480534666997, 0.09394051075844168, 0.5759464955561793, 0.9292961975762141]], [[0.31856895245132366, 0.6674103799636817, 0.13179786240439217, 0.7163272041185655, 0.2894060929472011], [0.18319136200711683, 0.5865129348100832, 0.020107546187493552, 0.8289400292173631, 0.004695476192547066]], [[0.6778165367962301, 0.27000797319216485, 0.7351940221225949, 0.9621885451174382, 0.24875314351995803], [0.5761573344178369, 0.592041931271839, 0.5722519057908734, 0.2230816326406183, 0.952749011516985]], [[0.44712537861762736, 0.8464086724711278, 0.6994792753175043, 0.29743695085513366, 0.8137978197024772], [0.39650574084698464, 0.8811031971111616, 0.5812728726358587, 0.8817353618548528, 0.6925315900777659]], [[0.7252542798196405, 0.5013243819267023, 0.9560836347232239, 0.6439901992296374, 0.4238550485581797], [0.6063932141279244, 0.019193198309333526, 0.30157481667454933, 0.660173537492685, 0.29007760721044407]], [[0.6180154289988415, 0.42876870094576613, 0.13547406422245023, 0.29828232595603077, 0.5699649107012649], [0.5908727612481732, 0.5743252488495788, 0.6532008198571336, 0.6521032700016889, 0.43141843543397396]], [[0.896546595851063, 0.36756187004789653, 0.4358649252656268, 0.8919233550156721, 0.8061939890460857], [0.7038885835403663, 0.10022688731230112, 0.9194826137446735, 0.7142412995491114, 0.9988470065678665]], [[0.14944830465799375, 0.8681260573682142, 0.16249293467637482, 0.6155595642838442, 0.12381998284944151], [0.8480082293222344, 0.8073189587250107, 0.5691007386145933, 0.40718329722599966, 0.06916699545513805]], [[0.6974287731445636, 0.45354268267806885, 0.7220555994703479, 0.8663823259286292, 0.9755215050028858], [0.855803342392611, 0.011714084185001972, 0.3599780644783639, 0.729990562424058, 0.17162967726144052]], [[0.5210366062041293, 0.05433798833925363, 0.19999652489640007, 0.01852179446061397, 0.7936977033574206], [0.22392468806038013, 0.3453516806969027, 0.9280812934655909, 0.7044144019235328, 0.03183892953130785]], [[0.16469415649791275, 0.6214784014997635, 0.5772285886041676, 0.23789282137450862, 0.9342139979247938], [0.613965955965896, 0.5356328030249583, 0.589909976354571, 0.7301220295167696, 0.31194499547960186]], [[0.3982210622160919, 0.20984374897512215, 0.18619300588033616, 0.9443723899839336, 0.7395507950492876], [0.4904588086175671, 0.22741462797332324, 0.25435648177039294, 0.05802916032387562, 0.4344166255581208]], [[0.3117958819941026, 0.6963434888154595, 0.3777518392924809, 0.1796036775596348, 0.02467872839133123], [0.06724963146324858, 0.6793927734985673, 0.4536968445560453, 0.5365792111087222, 0.8966712930403421]], [[0.9903389473967044, 0.21689698439847394, 0.6630782031001008, 0.26332237673715064, 0.02065099946572868], [0.7583786538361414, 0.32001715082246784, 0.38346389417189797, 0.5883171135536057, 0.8310484552361904]], [[0.6289818435911487, 0.8726506554473953, 0.27354203481563577, 0.7980468339125637, 0.1856359443059522], [0.9527916569719446, 0.6874882763878153, 0.21550767711355845, 0.9473705904889242, 0.7308558067701578]], [[0.25394164259502583, 0.21331197736748198, 0.5182007139306632, 0.025662718054531575, 0.2074700754411094], [0.42468546875150626, 0.37416998033422555, 0.4635754243648107, 0.2776287062947319, 0.5867843464581688]], [[0.8638556059232314, 0.11753185596203308, 0.5173791071541142, 0.1320681063451533, 0.7168596811925937], [0.39605970280729375, 0.565421311858509, 0.18327983621407862, 0.14484775934337724, 0.48805628064895457]], [[0.3556127378499556, 0.940431945252813, 0.7653252538069653, 0.7486636198505473, 0.9037197397459334], [0.08342243544201855, 0.5521924699224066, 0.5844760689557689, 0.961936378547229, 0.29214752679254885]], [[0.24082877991544682, 0.10029394226549782, 0.016429629591474204, 0.9295293167921905, 0.66991654659091], [0.7851529120231378, 0.2817301057539491, 0.5864101661863267, 0.06395526612098112, 0.4856275959346229]], [[0.9774951397444468, 0.8765052453165908, 0.33815895183684563, 0.9615701545414985, 0.2317016264712045], [0.9493188224156814, 0.9413777047064986, 0.7992025873523917, 0.6304479368667911, 0.874287966624947]], [[0.2930202845077967, 0.8489435553129182, 0.6178766919175238, 0.01323685775889949, 0.34723351793221957], [0.14814086094816503, 0.9818293898182532, 0.47837030703998806, 0.4973913654986627, 0.6394725163987236]], [[0.3685846061296175, 0.13690027168559893, 0.8221177331942455, 0.18984791190275796, 0.511318982546456], [0.22431702897473926, 0.09784448449403405, 0.8621915174216833, 0.9729194890231303, 0.9608346580630002]], [[0.906555499221179, 0.7740473326986388, 0.3331451520286419, 0.08110138998799676, 0.40724117141380733], [0.23223414217094274, 0.13248763475798297, 0.05342718178682526, 0.7255943642105788, 0.011427458625031028]], [[0.7705807485027762, 0.14694664540037505, 0.07952208258675575, 0.08960303423860538, 0.6720478073539145], [0.24536720985284477, 0.42053946668009845, 0.5573687913239169, 0.8605511738287938, 0.7270442627113283]], [[0.27032790523871464, 0.1314827992911276, 0.05537432042119794, 0.3015986344809425, 0.26211814923967824], [0.45614056680047965, 0.6832813355476804, 0.6956254456388572, 0.28351884658216664, 0.3799269559001205]], [[0.18115096173690304, 0.7885455123065187, 0.0568480764332403, 0.6969972417249873, 0.7786953959411034], [0.7774075618487531, 0.25942256434535493, 0.37381313793256143, 0.587599635196389, 0.272821902424467]], [[0.3708527992178887, 0.19705428018563964, 0.4598558837560074, 0.044612301254114084, 0.799795884570618], [0.07695644698663273, 0.518835148831526, 0.3068100995451961, 0.5775429488313755, 0.9594333408334251]], [[0.6455702444560039, 0.03536243575549092, 0.43040243950806123, 0.5100168523182502, 0.536177494703452], [0.6813925106038379, 0.2775960977317661, 0.1288605654663202, 0.39267567654709434, 0.9564057227959488]], [[0.18713089175084474, 0.903983954928237, 0.5438059500773263, 0.4569114216457658, 0.8820414102298896], [0.45860396176858587, 0.7241676366115433, 0.399025321703102, 0.9040443929009577, 0.6900250201912274]], [[0.6996220542505167, 0.3277204015571189, 0.7567786427368892, 0.6360610554471413, 0.24002027337970955], [0.16053882248525642, 0.7963914745173317, 0.9591666030352225, 0.45813882726004285, 0.5909841653236849]], [[0.8577226441935546, 0.45722345335385706, 0.9518744768327362, 0.5757511620448724, 0.820767120701315], [0.9088437184127384, 0.8155238187685688, 0.15941446344895593, 0.6288984390617004, 0.3984342586196771]], [[0.0627129520233457, 0.42403225188984195, 0.2586840668894077, 0.8490383084285108, 0.03330462654669619], [0.9589827218634736, 0.3553688484719296, 0.3567068904025429, 0.01632850268370789, 0.18523232523618394]], [[0.4012595008036087, 0.9292914173027139, 0.09961493022127133, 0.9453015334790795, 0.8694885305466322], [0.4541623969075518, 0.32670088176826007, 0.23274412927905685, 0.6144647064768743, 0.03307459147550562]], [[0.015606064446828216, 0.42879572249823783, 0.0680740739747202, 0.2519409882460929, 0.22116091534608384], [0.2531911937228519, 0.13105523121525775, 0.01203622289765427, 0.11548429713874808, 0.6184802595127479]], [[0.9742562128180503, 0.9903450015608939, 0.4090540953730616, 0.16295442604660537, 0.6387617573665293], [0.49030534654873714, 0.9894097772844315, 0.0653042071517802, 0.7832344383138131, 0.2883984973314939]], [[0.241418620076574, 0.662504571532676, 0.24606318499096447, 0.6658591175591877, 0.5173085172022888], [0.4240889884358493, 0.554687808661419, 0.28705151991962974, 0.7065747062729789, 0.414856869333564]], [[0.36054556048589226, 0.8286569145557378, 0.9249669119531921, 0.046007310887296926, 0.2326269928297655], [0.34851936949256324, 0.8149664793702474, 0.9854914276432976, 0.9689717046703518, 0.9049483455499269]], [[0.2965562650640299, 0.9920112434144741, 0.2494200410564512, 0.1059061548822322, 0.9509526110553941], [0.2334202554680963, 0.6897682650777505, 0.05835635898058866, 0.7307090991274762, 0.8817202123338397]], [[0.2724368954659625, 0.37905689607742854, 0.3742961833209161, 0.7487882575401331, 0.23780724253903884], [0.171853099047643, 0.4492916486877381, 0.3044684073773195, 0.8391891222586524, 0.23774182601563876]]])
    b = np.array([[[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(4)
    np.random.seed(0)
    a = np.array([[[0.5023894574892614, 0.9425835996979304, 0.6339976977446607], [0.8672894054624648, 0.9402096893547673, 0.7507648618863519], [0.6995750602247514, 0.9679655666042271, 0.9944007896476794], [0.45182168266975964, 0.07086977818420837, 0.29279403144051885], [0.15235470568773046, 0.4174863747960118, 0.13128932847325603]], [[0.604117804020882, 0.3828080591578541, 0.89538588428821], [0.9677946717985019, 0.5468849016694222, 0.2748235698675966], [0.5922304187618368, 0.8967611582244098, 0.4067333458357483], [0.5520782766919708, 0.2716527676061459, 0.455444149450027], [0.40171353537959864, 0.24841346508297102, 0.5058663838253084]], [[0.3103808259798114, 0.37303486388074747, 0.5249704422542643], [0.7505950229289875, 0.3335074657912753, 0.9241587666207636], [0.8623185468359024, 0.04869029597552854, 0.25364252425682277], [0.4461355126592019, 0.10462788874247408, 0.3484759890334971], [0.7400975256176825, 0.6805144811428259, 0.6223844285660048]], [[0.7105284027223456, 0.20492368695970176, 0.3416981148647321], [0.6762424822774629, 0.8792347630313271, 0.5436780538280952], [0.2826996509455366, 0.03023525800598259, 0.7103368289742134], [0.007884103508440377, 0.3726790698209955, 0.5305372145627818], [0.922111461767193, 0.08949454503290011, 0.4059423219682837]], [[0.024313199710157773, 0.3426109843415903, 0.6222310588397949], [0.2790679482285984, 0.2097499496556351, 0.11570323332709365], [0.5771402440203418, 0.695270005904686, 0.6719571405958223], [0.9488610207205074, 0.0027032138935026984, 0.647196653894036], [0.6003922370976396, 0.5887396099702882, 0.9627703198402424]], [[0.016871673370039697, 0.6964824307014501, 0.8136786497018634], [0.5098071966215841, 0.33396486959680916, 0.7908401632274049], [0.09724292563242465, 0.44203563772992527, 0.5199523745708382], [0.6939564109345475, 0.09088573203240946, 0.22775950153786095], [0.41030156269012563, 0.6232946730201306, 0.8869607812174175]], [[0.6188261682413765, 0.13346147093493443, 0.9805801327872824], [0.8717857347554929, 0.502720761145324, 0.922347981796633], [0.5413807937571358, 0.9233060678891631, 0.8298973686033432], [0.9682864102942973, 0.9197828107781584, 0.03603381742856948], [0.17477200416093996, 0.38913467710118577, 0.9521426972954208]], [[0.3000289194759296, 0.16046764388760104, 0.8863046660865599], [0.4463944154832029, 0.9078755943543261, 0.16023046632014326], [0.6611175115080995, 0.4402637528294918, 0.0764867690302854], [0.6964631446525006, 0.2473987555391537, 0.039615522579517726], [0.05994429824957326, 0.06107853706678734, 0.9077329574850395]], [[0.739883917829101, 0.8980623572137351, 0.6725823112965214], [0.5289399290308832, 0.30444636434737826, 0.9979622513286734], [0.36218905893938935, 0.47064894921390954, 0.37824517492346177], [0.9795269293354586, 0.17465838539500578, 0.32798800090807967], [0.6803486660150015, 0.06320761833863064, 0.607249374011541]], [[0.4776465028764161, 0.2839999767621011, 0.238413280924058], [0.5145127432987567, 0.36792758053704133, 0.45651989126265535], [0.3374773817642399, 0.9704936935959776, 0.13343943174560402], [0.0968039531783742, 0.34339172879091606, 0.5910269008704913], [0.6591764718500283, 0.39725674716804205, 0.9992779939221711]], [[0.3518929961930426, 0.7214066679599525, 0.6375826945307929], [0.8130538632474607, 0.97622566345382, 0.8897936564455402], [0.7645619743577086, 0.6982484778182906, 0.3354981696758996], [0.14768557820670736, 0.06263600305980976, 0.24190170420148482], [0.4322814811812986, 0.5219962736299825, 0.7730835540548716]], [[0.958740923056593, 0.11732048038481102, 0.10700414019379156], [0.5896947230135507, 0.745398073947293, 0.8481503803469849], [0.9358320802167885, 0.983426242260642, 0.3998016922245259], [0.3803351835275731, 0.14780867669727238, 0.6849344386835594], [0.6567619584408371, 0.8620625958512073, 0.09725799478764063]], [[0.4977769078253418, 0.5810819296720631, 0.2415570400399184], [0.16902540612916128, 0.8595808364196215, 0.058534922235558784], [0.4706209039180729, 0.11583400130088528, 0.45705876133136736], [0.9799623263423093, 0.4237063534554728, 0.8571249175045673], [0.11731556418319389, 0.27125207676186414, 0.4037927406673345]], [[0.39981214000933074, 0.6713834786701531, 0.34471812737550767], [0.7137668684100164, 0.6391868992253925, 0.3991611452547731], [0.43176012765431926, 0.6145276998103207, 0.07004219014464463], [0.8224067383556903, 0.6534211611136369, 0.7263424644178352], [0.5369230010823904, 0.11047711099174473, 0.4050356132969499]], [[0.40537358284855607, 0.3210429900432169, 0.02995032490474936], [0.7372542425964773, 0.1097844580625007, 0.6063081330450851], [0.7032174964672158, 0.6347863229336947, 0.959142251977975], [0.10329815508513862, 0.8671671591051991, 0.029190234848913255], [0.534916854927084, 0.4042436179392588, 0.5241838603937582]], [[0.3650998770600098, 0.19056691494006806, 0.01912289744868978], [0.5181498137911743, 0.8427768626848423, 0.37321595574479416], [0.22286381801498023, 0.08053200347184408, 0.08531092311870336], [0.22139644629277222, 0.10001406092155518, 0.26503969836448205], [0.06614946211695472, 0.06560486720992564, 0.8562761796227819]], [[0.16212026070883323, 0.559682405823448, 0.7734555444490305], [0.4564095653390666, 0.15336887785934572, 0.19959614212011434], [0.43298420628118073, 0.5282340891785358, 0.3494402920485349], [0.7814796002346613, 0.7510216488563984, 0.9272118073731179], [0.02895254902696054, 0.8956912912102034, 0.39256878846215104]], [[0.8783724953799941, 0.6907847761565296, 0.9873487570739682], [0.7592824517166681, 0.3645446259967866, 0.5010631728347521], [0.37638915519435123, 0.3649118360212381, 0.26090449938105975], [0.4959702953734696, 0.6817399450693612, 0.2773402713052435], [0.52437981107722, 0.11738029417055718, 0.1598452868541913]], [[0.04680635471218875, 0.9707314427706328, 0.0038603515102610952], [0.1785799680576563, 0.6128667531169923, 0.0813695988533053], [0.8818965030968323, 0.7196201578422882, 0.9663899714378934], [0.5076355472407649, 0.3004036831584872, 0.5495005727952714], [0.9308187172979732, 0.5207614372418605, 0.26720703186231864]], [[0.8773987891741196, 0.3719187485124613, 0.0013833499989991394], [0.24768502249231594, 0.3182335091770624, 0.8587774682319022], [0.458503167066445, 0.44458728781130075, 0.3361022663998874], [0.8806781230470796, 0.9450267769403914, 0.9918903291546294], [0.37674126696098675, 0.9661474456271714, 0.7918795696309013]], [[0.6756891476442668, 0.24488947942009942, 0.2164572609442098], [0.16604782452124567, 0.9227566102253654, 0.2940766623831661], [0.45309424544887844, 0.4939578339872235, 0.7781715954502542], [0.8442349615530241, 0.1390727011486128, 0.4269043602110737], [0.8428548878354571, 0.8180333057558384, 0.1024137584524164]], [[0.156383348867963, 0.3041986915994078, 0.07535906908334034], [0.4246630028405929, 0.10761770514958191, 0.568217593669845], [0.24655693981115612, 0.5964330653496227, 0.11752564290363765], [0.9758838684185334, 0.9325612038573404, 0.3917969385646658], [0.24217859412608544, 0.2503982128535728, 0.48339353520239203]], [[0.03999280190071697, 0.639705106075127, 0.4083029083397448], [0.3774065725888873, 0.8093649714891984, 0.70903546018329], [0.954333815392692, 0.3519362404956907, 0.8975427646494055], [0.7699671862500889, 0.35742465159471304, 0.6216654364532578], [0.2885699576516956, 0.8743999170748423, 0.11242731721231125]], [[0.21243436129404103, 0.18303329207992114, 0.40302600240428865], [0.7452329600321291, 0.5269074490521803, 0.48767632353820756], [0.0005459648969956543, 0.4254017253550547, 0.06355377483615843], [0.20825325212148382, 0.9323939389604944, 0.2153982043432382], [0.8583376386342625, 0.8028933715613342, 0.15914623694224284]], [[0.6057119572702788, 0.11566187190501331, 0.7278881583695115], [0.6374622773722066, 0.8119385616910193, 0.47938454938918806], [0.9148630878333829, 0.04934894678843971, 0.29288856502701466], [0.715052597465167, 0.41810921174800086, 0.17295135427115638], [0.10721074542854603, 0.8173391114616214, 0.47314297846564424]], [[0.8822836719191074, 0.733289134316726, 0.4097262056307436], [0.37351101415568366, 0.5156383466512517, 0.8890599531897286], [0.7372785797141679, 0.00515296426902323, 0.6941578513691256], [0.9195074069058207, 0.7104557595044916, 0.1770057815674959], [0.4835181274274587, 0.1403160179234194, 0.3589952783396321]], [[0.9371170419405177, 0.9233053075587083, 0.2828368521760829], [0.33963104416619916, 0.6002128681312939, 0.96319729526038], [0.14780133406539042, 0.2569166436866691, 0.8735568272907714], [0.4918922317083445, 0.8989610922270317, 0.18551789752317627], [0.5326685874713607, 0.32626963264937237, 0.31654255989247604]], [[0.44687696394619913, 0.43307744910126844, 0.3573468796779544], [0.9149707703156186, 0.7317441854328928, 0.7275469913315297], [0.2899134495919554, 0.5777094243168404, 0.779179433301834], [0.7955903685432131, 0.34453046075431226, 0.7708727565686478], [0.735893896807733, 0.14150648562190027, 0.8659454685664772]], [[0.4413214701804108, 0.48641044888866547, 0.4483691788979973], [0.5678460014775075, 0.6211692473670547, 0.4981795657629434], [0.8667885432590956, 0.6277347561952844, 0.40142794930551995], [0.41669175690871096, 0.8108386151289514, 0.3481919427465201], [0.21145479578241355, 0.059383188005789234, 0.8760268479205742]], [[0.9185464511903499, 0.12012018216347597, 0.33447374149611486], [0.17537206951524387, 0.11589846882587973, 0.8998667430000302], [0.05687725914535546, 0.9804856634690068, 0.09645086069738418], [0.8634706491935857, 0.5665061069891627, 0.36791748781787337], [0.3423423766251579, 0.7573641432377087, 0.3145732950042872]], [[0.6573189166171418, 0.5173260835160801, 0.4849656451580705], [0.9011621706491616, 0.5546450586202596, 0.8268616030486949], [0.7255735341014894, 0.03855724605899835, 0.7731100525054192], [0.21687025009104066, 0.9031496468515715, 0.042924190608832014], [0.33307203447431877, 0.09973294723475401, 0.47558911708484375]], [[0.8200224358697518, 0.2981873596630641, 0.1509348973110416], [0.3302670356968992, 0.813880141920636, 0.14038395779934687], [0.2273624490775018, 0.06885196449337394, 0.7057100439896077], [0.3952332435363368, 0.310839977143316, 0.7186263903411519], [0.33597754234025523, 0.727771273214418, 0.8151993953143135]], [[0.21766284345773845, 0.9738186968459833, 0.16235794791266678], [0.29084090665674256, 0.17979529083354162, 0.34550565635633446], [0.4800608878207556, 0.5221758690021191, 0.853606042296272], [0.8894479088158666, 0.22010386078090638, 0.6228940321857525], [0.11149605729871559, 0.4589698601820683, 0.32233353804661813]], [[0.3165007454536064, 0.482584241712101, 0.7298276355292675], [0.0691826587923895, 0.8791733376874045, 0.7348137746305611], [0.17649938888906014, 0.9391609090873704, 0.5063122240233886], [0.9998085781169653, 0.19725947430073765, 0.5349081983832014], [0.2902480425599284, 0.30417355738924656, 0.5910653808339902]], [[0.9217190668708333, 0.805263855579175, 0.7239413985013259], [0.5591737821017022, 0.9222985036674477, 0.49236140669088413], [0.8738321783347182, 0.8339816438766318, 0.21383534680158656], [0.7712254629659102, 0.012171156943258765, 0.3228295375480875], [0.22956744469194978, 0.5068629584873134, 0.7368531616807855]], [[0.09767636744772412, 0.5149222019367684, 0.9384120216943856], [0.2286465509829455, 0.6771411441114241, 0.5928802707811576], [0.01006369565609333, 0.47582619585722274, 0.7087703909410487], [0.0439754320240906, 0.8795214830237301, 0.5200814166356731], [0.03066104832571792, 0.2244136119208402, 0.953675696427313]], [[0.5823197330520553, 0.10747256776880454, 0.2875445022805615], [0.4567036258604842, 0.020950069267730465, 0.4116155136137588], [0.48945863543469814, 0.2436778752812322, 0.5886390002919866], [0.7532401195921768, 0.23583422410563548, 0.6204999002799877], [0.6396222429637416, 0.948540301128841, 0.7782761672964438]], [[0.848345269790006, 0.49041990843627514, 0.18534858697938283], [0.995815292959635, 0.1293557610386996, 0.4714573193542654], [0.0680930992421066, 0.9438508573508195, 0.9649249408484396], [0.7193890620039736, 0.3499928436301689, 0.25438240111762433], [0.2653033245370474, 0.12729402542007473, 0.5258089530767229]], [[0.1418172757014775, 0.3167306665534563, 0.6267064759591049], [0.7275436095907498, 0.024272704622061214, 0.4301159843767399], [0.652124594842139, 0.8532459761585128, 0.4753247822120824], [0.9692058717176852, 0.2656325475414473, 0.01350870662671888], [0.4837528647017362, 0.25611379502001796, 0.8237176720231694]], [[0.23277267218111208, 0.3106292182913063, 0.7912274310191123], [0.71514325202536, 0.5580512366572625, 0.7049480619227595], [0.4186368635700265, 0.005310047614667801, 0.011355128512192558], [0.5112217875736866, 0.08329097971899924, 0.05107548016925678], [0.9655166391374733, 0.8590026396580586, 0.15202722720956952]], [[0.0006642185902044906, 0.9416677953897564, 0.2783252983201143], [0.1858976028554975, 0.6915081078315353, 0.1089037388413262], [0.2646495980028003, 0.9750946802120465, 0.6394627744740102], [0.5206777914825536, 0.39791861483493773, 0.774500954884202], [0.14095747652369373, 0.9673378020369822, 0.8611230080657867]], [[0.6176569825692433, 0.042906190402558164, 0.7008556494477377], [0.9132843408854808, 0.524577067478626, 0.3542248218272628], [0.12027734497946962, 0.7549011041375683, 0.8850218512118062], [0.10025174407584858, 0.7589845547523419, 0.017060486259097507], [0.9670549180772195, 0.6150580206350962, 0.5524390589916331]], [[0.2959498335889278, 0.9292916715697834, 0.265905627336791], [0.8281466132166949, 0.985108679337132, 0.7833966455148058], [0.5189899203864318, 0.06607426385167192, 0.472413789171073], [0.43825594697170356, 0.20279604118699524, 0.42358763671430444], [0.3577578840803387, 0.16368426115164847, 0.44137414333248615]], [[0.26279995632448905, 0.5220624206822644, 0.03516005971619418], [0.9062314197872842, 0.8163643055198561, 0.5525813325105046], [0.8518085827572431, 0.9623950738108005, 0.11052229405266056], [0.6308318084098038, 0.9979940009356586, 0.9878891693335261], [0.6033229922907446, 0.12802087045081667, 0.5831928309905282]], [[0.0020646355744217137, 0.19891133466685962, 0.95612315955996], [0.3304405726028439, 0.6383901057769485, 0.2808594946322427], [0.9478218871115895, 0.7285587299494868, 0.3296511575814126], [0.7917614211803709, 0.10816552447633765, 0.3923189400654594], [0.22121812773159233, 0.6837264472760463, 0.10244628177193038]], [[0.3970258322826741, 0.2766497302091896, 0.5063429193238042], [0.3498976805038789, 0.706410577667011, 0.024577024306966067], [0.6339869213059075, 0.23057128969382001, 0.2687090287568493], [0.8002556035835235, 0.9555683939804208, 0.3165502100270866], [0.8268052703690757, 0.1039908379712331, 0.6339816530073832]], [[0.7510322995349188, 0.15597792803445654, 0.42600238766956056], [0.8927071642489816, 0.10357846344837218, 0.01809635820147515], [0.5905853790479337, 0.43553154053093346, 0.7986892488839027], [0.9234555382041066, 0.2991536445438161, 0.3884041171691053], [0.48627208632931485, 0.5881514604352993, 0.9838538296816167]], [[0.6973302508300515, 0.3895485073455688, 0.2637676864504621], [0.9446257184221241, 0.1355484331085064, 0.720265852504758], [0.9253950252924407, 0.6646655865344386, 0.42305444016612115], [0.198990939925484, 0.36747532225192725, 0.7068718094201221], [0.6495342241752968, 0.9279761665983579, 0.8668609136593749]], [[0.8161507522663684, 0.9114508753507623, 0.2763371527370494], [0.3695235401396495, 0.3798939037860174, 0.5604505887097803], [0.668218229542771, 0.2867166830403943, 0.019462467309300346], [0.3992223836579093, 0.3085279595544005, 0.9421847190180479], [0.8882650405440435, 0.8603106783434196, 0.652999760945243]], [[0.3442891646989389, 0.5488492673993047, 0.8152250407163727], [0.09861036872281104, 0.8010748802553047, 0.04117979132812166], [0.8164210312143557, 0.8075638041598735, 0.051007308828755815], [0.6271607114618583, 0.5024530743128972, 0.16981950317171468], [0.14837893767737564, 0.7732591260670232, 0.5676927488368441]], [[0.9829991349165325, 0.9822477772883441, 0.9926669934642663], [0.11861551836576589, 0.9382561369639623, 0.2445696090205628], [0.458212259758612, 0.7574065558217259, 0.20362093207723198], [0.5663116055543299, 0.1858167482259957, 0.1047361066812933], [0.11655861242959853, 0.3576390348482188, 0.004654836837183485]], [[0.4248539212016895, 0.664197105081149, 0.40168818500398873], [0.08579460051983512, 0.06268886202364055, 0.2781165127648617], [0.16931269054360076, 0.9650949732179694, 0.151230224974085], [0.8054624374049966, 0.5861079417411448, 0.5692869199842944], [0.5120807159237846, 0.9717630761139511, 0.3638447750916378]], [[0.7879157509538762, 0.5552941074669596, 0.39563366762572616], [0.9554659333057809, 0.5983159693646871, 0.11891694214601356], [0.4175392009968566, 0.7815817276816076, 0.6937470232392138], [0.9163403298365742, 0.25937738414152023, 0.7581937163538238], [0.4598752073945209, 0.5736097469668154, 0.955046681006283]], [[0.9792863199891774, 0.8615909639255636, 0.35909708773029625], [0.8877008357273198, 0.638609177641413, 0.4299967804707131], [0.035742682500483736, 0.7701281241915822, 0.502105580724113], [0.7861884994650608, 0.7480227993432699, 0.7935673680483519], [0.30065115869676684, 0.800798599067631, 0.5488463284661673]], [[0.4733262004491432, 0.6751259138207569, 0.021358682938348306], [0.10231681588759423, 0.292177365167522, 0.9829901099578396], [0.13974577886495498, 0.3305963007592103, 0.05105306469192361], [0.3312688802927263, 0.3203262865108316, 0.9468071709445222], [0.8451540869957204, 0.3827642192427715, 0.02476905803924867]], [[0.8310311139953782, 0.6605361771445402, 0.15236448365130972], [0.9960712710101872, 0.10023343742412305, 0.8671145415936629], [0.294266164129689, 0.43535346632515703, 0.7954565267763146], [0.6775083559940103, 0.9378643744440391, 0.6211403254603832], [0.09781016147905275, 0.8843603632419503, 0.7691555249885911]], [[0.711870450893322, 0.05373354735373537, 0.396222744661744], [0.16743581945953923, 0.821903908407869, 0.7005286228178628], [0.8830775973191353, 0.9665751069241639, 0.7747476141924986], [0.9942330832207621, 0.6147698861442988, 0.037129603891447815], [0.01425151515029588, 0.3421038752037887, 0.8234717190675371]], [[0.866134706324731, 0.9608125288226779, 0.0651214685488184], [0.044571110987664087, 0.9132835963670337, 0.3050466983628616], [0.5579874006096327, 0.9824448830007099, 0.40044853473592334], [0.6658713983098399, 0.4008795636319853, 0.7681946644627797], [0.5277147255728658, 0.23752313798634972, 0.2713061012584662]], [[0.25805921253840725, 0.5323203282585608, 0.7031890160156643], [0.9492799000431421, 0.6940873750829799, 0.7811928439623906], [0.16892611586456563, 0.3740626250073257, 0.4137802198582661], [0.686380230000473, 0.2958919763768736, 0.3032919214196661], [0.3558891546408681, 0.8103020815432322, 0.5775900900433487]]])
    b = np.array([[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.604117804020882, 0.3828080591578541, 0.89538588428821]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3103808259798114, 0.37303486388074747, 0.5249704422542643]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.7105284027223456, 0.20492368695970176, 0.3416981148647321]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.024313199710157773, 0.3426109843415903, 0.6222310588397949]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.016871673370039697, 0.6964824307014501, 0.8136786497018634]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6188261682413765, 0.13346147093493443, 0.9805801327872824]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3000289194759296, 0.16046764388760104, 0.8863046660865599]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.739883917829101, 0.8980623572137351, 0.6725823112965214]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.4776465028764161, 0.2839999767621011, 0.238413280924058]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3518929961930426, 0.7214066679599525, 0.6375826945307929]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.958740923056593, 0.11732048038481102, 0.10700414019379156]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.4977769078253418, 0.5810819296720631, 0.2415570400399184]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.39981214000933074, 0.6713834786701531, 0.34471812737550767]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.40537358284855607, 0.3210429900432169, 0.02995032490474936]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3650998770600098, 0.19056691494006806, 0.01912289744868978]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.16212026070883323, 0.559682405823448, 0.7734555444490305]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8783724953799941, 0.6907847761565296, 0.9873487570739682]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.04680635471218875, 0.9707314427706328, 0.0038603515102610952]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8773987891741196, 0.3719187485124613, 0.0013833499989991394]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6756891476442668, 0.24488947942009942, 0.2164572609442098]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.156383348867963, 0.3041986915994078, 0.07535906908334034]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.03999280190071697, 0.639705106075127, 0.4083029083397448]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.21243436129404103, 0.18303329207992114, 0.40302600240428865]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6057119572702788, 0.11566187190501331, 0.7278881583695115]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8822836719191074, 0.733289134316726, 0.4097262056307436]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.9371170419405177, 0.9233053075587083, 0.2828368521760829]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.44687696394619913, 0.43307744910126844, 0.3573468796779544]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.4413214701804108, 0.48641044888866547, 0.4483691788979973]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.9185464511903499, 0.12012018216347597, 0.33447374149611486]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6573189166171418, 0.5173260835160801, 0.4849656451580705]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8200224358697518, 0.2981873596630641, 0.1509348973110416]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.21766284345773845, 0.9738186968459833, 0.16235794791266678]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3165007454536064, 0.482584241712101, 0.7298276355292675]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.9217190668708333, 0.805263855579175, 0.7239413985013259]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.09767636744772412, 0.5149222019367684, 0.9384120216943856]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.5823197330520553, 0.10747256776880454, 0.2875445022805615]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.848345269790006, 0.49041990843627514, 0.18534858697938283]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.1418172757014775, 0.3167306665534563, 0.6267064759591049]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.23277267218111208, 0.3106292182913063, 0.7912274310191123]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0006642185902044906, 0.9416677953897564, 0.2783252983201143]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6176569825692433, 0.042906190402558164, 0.7008556494477377]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.2959498335889278, 0.9292916715697834, 0.265905627336791]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.26279995632448905, 0.5220624206822644, 0.03516005971619418]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0020646355744217137, 0.19891133466685962, 0.95612315955996]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3970258322826741, 0.2766497302091896, 0.5063429193238042]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.7510322995349188, 0.15597792803445654, 0.42600238766956056]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.6973302508300515, 0.3895485073455688, 0.2637676864504621]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8161507522663684, 0.9114508753507623, 0.2763371527370494]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.3442891646989389, 0.5488492673993047, 0.8152250407163727]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.9829991349165325, 0.9822477772883441, 0.9926669934642663]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.4248539212016895, 0.664197105081149, 0.40168818500398873]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.7879157509538762, 0.5552941074669596, 0.39563366762572616]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.9792863199891774, 0.8615909639255636, 0.35909708773029625]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.4733262004491432, 0.6751259138207569, 0.021358682938348306]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.8310311139953782, 0.6605361771445402, 0.15236448365130972]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.711870450893322, 0.05373354735373537, 0.396222744661744]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.866134706324731, 0.9608125288226779, 0.0651214685488184]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.25805921253840725, 0.5323203282585608, 0.7031890160156643]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(4)
    np.random.seed(0)
    a = np.array([[[0.07527727983273447, 0.0782460996904688, 0.3712869442824993, 0.7665910506061583, 0.6886834264786805, 0.7079823546511866], [0.7672100660540969, 0.2871527128863294, 0.548256281942088, 0.5433526403167696, 0.7396325011799493, 0.9568705691056464], [0.2779899447954659, 0.7932816727570482, 0.6599705485232624, 0.5802378708634601, 0.7748797793474019, 0.9440324664280993], [0.03669141786941299, 0.14740010251322067, 0.7562872315011158, 0.08379135291008455, 0.516123700741093, 0.21986077664160697]], [[0.2742957038427515, 0.7018404829444163, 0.030192773268711615, 0.8733194279019036, 0.44447895535227, 0.5023932939071011], [0.5400479636936919, 0.6455442945794939, 0.3448565866227481, 0.10110749056349133, 0.31837893666617656, 0.1681421180228203], [0.5561331794504739, 0.31802863096038647, 0.9580671779934349, 0.9657342779802807, 0.6201258805682415, 0.617497267667286], [0.9853785645671059, 0.887283151235186, 0.76506994915814, 0.3135906117427012, 0.36553902811807637, 0.20126676576086544]], [[0.48714812691737464, 0.9903685221395796, 0.9121509530115888, 0.11834943401946907, 0.02519028929050615, 0.8986376684082662], [0.5371701279487074, 0.20018988820845618, 0.6736532695846353, 0.64422317792982, 0.12208560683646719, 0.2596002334976195], [0.06007796431325796, 0.20986047387014195, 0.13230567485306288, 0.1932362924745561, 0.685467145913117, 0.049499744261067735], [0.10185461524821648, 0.13417363807828764, 0.316541120958134, 0.2987503108519409, 0.2550637853166394, 0.7505366534324163]], [[0.9980227877581006, 0.5339779236287958, 0.9442027179139421, 0.3966101121260647, 0.10668244680271344, 0.4087738294698373], [0.2961277734146933, 0.49340696228917813, 0.6570436769164232, 0.4610502191524082, 0.9351605120778256, 0.8847648222993799], [0.7019775951661972, 0.48968491236454914, 0.13168728181445688, 0.3970136667776334, 0.7044015394011737, 0.2848855205537312], [0.10398807754342043, 0.9078984575106281, 0.7090508098155446, 0.6152764266350972, 0.7924989056089166, 0.8356460375834757]], [[0.48345899817102334, 0.88118825140944, 0.9164190107011054, 0.2715510954247814, 0.6075453597907943, 0.5265840288204692], [0.5379457791519024, 0.937663093964562, 0.305188702693029, 0.9834339782345762, 0.9021312148042321, 0.45872288861350263], [0.8174532636181662, 0.7690469943201406, 0.6778949696185212, 0.31983388938315427, 0.19645099182095394, 0.6715276967657582], [0.8429732964010842, 0.01625278867736968, 0.6428033753085121, 0.44287302462221245, 0.8980877551269836, 0.32147293085420525]], [[0.47418481226362175, 0.5147671040351863, 0.14043952137105298, 0.7128923026989064, 0.8304763451209596, 0.05790927689626024], [0.29138882053690274, 0.03804468153505791, 0.9565441046882424, 0.6671688207038236, 0.9642004194547815, 0.5314942783313078], [0.8020685238956139, 0.37441398387974, 0.3538190325726409, 0.3782678171051327, 0.6578621337264282, 0.3594531510216522], [0.9003674516042256, 0.9832748650501553, 0.03042651533700591, 0.19362329040249648, 0.112249992587386, 0.04236404709144326]], [[0.22774099334728648, 0.44679332036908115, 0.8369903652886838, 0.2218240305099961, 0.49394525566220127, 0.9296187394467544], [0.6672147067866749, 0.7980790197559975, 0.5509939701854862, 0.98046645884063, 0.5886621546814742, 0.04551071396259154], [0.19798279993979484, 0.40477362895714797, 0.6012771725737763, 0.7719308674089599, 0.41308612590388627, 0.7100583050156887], [0.789869503109125, 0.3172601972499828, 0.9792702400358185, 0.6496564952358356, 0.8809980607861312, 0.5559376888086067]], [[0.7416031071523237, 0.7705440616163653, 0.908248379234579, 0.1503497568713703, 0.5582834241692485, 0.4283785131058563], [0.9231590211737403, 0.1050946942489992, 0.9825738886809128, 0.8754513240932963, 0.07382628156424853, 0.49096638554047445], [0.7175595002125259, 0.7381515456910565, 0.9064941252379208, 0.7998654355823109, 0.3109303803440895, 0.4984347858624524], [0.701785762935854, 0.13843684136435142, 0.19399079760019733, 0.4810424481098726, 0.2982457987055127, 0.8625592497840949]], [[0.586277321520618, 0.3486651977183677, 0.8488330256044101, 0.8048784485542388, 0.9983548770992695, 0.8473076883337348], [0.4144565348056797, 0.12749888176998847, 0.8406409082004779, 0.05975791796039398, 0.3502712073448542, 0.9197379807712738], [0.9607664734451007, 0.6405645935212184, 0.6886483169837135, 0.04245448872552249, 0.5144803410895479, 0.5468681788063412], [0.3401007461241111, 0.06859683475388434, 0.228907599724394, 0.35798393686119634, 0.4351419865163296, 0.5909267255335692]], [[0.7223915186982364, 0.31763187327394615, 0.3289537599189831, 0.019691642723703717, 0.040874860094018306, 0.2578216943085364], [0.7402449976749567, 0.6283138303739122, 0.7697890206778347, 0.7689194362148217, 0.8565674676693013, 0.7203192659868836], [0.9790109190008228, 0.8988252193018174, 0.5867171662232342, 0.5881576704911717, 0.034267040352229494, 0.9985265777083543], [0.13157599736614178, 0.740347196631592, 0.8210151951243089, 0.3730545293052032, 0.19685205466531375, 0.09875988679055503]], [[0.7486060058295778, 0.4526535292056957, 0.7137177590011357, 0.9154076488518006, 0.1465837361510567, 0.9191710007237996], [0.4116264595084367, 0.30526700989728905, 0.9430622606027791, 0.9906516926063994, 0.19889221776744814, 0.6568383469519833], [0.10649531377106036, 0.6509140038575058, 0.8273132277758497, 0.6844985465240676, 0.41733314206259575, 0.38306635956376955], [0.39312241522341707, 0.5897118179929232, 0.8815672700724956, 0.9290661572687678, 0.05352962020731811, 0.1816223946456883]], [[0.11222431582828851, 0.19333464076691398, 0.3466078106091718, 0.5065316826226238, 0.6294612270091522, 0.7321422191397015], [0.8901115413858071, 0.9890884372297908, 0.6628564785571198, 0.845364518667763, 0.7780388469246989, 0.30753203921871197], [0.875692270234923, 0.042763137947798846, 0.00036734375145786036, 0.2737326293884642, 0.4620975296274499, 0.6383628950006773], [0.1017702665445448, 0.67301013383484, 0.8018158670596945, 0.1853129195793668, 0.41512525483179386, 0.5199849899533098]], [[0.45180701808448065, 0.7998299308884707, 0.9605223981193308, 0.79895316400818, 0.07799281787582457, 0.8049355721591271], [0.06659633223555117, 0.23597038524157, 0.1530968968357228, 0.19751910684608542, 0.5283151270573506, 0.6716898576108536], [0.470321282336041, 0.9596956390292436, 0.24029232003016665, 0.7631402302547929, 0.8701821785071485, 0.5620661107547191], [0.4562225019615531, 0.5961844467792436, 0.42880977016034294, 0.5551938823233694, 0.4169339521288016, 0.40046971029413403]], [[0.6953464681395298, 0.09285121306796795, 0.16654207272882082, 0.851198471715004, 0.771077346815188, 0.2814537272943938], [0.3772689326657602, 0.9260265066284805, 0.8180772251738613, 0.6143462999796309, 0.22149017880295774, 0.04425197131526959], [0.43125784684189816, 0.6726271392574619, 0.8284804905178516, 0.8526890057422694, 0.032775901293363385, 0.24415703383687937], [0.33909458847740304, 0.18873221095938586, 0.8029753783638378, 0.7674657630849425, 0.5168330403809708, 0.9829264779958555]], [[0.14405854109084226, 0.8996517033276689, 0.11646325416191616, 0.1631817055141207, 0.6962192002506188, 0.10956969204168931], [0.5658450954187109, 0.4202335364726536, 0.7284739655410148, 0.9006752388088651, 0.7698715146690553, 0.8496898764211883], [0.03294544853123238, 0.3101954982442031, 0.5154330866863324, 0.41595331462977947, 0.23125495297968846, 0.3078740979600233], [0.9454309703916057, 0.29418087987135155, 0.35390411017978574, 0.0037097737500186856, 0.8450776272778745, 0.15484070340157663]], [[0.20414427551372605, 0.2552645170920256, 0.8846220568448426, 0.20645141124631472, 0.7975263608679399, 0.8080493403229045], [0.9270205687863958, 0.11556131360031396, 0.21727897233783133, 0.7428982920807213, 0.19600075428073904, 0.286329546873449], [0.16674158011136264, 0.1726966861550493, 0.4815533546282057, 0.10968306211295853, 0.3216976184636222, 0.426593909598879], [0.024548116523977592, 0.3883331664744526, 0.09412243608551696, 0.49357853114617667, 0.8257381885570964, 0.8184221621817872]], [[0.08044851553740051, 0.6012277576745202, 0.8345863819712365, 0.23797254293463532, 0.7619265114495991, 0.8907643464500933], [0.8061241514404441, 0.10730103151550452, 0.009059999522384898, 0.19172410992184563, 0.27047734094662323, 0.6161829906159595], [0.3842731752423184, 0.7034070306614735, 0.3530749605216086, 0.1544254246546003, 0.3126898434860351, 0.884324226389135], [0.9585323442450648, 0.20751273406736848, 0.7884683870244413, 0.2733487365398707, 0.8871315434314075, 0.16554561279625546]], [[0.6659599186940569, 0.08421126471318252, 0.9738933239738695, 0.7006333446405428, 0.8418157394050853, 0.5666693393630345], [0.4768013639288602, 0.6218823913943651, 0.528741511699448, 0.469384355145153, 0.7594502514576428, 0.17820095493926813], [0.17117204815515852, 0.4318426506497062, 0.320747916044946, 0.0741245179130241, 0.8444704924187344, 0.7716028066943498], [0.5439214998029848, 0.979324537264369, 0.07260006654760531, 0.766669301027875, 0.2663703916090968, 0.3685989199435754]], [[0.21927938520306756, 0.7890378914618652, 0.144240102021566, 0.840016697735278, 0.6615776482298339, 0.05902324526911473], [0.8109817316001534, 0.6277557161629794, 0.9049823195783415, 0.7487223064086382, 0.5611209274297748, 0.8365471806191977], [0.2780502383012221, 0.5469500618445636, 0.29361681980341015, 0.9682043910905087, 0.22619630084200637, 0.015738239670462506], [0.3258548420037962, 0.5025093969698047, 0.028362934230075076, 0.5592483000339074, 0.8742827749512302, 0.7047321944166701]], [[0.6229683229783043, 0.9559617507082513, 0.9582793338421058, 0.8242664697032286, 0.607741847385851, 0.4877645594977067], [0.01331611324646731, 0.6062619062265414, 0.9890880753568537, 0.818101050024029, 0.34060464388435197, 0.15204702504442202], [0.7840586144671541, 0.7439378206317415, 0.9670467919793231, 0.8748423619393388, 0.5556626252724074, 0.10128424696474214], [0.48350065838396006, 0.313695054022317, 0.5124084820248398, 0.3017015746396532, 0.8618229919755958, 0.8443270139828222]], [[0.3154651571670559, 0.599581346373995, 0.4301808576390541, 0.9090927570285632, 0.18736090142632278, 0.6977284017849593], [0.9703753278372166, 0.17527551956309018, 0.2019664284242032, 0.6937233386722279, 0.7791539245249139, 0.49054905479393274], [0.6096864651471213, 0.21268240881182876, 0.47661422856732605, 0.11207188087491515, 0.3214219252756647, 0.2847797050309543], [0.44462536010242004, 0.9301263622436969, 0.1812676621478424, 0.4013882466247205, 0.6155972191096447, 0.9465570860740017]], [[0.13314819153576818, 0.9178766169931135, 0.08105378863406154, 0.4807413971602644, 0.4545898672304828, 0.20960272887719555], [0.3474596681158475, 0.4541652683483981, 0.8652114629106292, 0.9550641453735598, 0.5189256786371652, 0.8700997902944219], [0.6081715856767794, 0.34908734198767544, 0.19419420761346906, 0.4131347717827648, 0.5228242829238477, 0.04444338825955618], [0.14584116587085072, 0.60018442398144, 0.22500159467716208, 0.8373263760812975, 0.3269422497741906, 0.10483420725325088]], [[0.08353058855531703, 0.9371230205317796, 0.11802031124187917, 0.14090976416206002, 0.862666057932753, 0.254288130277344], [0.6659514107544161, 0.8167256870298913, 0.6071806401301921, 0.9574885434478494, 0.7088828992608414, 0.11275150990365834], [0.5584100265458799, 0.7181865260891839, 0.8019572403734452, 0.02632133528409153, 0.7188789152714244, 0.8256808210194495], [0.7468338109353565, 0.5123491456555981, 0.4580209630888029, 0.5494185832998159, 0.704643698826602, 0.9229142906324854]], [[0.617035210641125, 0.8878343062834696, 0.7012568474457274, 0.06833637743884757, 0.5008281900016218, 0.28648634831524233], [0.2851749281325723, 0.3559275512159842, 0.3147327720004758, 0.5786099801171002, 0.683601500353557, 0.26874938707673546], [0.12976262256838134, 0.0588087209344621, 0.5757528450305522, 0.1861301663330024, 0.009247994223699374, 0.9277530793237041], [0.5371404190832406, 0.09244818024697277, 0.8429211121274853, 0.9832027382901181, 0.4486006620177172, 0.04248960823815817]], [[0.1175459407560635, 0.38165374664543217, 0.885522637448877, 0.14803867927776204, 0.8239900940026955, 0.014976260219019433], [0.457388698785811, 0.6443971409505681, 0.0603794820255964, 0.6147627506164867, 0.9444041214695561, 0.16025992013659507], [0.7296113830353528, 0.6090938979435434, 0.18511638887923054, 0.006203414709366029, 0.009284450505927078, 0.5320924091720286], [0.9427794095611935, 0.6442986274656124, 0.7142998462937437, 0.4938654869205371, 0.5818889426345698, 0.12636752533060347]], [[0.8768206204006308, 0.7607926286668019, 0.9981989528446096, 0.29772294755562134, 0.22701777179605787, 0.12516165796134293], [0.9642097566160448, 0.7808851846280236, 0.1663246137196387, 0.5526864711082139, 0.41376820806727677, 0.1514860078061928], [0.16207298502996548, 0.9634699947451857, 0.3049641829577222, 0.9414392916839432, 0.0756106730650844, 0.4608030422931906], [0.1296190485167601, 0.004787385241172171, 0.5537660737060766, 0.11389410481136342, 0.7220245309336797, 0.6981163757068996]], [[0.17633290746448915, 0.9417421432655166, 0.7210434084324896, 0.29797026415692995, 0.7092337639507906, 0.731930277681536], [0.3422263312509606, 0.3755885624614592, 0.3591065076533001, 0.6166184435520741, 0.9004101465401794, 0.17319323622858762], [0.8751996098363184, 0.027653156505342502, 0.6603385959782224, 0.4144388731896942, 0.7912815522324937, 0.721198112930903], [0.480107807145184, 0.6438640367225967, 0.5017731306999452, 0.8115184706218832, 0.476083985968232, 0.5231559899920758]], [[0.25052058641717856, 0.6050430168104723, 0.30290480866983505, 0.5772840145429821, 0.16967811557406987, 0.1594690923411588], [0.41702974119199354, 0.42681951511054084, 0.26810926491253906, 0.13159685036669, 0.039210539213897055, 0.025231827287816144], [0.2715502900064757, 0.46185344216193713, 0.726243281306127, 0.47487170071400897, 0.9040508194352818, 0.03521980457540708], [0.18066062154063434, 0.33851449277014267, 0.5774961880651225, 0.8527361578939424, 0.35020195195657644, 0.2679886825044201]], [[0.06188916884289575, 0.8213034776981041, 0.37966644320667897, 0.5715501954169343, 0.9835554181712204, 0.0015945706042945762], [0.14545014069886597, 0.7791109940193555, 0.8051274852078378, 0.7692471190327554, 0.5369988910428293, 0.9788569810230561], [0.39618455999532054, 0.6019436981131123, 0.0633690045488483, 0.40985744990733874, 0.722500087509922, 0.2387388407706993], [0.9438275890731485, 0.6867833676432891, 0.28757538285757145, 0.7689989227058563, 0.0831647718081091, 0.9747744225104565]], [[0.04928525907355852, 0.9334558911487183, 0.2528538777482612, 0.7578241076908905, 7.369943310608917e-05, 0.2542400891795997], [0.7491006066497199, 0.5323360708973223, 0.11495214963711486, 0.3936297458372753, 0.37554935508454257, 0.5681622441809498], [0.6679770724602178, 0.84083024241225, 0.4972313969773726, 0.3920217173051701, 0.1439765340953817, 0.8048229649897223], [0.71337040541456, 0.40867739745468534, 0.5184323099426694, 0.6651828444118888, 0.1648055898475378, 0.02719779440792025]], [[0.3175036991866854, 0.5955850196361631, 0.4866060912814587, 0.6925546268631271, 0.8196898055745352, 0.4884424667302759], [0.13426702371782484, 0.8506279997989659, 0.5749903272741144, 0.7399374807828707, 0.7046646536082916, 0.9682117713312417], [0.2953073223358139, 0.705306772779262, 0.3656763331259183, 0.3954107209186417, 0.23059463665872149, 0.3440101756508539], [0.9482967516582631, 0.29257084694760094, 0.24599060595658673, 0.583137978473822, 0.2580359567417546, 0.47338572559429504]], [[0.834176256556237, 0.23040031430717556, 0.42669141218392004, 0.6104897350200319, 0.5456289245734854, 0.9747232374152373], [0.680370254395195, 0.7399462420484398, 0.9669559479667332, 0.414438025228521, 0.3553798150610512, 0.04386242976638255], [0.18420430651882713, 0.23718963205167587, 0.1835044670713385, 0.7547838931965645, 0.5358829812761117, 0.6676338014584673], [0.8204621608393736, 0.23077394128589468, 0.32592393982149914, 0.7083602670365968, 0.3927589459044728, 0.02927094010104414]], [[0.43495521902687795, 0.9082730864154143, 0.4090215115928747, 0.332248916442747, 0.9895250829450272, 0.6444155642370132], [0.36599802647118085, 0.10201953136380737, 0.7878494449464212, 0.7080749334877576, 0.9219157992485649, 0.21727563002800832], [0.11492434998823198, 0.7240725264090636, 0.20339584199869565, 0.17610383778949612, 0.3198073353960721, 0.8168251414784377], [0.5395366051096308, 0.04585035510228097, 0.4638946746593172, 0.6839796113664752, 0.5383684384690157, 0.572450218156556]], [[0.22477732839266462, 0.8477393315953481, 0.5613987175911241, 0.7132460130406766, 0.9818642170133025, 0.42819865767453213], [0.8810666126765085, 0.007281013941125014, 0.0334072926151201, 0.5902799217288169, 0.31144939554220064, 0.24827656701970024], [0.27793535720895857, 0.31840293461058755, 0.7289476961434229, 0.5691959722309445, 0.7890359725593334, 0.8301965798350519], [0.8429348593012821, 0.41464414917488757, 0.4212733963164108, 0.926265880140584, 0.6617635946044105, 0.08046718397913877]], [[0.5421869540924683, 0.356007259634907, 0.9874349897163631, 0.013655406462292574, 0.612180873070558, 0.7236230943988581], [0.2889067713573552, 0.9736415182565321, 0.8595366270217113, 0.9156528409858125, 0.01923205935154848, 0.569872151314809], [0.2946502419545467, 0.8490286349356629, 0.6328496569149624, 0.5388770043211097, 0.1145881696756057, 0.5402228047861908], [0.6319041463564267, 0.9559123093102045, 0.5850510104238695, 0.9674006017456545, 0.9616061156066621, 0.6502003358335975]], [[0.5059079841180887, 0.46602174382604933, 0.8903785611157826, 0.028256682971756764, 0.11380819802357156, 0.10207172911915185], [0.7569353251210548, 0.33965102385253476, 0.637968544740701, 0.6037829038425656, 0.38582796974253164, 0.5315677222423986], [0.6451385335716601, 0.9409503298781383, 0.5756340728609814, 0.6143675117683143, 0.06785581770377547, 0.952215814760112], [0.5280819279093862, 0.8012734198599218, 0.05029106314738907, 0.420910135737091, 0.2569754591527016, 0.26697589868858995]], [[0.7914537299609294, 0.6238667252688536, 0.43974531184284804, 0.010585739586393417, 0.9649279429455299, 0.9620232533557238], [0.21755221028003846, 0.04134637231655669, 0.5301993630119022, 0.9514108146164075, 0.9103958457649349, 0.5846628638893966], [0.3035488506537072, 0.32996088376919597, 0.8979135514860276, 0.49178403563557693, 0.1311162289671456, 0.2484254759736073], [0.2767949014674991, 0.12354668493190935, 0.46304438152129135, 0.916050908274991, 0.6687825429922609, 0.07247392424885613]], [[0.005494817809162722, 0.27624766746925433, 0.3626929347939404, 0.7767496690467758, 0.9670055239303667, 0.38756717342354363], [0.6866900298168611, 0.9949019073529632, 0.7456665838750144, 0.6361895490858445, 0.07807485417830429, 0.32321520119473024], [0.9133921584571569, 0.2010054816809057, 0.8435903592732081, 0.6963236850805055, 0.36632437083075464, 0.5291742697126566], [0.5428064687528136, 0.7140537850738863, 0.5165559410991961, 0.13307599018416627, 0.7734546715219126, 0.4062724969061188]], [[0.9630938902119273, 0.28351378229303437, 0.2630787802965846, 0.3335073956751826, 0.5723170159586255, 0.8948697402009823], [0.1762816401400148, 0.2796787975992202, 0.5816798431478618, 0.4543342421615151, 0.44732288725572533, 0.8207342620964065], [0.9238783025113612, 0.4813069660698819, 0.6873517954472738, 0.8010587110273939, 0.5183664103871639, 0.29431640895373534], [0.6380845977222838, 0.5851091003060592, 0.9015628197396104, 0.05240703676985603, 0.9101313871334668, 0.5344320281653596]], [[0.015676116049913924, 0.3447021787677881, 0.7243335638753198, 0.48843308793583295, 0.9801590374409924, 0.42261007383104854], [0.3266352296260078, 0.8216719344295681, 0.5479066993580314, 0.6823265790625589, 0.8057023380386775, 0.6714275461256203], [0.42240749476866457, 0.12479644789430067, 0.5802481665713005, 0.8974333267292596, 0.41889242651841496, 0.9107252348428405], [0.503527819782402, 0.6208415624424766, 0.8329884760556429, 0.5645971096407215, 0.0909693392955635, 0.9809794008003951]], [[0.24584930191283372, 0.7105053286301986, 0.5051134386177387, 0.4787726368177081, 0.24394081886689145, 0.7221507657001041], [0.11278826483098725, 0.9904533093614852, 0.8453735371072039, 0.5345089400057921, 0.42455295605800947, 0.28646463245986764], [0.5015914709407675, 0.879417462024168, 0.2750064007006836, 0.5005374588031359, 0.23454990206703086, 0.3371491136649515], [0.19026050892333246, 0.9905391939211878, 0.5714974464624556, 0.7328151240366955, 0.09824991345203671, 0.3661175500743158]], [[0.8926398030473215, 0.08443832642394788, 0.16548322833961315, 0.6254176103511686, 0.6227889941042252, 0.8382270444539296], [0.9354927638714214, 0.14198647542526377, 0.2593738185269995, 0.42746140569325586, 0.0009032855212496305, 0.06981430295969493], [0.22649127794102164, 0.48110196401581173, 0.2515227381686128, 0.876681892223048, 0.3242728755420111, 0.9246228121426286], [0.97478726073471, 0.44986153390757877, 0.22712881689932363, 0.2916661334230033, 0.7763336816594462, 0.27334970779259105]], [[0.3805828679202846, 0.4785758584818498, 0.5751111164699841, 0.9961004403012381, 0.23220975516359232, 0.35342370324816885], [0.262891177010511, 0.3611134366437103, 0.10080451689462055, 0.3598097672410472, 0.8878650314643884, 0.29858984784644904], [0.37193477984906886, 0.9444741644379346, 0.7283789963268682, 0.5167387148180483, 0.7771927284034406, 0.12317964885450394], [0.4644903532208423, 0.11823612873586631, 0.23361814501958, 0.1418672597402586, 0.3618012391691393, 0.38163932039592585]], [[0.9473085818332408, 0.26412573118752924, 0.47242884531651685, 0.8113794039634867, 0.8156175864366617, 0.7503431870350202], [0.28783376214007295, 0.49497161941135703, 0.18621159518672326, 0.18839952278280425, 0.4358412131383109, 0.7385922212429411], [0.5265842599978379, 0.8866832208474523, 0.8309087977775759, 0.03160544282040556, 0.568419042866216, 0.6091612643556431], [0.9615751443000815, 0.02323662670886173, 0.5311037709686289, 0.2047813619358524, 0.053662906291589096, 0.5874885247317233]], [[0.7726041436328025, 0.7748654492251879, 0.030288410155906775, 0.40694640027158935, 0.0445096271486205, 0.24783864699076974], [0.19288070275794833, 0.21518257924215722, 0.3391184140345286, 0.2774180418359983, 0.9622799113275983, 0.3524071200093821], [0.8941725152929719, 0.1810416715209251, 0.7637468671882143, 0.061345536024642766, 0.4627612294693413, 0.005510440235525937], [0.810290763069436, 0.9504860360377839, 0.035107370827145656, 0.9338463614733145, 0.773853891491353, 0.35886157879279534]], [[0.9088765512228052, 0.29625727125090096, 0.409295312234762, 0.09671126219202164, 0.656938961900144, 0.02960082874227188], [0.48490527519903726, 0.6831918502525338, 0.8212376009491109, 0.14994138962166215, 0.7540903662487174, 0.7190770235550296], [0.5595705341197842, 0.584644597787864, 0.09127072085677812, 0.6004710432403803, 0.3815222070708323, 0.867580851341647], [0.3130988817359902, 0.5765950773635247, 0.4265713997011944, 0.8762619382503131, 0.253916666989189, 0.07880236030946042]], [[0.7486557209831396, 0.41289661690832147, 0.5890983591262915, 0.026389331713351116, 0.952109791397402, 0.8776183773849765], [0.6238679005772775, 0.017029842112618043, 0.3779764739828766, 0.9787965377421489, 0.6813303587402346, 0.16098786131341913], [0.4605967486545006, 0.966737743843486, 0.5347081744165934, 0.024614528029824556, 0.6197720842759777, 0.2712165309311598], [0.09884595187690437, 0.402908444731893, 0.5585230974322448, 0.017040718047802716, 0.5590468086359475, 0.5112031468396374]], [[0.7939083830987601, 0.42354981681539716, 0.5534504296698862, 0.7420093040571263, 0.8971458717819455, 0.3800345760236875], [0.6016334957831465, 0.6946109034163818, 0.043270676442196176, 0.8007605084861348, 0.37743018521539384, 0.6702389414436098], [0.47166406620494905, 0.7023391426917073, 0.7243309792357789, 0.19157101348646732, 0.6621742342864505, 0.8513234378820872], [0.23556720050497482, 0.7581834698938779, 0.6338251131552236, 0.9551260344725638, 0.2602465772917608, 0.15427777765800355]], [[0.3121210152816999, 0.2579587781979187, 0.7568327604735129, 0.7331093038467983, 0.6696849008553338, 0.2163791144584878], [0.8618068074390897, 0.9565715558589277, 0.5316058181086445, 0.6493727306293858, 0.5006920990205621, 0.28355771510260386], [0.2861476039966042, 0.31342052273491317, 0.19085000416415399, 0.9019236326293176, 0.8583981340466859, 0.46163936131883676], [0.36725141256017046, 0.9390783565470986, 0.2223734692328101, 0.5535419594668016, 0.05449815554216264, 0.191202197017449]], [[0.6040269333595097, 0.6621836528441697, 0.5809958186732397, 0.8696014159992898, 0.993405220822747, 0.7638618421529112], [0.46509178414375885, 0.8339346694541027, 0.12038739416600164, 0.6832706964459297, 0.518337787453434, 0.1780658862557184], [0.972933617280214, 0.33843741977874753, 0.6154234059633834, 0.878594237524952, 0.5066888439148206, 0.11513785017643186], [0.8187390843472899, 0.3532137670588005, 0.9830668688918388, 0.8838254464445581, 0.8534493333489572, 0.3562531775378994]], [[0.7571297778090657, 0.9863290630015888, 0.5263216119513313, 0.4707321549552316, 0.014665820972070809, 0.7002037687349363], [0.8584775686018541, 0.24745718608182998, 0.3150245771146568, 0.5006770213261564, 0.07208015736151685, 0.08964247609873699], [0.4211107588880808, 0.26121895270342166, 0.4060373025327685, 0.454386298099938, 0.9762733967391182, 0.9442598201028373], [0.1397301515397661, 0.8825859737322465, 0.08020666233007856, 0.5076354697177541, 0.16390990010976536, 0.36589214535693404]]])
    b = np.array([[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(4)
    np.random.seed(0)
    a = np.array([[[0.7433402256486646, 0.4245054793568499], [0.8069512875713337, 0.7188157110375418]], [[0.9428394462110162, 0.5341560205858773], [0.8021479539877953, 0.3229071063370519]], [[0.3457458450898646, 0.40051046358150544], [0.41091573429808903, 0.10325322066597453]], [[0.5190989393318636, 0.09680321926902558], [0.889762135819764, 0.06184478322329312]], [[0.4496944303093088, 0.2846940663904305], [0.1548694156544791, 0.7838366908422123]], [[0.7149323989195256, 0.1459478901815131], [0.6327656411063102, 0.7925551673304461]], [[0.7733322203698869, 0.09227959766336158], [0.6855127190457763, 0.716023920883577]], [[0.8621662670420273, 0.5080443388649867], [0.46109400030335734, 0.9651163249194699]], [[0.7965122557387535, 0.558730990806489], [0.3306170713112795, 0.8452379960035107]], [[0.4554363894644047, 0.09268519215816062], [0.4549042727134398, 0.8719683961501463]], [[0.44828214689444545, 0.014349147740350121], [0.6114853239164696, 0.9958300034113987]], [[0.8172485840405118, 0.6172379466181479], [0.914398886797885, 0.8135816816510619]], [[0.49863935274004045, 0.5912202854073818], [0.7312928092030199, 0.8464261639788647]], [[0.0581764023767114, 0.7748038571611511], [0.44750343997820197, 0.6607985603015407]], [[0.7646330109588501, 0.5395019250274483], [0.15851485058039905, 0.4095268315182661]], [[0.07687299375237977, 0.6893006911552638], [0.9537061819630834, 0.795252812224187]], [[0.3897864227871187, 0.5842914960054943], [0.30420067584686916, 0.541045599554965]], [[0.30072690578464023, 0.73832475679861], [0.2593415079870255, 0.9640203904338944]], [[0.6619487321735315, 0.06877784768384376], [0.01077776350569315, 0.9970463442051004]], [[0.22050557821579353, 0.3125627484571776], [0.20841401420210837, 0.9281017724711823]], [[0.6520128596686141, 0.5043863235561108], [0.5576508144925704, 0.3178728472991873]], [[0.6141750023638414, 0.4196003634549319], [0.1992281464241792, 0.6566050997098815]], [[0.37384056925921205, 0.7850663791171616], [0.41539495750952704, 0.5082713750461963]], [[0.7874664791808963, 0.44787809291973113], [0.9662211351241645, 0.7930286671951117]], [[0.8264304053149786, 0.9539204667037277], [0.3888506288432074, 0.5800802641821708]], [[0.6935917407956035, 0.6734584835406308], [0.9529367945610195, 0.28834863387833454]], [[0.29136152862599196, 0.9180044020391467], [0.7993056417265596, 0.20335662406959776]], [[0.5700468780927677, 0.7457637340963282], [0.3530363904475091, 0.43438225122139007]], [[0.575396611660893, 0.46710855754821057], [0.7530423900690328, 0.005938753683069731]], [[0.4346325243910505, 0.33758137532887156], [0.6091640528298269, 0.7759584418813597]], [[0.07614516220153023, 0.1580597336011924], [0.6650816241420333, 0.738402441015417]], [[0.5882017770788354, 0.9828033489679264], [0.4994614891065746, 0.1362923350976436]], [[0.68629106037108, 0.6020755221947981], [0.5904214750302634, 0.5458536352463982]], [[0.9390957095495389, 0.129156396826558], [0.07319729852497836, 0.15411716937731978]], [[0.24499020990495046, 0.5929463194364691], [0.6124252490967343, 0.23260187745708427]], [[0.4892254993109375, 0.48206185276773483], [0.45311076628522495, 0.8035452949126581]], [[0.47169306987563187, 0.758365495956166], [0.16648113180479807, 0.531967344073168]], [[0.8241047760631955, 0.17771658391625766], [0.46492216869766234, 0.6090793160357167]], [[0.18477457483728732, 0.7567656059114031], [0.07899624779631742, 0.9464155089077187]], [[0.46822149421813575, 0.3361230863654765], [0.11680700716264036, 0.4325966430678647]], [[0.6598040293907718, 0.09448727914238408], [0.3062690951677486, 0.8360175827727111]], [[0.6461810255983272, 0.2063730118576239], [0.16090979579308917, 0.9044850262008999]], [[0.28702022134098437, 0.1795001688986303], [0.9999640185426024, 0.3091918277779059]], [[0.12474018780936369, 0.4617576297529471], [0.4343451101984821, 0.926802475830331]], [[0.13420494747630474, 0.09113640612930685], [0.0929786709066801, 0.9042874658222364]], [[0.4493691779610771, 0.15060652815522568], [0.5938300983792906, 0.5376233556508321]], [[0.19840674774889933, 0.603038139426371], [0.3402312343169456, 0.23837076773086996]], [[0.5104006108990281, 0.2916492615163876], [0.22213992176121322, 0.8797224082996742]], [[0.1557625765734173, 0.2805899772848325], [0.3861383798498257, 0.27363831030002284]], [[0.2107106425777696, 0.771146097054588], [0.3290161587235815, 0.11251295769933845]], [[0.5408951624566958, 0.1254884972364103], [0.3575196074409279, 0.8818267622722838]], [[0.3691611951062197, 0.63250897428825], [0.5146255360086313, 0.1377248457779756]], [[0.6490695977908352, 0.8560349969338062], [0.09321247404534405, 0.7536800891297916]], [[0.6902112815189781, 0.8666605749971459], [0.10409193213346701, 0.3056953793966788]], [[0.6942914872263741, 0.022017978886650247], [0.7340756777304887, 0.857978579001121]]])
    b = np.array([[[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(8)
    np.random.seed(0)
    a = np.array([[[0.4533040523767575, 0.4343299034266521, 0.278468962069366], [0.005051870005087333, 0.18630351666635603, 0.9798641184223712], [0.8672860771213566, 0.2665046387489214, 0.9637488571210464], [0.36771261595328586, 0.2975853747511801, 0.15280763544988518]], [[0.901611069510674, 0.9869924910668593, 0.32741140405268243], [0.7034304233584269, 0.33530340980955464, 0.10499073930545522], [0.3926923068823239, 0.551569960761176, 0.12301675917649424], [0.8182727747897611, 0.4973631168932895, 0.23438295250457297]], [[0.5927595785429434, 0.7932593060544021, 0.3276243490519758], [0.7014763244005944, 0.42785917998068734, 0.9640511688456009], [0.7709400866027316, 0.35635090252202095, 0.017747959061762075], [0.657519895380428, 0.1978721585848523, 0.12187917564913275]], [[0.9317764513967938, 0.9999489702149168, 0.2698888205643851], [0.301768552165938, 0.1649889392381687, 0.45768477592962375], [0.8658437598357476, 0.7015059521248778, 0.8463315580765877], [0.22848165567358047, 0.7304560674084801, 0.9185266283960603]], [[0.2814161142143904, 0.6906535435911851, 0.40065741168985447], [0.2902266451589226, 0.9696234687543495, 0.3486332299682927], [0.10784968126068728, 0.3885892096203356, 0.44767829095998235], [0.7522108254992379, 0.9499142669470028, 0.8170569837942127]], [[0.930941311255106, 0.4750601299749311, 0.7193165682364342], [0.30904958501240243, 0.06958710851901795, 0.36547352532599353], [0.6979152283282977, 0.2746221102480437, 0.8614058956415209], [0.7907728499829019, 0.19404254918460295, 0.33083676249080674]], [[0.8253026175490917, 0.2439377895112994, 0.33160214566713064], [0.3430669324230867, 0.8010420278257667, 0.037030265605016766], [0.0737869831214143, 0.5784515481629375, 0.39711199099606664], [0.6328853196107076, 0.26646127617938287, 0.9095826774815607]], [[0.7609418871744561, 0.06774622055039603, 0.7839054772850341], [0.9695823723122513, 0.942435620587473, 0.7354837980254477], [0.1235937534812156, 0.5760767658404541, 0.2842327288404888], [0.9702129436362472, 0.7174857253616094, 0.6107655897874192]], [[0.6950880426047262, 0.4379791291096805, 0.37273675143760665], [0.9357995794399642, 0.33192713479268665, 0.04143613173271932], [0.4008401541544574, 0.7903403526216722, 0.6484683580489194], [0.9621707754778747, 0.10620186761913764, 0.9115463022293834]], [[0.3688491939140621, 0.4740025854219123, 0.42848215448923443], [0.11645228109244143, 0.2477964557251887, 0.742271569229792], [0.0230075418456952, 0.13388777438627453, 0.025210168791350074], [0.8573880573235492, 0.6173248277817797, 0.16992866211855884]], [[0.7687722230537536, 0.9668005974515538, 0.9345603745300182], [0.9215475478121653, 0.007810215405743226, 0.5890134889852785], [0.25663261663902925, 0.5646472143098588, 0.31803028916055465], [0.1536665427726126, 0.4444937233583467, 0.4950963271763734]], [[0.9897655068476245, 0.04238788413854011, 0.3011551988972766], [0.8518938450883227, 0.6596954981260428, 0.8266830318458959], [0.6602909185597778, 0.7595363091461329, 0.4929217499970573], [0.2048776928975975, 0.8100038608371999, 0.5678206546639691]], [[0.13950519378682968, 0.8048940268708661, 0.9585859103625782], [0.3461638726284658, 0.2935122520864435, 0.08177517820756608], [0.6644912264494156, 0.9589616184964967, 0.13599268999160763], [0.4851596313193155, 0.09823818465324785, 0.034109903709815814]], [[0.6645010506676454, 0.8676871753434979, 0.3375705361260297], [0.8757651744100993, 0.1170530991510319, 0.2379606819174762], [0.9016067269067185, 0.5085098936906702, 0.6081923837970241], [0.03801823254250791, 0.12838991014788892, 0.05579081250085316]], [[0.9050007399496692, 0.13479496387094703, 0.8496728266087545], [0.35103469937245313, 0.80059749636578, 0.3650435474567474], [0.26768403969287646, 0.09366070118905723, 0.2807065905741337], [0.47147971671727995, 0.8175087988967955, 0.45251495476869785]], [[0.9714355749376175, 0.541633010854823, 0.024945629811443437], [0.41536730019127244, 0.6888991073865137, 0.2342916462498248], [0.6986299508481587, 0.5036973051815162, 0.025737775583115297], [0.7743529494802057, 0.5603737038140751, 0.08249350308109338]], [[0.475214033462273, 0.28729288177474666, 0.8796815425879331], [0.2849270528072487, 0.9416870709741989, 0.5461327493471125], [0.3236137095467213, 0.8135450174175773, 0.6974003783657658], [0.4139624956958795, 0.6296183027065931, 0.7785842640282813]], [[0.8515577942834893, 0.8164127137140637, 0.16607708859341797], [0.8283895525035856, 0.05862905888377212, 0.2001706815505686], [0.6229267200659891, 0.11469252544690434, 0.6033475950562001], [0.3079656913635638, 0.4294665851546483, 0.31515150344547804]], [[0.07017356786490447, 0.5007587529219609, 0.9635994443948874], [0.6117833481601271, 0.3000318716171253, 0.9561498341240191], [0.38923725195222736, 0.6975177338688435, 0.6341128049224443], [0.9529108480388515, 0.914602694494837, 0.14800405635003122]], [[0.08568587472942246, 0.8096423277988296, 0.904943213296823], [0.49297360392289946, 0.6907612738337751, 0.0697882801784182], [0.21980439785647188, 0.14937619465672114, 0.601160583550034], [0.19753989376610714, 0.059846315550850626, 0.3022072827360107]], [[0.6772124291139527, 0.5778637242618545, 0.3307249654946358], [0.8334788758433764, 0.2762691080120896, 0.2605476383656826], [0.5599474107895882, 0.47821563984577564, 0.44597266060036067], [0.15578561895406717, 0.5046461916329911, 0.25901891727544424]], [[0.3921798826190154, 0.7335704476706063, 0.9368628255593556], [0.7738629651893243, 0.4056338946232637, 0.5930331393287639], [0.746497815875704, 0.4142210500958915, 0.3602481588123011], [0.13524329595586326, 0.7362608014758756, 0.8385085908076249]], [[0.31658441102995283, 0.7835077656425353, 0.6102130583369875], [0.784083046403244, 0.4113373831496644, 0.7475763636496067], [0.408509117897626, 0.0887579854194529, 0.5505789181349441], [0.45432872638864563, 0.25287988720157717, 0.8921133349667691]], [[0.38285330553600116, 0.039126111432281396, 0.38213574020259033], [0.42450980790036974, 0.8616377231941599, 0.7991832081050435], [0.19996658590792427, 0.8390292259588709, 0.2479272282536652], [0.341934148164293, 0.07681845397749132, 0.055356313134363844]], [[0.6808601208111374, 0.923341084521733, 0.4930168542378287], [0.8440937119585831, 0.7937512496926533, 0.6646787233813293], [0.9782289311177785, 0.802187920876386, 0.27484439421426143], [0.7890142462211079, 0.6926616462839036, 0.39952044663635167]], [[0.07679747022711503, 0.21435952961809968, 0.797237891643355], [0.2484852881360492, 0.997857983023348, 0.6939881399885446], [0.47722248071760787, 0.5704366902119271, 0.6108727235414362], [0.9689448200326233, 0.16174119463151948, 0.2723958026607546]], [[0.7095910479712436, 0.23985798314356555, 0.8712971622020502], [0.3465341756581186, 0.1808393999158191, 0.04762076084981848], [0.59559504031795, 0.8252821895545517, 0.27379311114879124], [0.9175394862588203, 0.7577342701180048, 0.06130068249878473]], [[0.5726329966747499, 0.5674409403252657, 0.20237230493598024], [0.3345443786657215, 0.4582788935837623, 0.04807782123741844], [0.14977640928588787, 0.1640043891105587, 0.3792357544563909], [0.7473574586765804, 0.8313036590972589, 0.16284904601703887]], [[0.7519060360067699, 0.6707099583881694, 0.8906873919138784], [0.9687912539451718, 0.12446060880994103, 0.08067386142081667], [0.7997301289520093, 0.16217087308585842, 0.1945745242572069], [0.8820359225258269, 0.938964897102525, 0.318471243922974]], [[0.842168100437994, 0.858856909563651, 0.6053904805020363], [0.566088448063145, 0.5758384092456097, 0.30128918764272283], [0.6188670389389908, 0.24358027110857006, 0.17763229007560877], [0.41295045442400635, 0.7057804229844352, 0.6214276873514643]], [[0.9648820793397025, 0.6464559113657224, 0.14131404979592044], [0.16121821329251806, 0.09306714007783212, 0.191173764997013], [0.597950900679121, 0.8382864750148153, 0.8938676520674573], [0.40004388668504853, 0.5585830285872317, 0.8091995921508134]], [[0.3120705211951691, 0.5956690044386951, 0.17408251105366568], [0.4765403405180947, 0.17307226036346834, 0.46242639029914556], [0.3968196917675796, 0.43326482350049333, 0.243712226106518], [0.13604334237850613, 0.2756653279198856, 0.23958003924390914]], [[0.7342962025844497, 0.7169750729815461, 0.5844829937642724], [0.09133379816877518, 0.566261854280033, 0.07923702594059778], [0.018173019276237823, 0.35259611513765576, 0.2405449190638994], [0.5946476814330426, 0.9286424880696137, 0.7198520277711921]], [[0.7673608619709871, 0.9508931103706227, 0.6340910808965676], [0.5777309414098256, 0.6018679759527085, 0.8658052565674659], [0.3880990352069851, 0.795336225388004, 0.6522569349771614], [0.3045715507819634, 0.013688410984091681, 0.20991999008691997]], [[0.6999887646268611, 0.5796903097452348, 0.27459469982028606], [0.43430247140102396, 0.6611487655814131, 0.12708614048989697], [0.4322795808512164, 0.41662421498197943, 0.5426010201202406], [0.521913680218495, 0.36772668506784956, 0.7627336288125462]], [[0.06722903999121377, 0.035538472534346055, 0.42025933959837536], [0.8966942501708143, 0.27756935052966913, 0.17230932469765314], [0.9282083943293762, 0.16822325458257026, 0.3748405367135256], [0.7290155103364921, 0.2609240084776018, 0.22984952779368129]], [[0.3976672339315541, 0.7873648145968252, 0.9109833531625063], [0.03129252790977377, 0.16510812737192027, 0.9586012891469076], [0.5927912915489684, 0.5514102691538197, 0.8135436792839946], [0.039783298028444825, 0.013836251172974823, 0.9674940497015918]], [[0.8285706855726811, 0.7473817815582686, 0.15570077014486672], [0.47660392304326005, 0.9372935385658475, 0.9335995956239547], [0.009247106979528796, 0.7524914090061574, 0.006237766446710369], [0.9843017276705566, 0.4169672019956985, 0.9735187579800997]], [[0.3677468090306375, 0.2931872905734214, 0.3162919638346049], [0.7306790666385901, 0.19967283393019697, 0.8640576917926507], [0.5905726936267424, 0.9699110259492697, 0.9870849034861486], [0.18518200130214535, 0.9557820535760178, 0.046538486379183674]], [[0.02786372412310567, 0.9438645773285519, 0.9623967374499934], [0.14724767267198968, 0.4424158153889981, 0.4940925279881825], [0.8602812365183045, 0.627917243196169, 0.7745664242016155], [0.48509684543129095, 0.6484137022418283, 0.7354093600258587]], [[0.7378812839173013, 0.0017378267846723805, 0.09990807373006061], [0.363660441104416, 0.0611974471035418, 0.382989702367717], [0.38956684847219225, 0.9202335372777397, 0.5670718548946909], [0.7063512805336583, 0.8871986820862284, 0.4421293206493173]], [[0.0019621445973821983, 0.28533602462541374, 0.8141587000374869], [0.9018411698000748, 0.35150958111822106, 0.2939912529790484], [0.9245052110687334, 0.35107373598278, 0.6522451880766583], [0.2803092350505634, 0.0979187987907415, 0.5012363117860135]], [[0.9232318371181676, 0.618640753927305, 0.20882662478373437], [0.682429573367613, 0.7683611440976326, 0.32076056191495883], [0.5592094014310386, 0.6819531314673225, 0.16035314538048817], [0.9641009397724625, 0.4512519614498419, 0.9796643904720663]], [[0.1895738658444951, 0.4837735463096444, 0.1658536536758377], [0.010180822383938692, 0.23787517257520274, 0.4031873370680834], [0.4311307377242357, 0.8865051551042046, 0.6356772638808419], [0.4344416552185302, 0.9879976996098128, 0.6142243316266857]]])
    b = np.array([[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(1)
    np.random.seed(0)
    a = np.array([[[0.3226629649849716, 0.6913108812107946, 0.4956999226830051], [0.8811676940681722, 0.8965112620633212, 0.3673504001211696]], [[0.5623390508601441, 0.26577344404630543, 0.62663675174255], [0.9923469623196748, 0.8325885178221839, 0.3664099003028253]], [[0.09538035199349248, 0.9666819873735142, 0.38958477867772023], [0.29338089326681516, 0.31633539290556756, 0.4899233666388467]], [[0.9567513987490006, 0.9866223213334914, 0.29612672735239554], [0.35146870774748507, 0.511806560066037, 0.008187288629735945]], [[0.17483656324410912, 0.9360590205048064, 0.029435237061361197], [0.1009762797205438, 0.42064701703371876, 0.731450249159012]], [[0.2688782303903485, 0.30596559055389094, 0.30547298012438673], [0.8726019267536065, 0.22609760622741792, 0.5624018260131903]], [[0.9999311470188161, 0.7284654948930182, 0.336350655296926], [0.7654589703324095, 0.9539157073856089, 0.37353780715258433]], [[0.7080112400693306, 0.07580426311938915, 0.8952968367541417], [0.096256724624312, 0.37292509626159465, 0.5425058428622357]], [[0.26357764245021886, 0.6492693259871776, 0.5544287273924114], [0.717185240298106, 0.3541393651221608, 0.5460138896526734]], [[0.812185400181229, 0.8106963460014557, 0.7142399748518815], [0.5419358896149794, 0.6732611007744953, 0.08688029011205078]], [[0.4713172007107326, 0.860143500304649, 0.6073648217266423], [0.94168310582509, 0.2621785212940809, 0.09630180211077544]], [[0.6266134356038866, 0.09092592982038039, 0.7821353634244159], [0.25674240814905724, 0.5387518584436566, 0.8113770403016125]], [[0.7880353687003, 0.4959750270792086, 0.9758464133154727], [0.49763315709084066, 0.27879141669105545, 0.3024312445516868]], [[0.7436427238772702, 0.43710703889059366, 0.41878848478549024], [0.02048659526993446, 0.30527816042104927, 0.8603830798416068]], [[0.8035044982271469, 0.7465108599826601, 0.023128386675719925], [0.02699029143169318, 0.3114649593908826, 0.47445327221813327]], [[0.9097412679862698, 0.38462981600553936, 0.28852500286289273], [0.5711529683047126, 0.9146942995496945, 0.73863871146225]], [[0.8566662819793105, 0.18219764492303292, 0.1256644453137924], [0.5440711336888929, 0.69737082571725, 0.9549880481625318]], [[0.3715344084564789, 0.3465568522036966, 0.5158542979015847], [0.6849379367067089, 0.5660237771153032, 0.7230306933325961]], [[0.3803149371124904, 0.8621976301852416, 0.18297559358395976], [0.315904642828328, 0.7736776637703174, 0.3356722539793957]], [[0.6681546023700152, 0.2877976092729607, 0.18710434243329277], [0.30073256395315373, 0.88699329703788, 0.460883128691712]], [[0.2254151537382285, 0.321438589165044, 0.002770956625681942], [0.7558082877570287, 0.2256774524328019, 0.5979210402705024]], [[0.02510953817714312, 0.8344984319735175, 0.18744475363635515], [0.004768377764269971, 0.3011878083654256, 0.9204871188372717]], [[0.2626142180446358, 0.5034788381179114, 0.4072298443577044], [0.2942492583320867, 0.9273535786015709, 0.7889949080537266]], [[0.7619133153738572, 0.5261071244812398, 0.8248616737298372], [0.45842865821125367, 0.46518955047155564, 0.49377406341346375]], [[0.23691022522457095, 0.9236518593869899, 0.2587506748785492], [0.19815949993946502, 0.24375179333158525, 0.817352116565939]], [[0.7685456376763616, 0.4271068084560682, 0.013781904624582508], [0.9757350332508857, 0.13253097749036336, 0.8514226765922394]], [[0.7817230866307524, 0.938075781711365, 0.7733985390852888], [0.3313715908270286, 0.23191404341416944, 0.3776908204064149]], [[0.20308717051667458, 0.7195747477449508, 0.8265186324941105], [0.646438892397248, 0.1860927313091021, 0.03738471102864571]], [[0.5804012668569645, 0.46267310507961357, 0.19970392819903238], [0.3680839022202911, 0.5414662556089532, 0.6329171122765795]], [[0.4766437775428183, 0.9713928217354079, 0.04622640047085602], [0.6582079130268984, 0.9095579017878257, 0.236564211113225]], [[0.2137071880691377, 0.7622328074825822, 0.48637379410523596], [0.992177506697882, 0.5891236204917122, 0.9234419334879927]], [[0.012210519663421904, 0.15453962047570513, 0.6844190447515897], [0.416466369897446, 0.8359645694289802, 0.4288980925565181]], [[0.7129966963549856, 0.5661600170334582, 0.11990356732862284], [0.7179512067070324, 0.7063718013476981, 0.11571815121321471]], [[0.561911457807729, 0.33565001754871837, 0.45884978204577553], [0.42275869303077596, 0.1047744042491886, 0.15802298629127975]], [[0.08680861614365021, 0.19244701360336192, 0.8524443864977456], [0.024522649262932905, 0.43161725028685605, 0.8009363887030907]], [[0.1002582045273901, 0.22771359015896464, 0.7274397075582869], [0.6475524325933526, 0.5630238367151661, 0.17164081662818076]], [[0.7945310119658656, 0.14141411188129605, 0.13479789472306425], [0.7950350443033544, 0.3692233278840753, 0.31261711592334684]], [[0.2786720513102364, 0.32497210636760143, 0.3405875997076052], [0.6963676936065396, 0.2402622011512725, 0.3253264534739049]]])
    b = np.array([[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], [[0.3226629649849716, 0.6913108812107946, 0.4956999226830051], [0.8811676940681722, 0.8965112620633212, 0.3673504001211696]], [[0.5623390508601441, 0.26577344404630543, 0.62663675174255], [0.9923469623196748, 0.8325885178221839, 0.3664099003028253]], [[0.09538035199349248, 0.9666819873735142, 0.38958477867772023], [0.29338089326681516, 0.31633539290556756, 0.4899233666388467]], [[0.9567513987490006, 0.9866223213334914, 0.29612672735239554], [0.35146870774748507, 0.511806560066037, 0.008187288629735945]], [[0.17483656324410912, 0.9360590205048064, 0.029435237061361197], [0.1009762797205438, 0.42064701703371876, 0.731450249159012]], [[0.2688782303903485, 0.30596559055389094, 0.30547298012438673], [0.8726019267536065, 0.22609760622741792, 0.5624018260131903]], [[0.9999311470188161, 0.7284654948930182, 0.336350655296926], [0.7654589703324095, 0.9539157073856089, 0.37353780715258433]], [[0.7080112400693306, 0.07580426311938915, 0.8952968367541417], [0.096256724624312, 0.37292509626159465, 0.5425058428622357]], [[0.26357764245021886, 0.6492693259871776, 0.5544287273924114], [0.717185240298106, 0.3541393651221608, 0.5460138896526734]], [[0.812185400181229, 0.8106963460014557, 0.7142399748518815], [0.5419358896149794, 0.6732611007744953, 0.08688029011205078]], [[0.4713172007107326, 0.860143500304649, 0.6073648217266423], [0.94168310582509, 0.2621785212940809, 0.09630180211077544]], [[0.6266134356038866, 0.09092592982038039, 0.7821353634244159], [0.25674240814905724, 0.5387518584436566, 0.8113770403016125]], [[0.7880353687003, 0.4959750270792086, 0.9758464133154727], [0.49763315709084066, 0.27879141669105545, 0.3024312445516868]], [[0.7436427238772702, 0.43710703889059366, 0.41878848478549024], [0.02048659526993446, 0.30527816042104927, 0.8603830798416068]], [[0.8035044982271469, 0.7465108599826601, 0.023128386675719925], [0.02699029143169318, 0.3114649593908826, 0.47445327221813327]], [[0.9097412679862698, 0.38462981600553936, 0.28852500286289273], [0.5711529683047126, 0.9146942995496945, 0.73863871146225]], [[0.8566662819793105, 0.18219764492303292, 0.1256644453137924], [0.5440711336888929, 0.69737082571725, 0.9549880481625318]], [[0.3715344084564789, 0.3465568522036966, 0.5158542979015847], [0.6849379367067089, 0.5660237771153032, 0.7230306933325961]], [[0.3803149371124904, 0.8621976301852416, 0.18297559358395976], [0.315904642828328, 0.7736776637703174, 0.3356722539793957]], [[0.6681546023700152, 0.2877976092729607, 0.18710434243329277], [0.30073256395315373, 0.88699329703788, 0.460883128691712]], [[0.2254151537382285, 0.321438589165044, 0.002770956625681942], [0.7558082877570287, 0.2256774524328019, 0.5979210402705024]], [[0.02510953817714312, 0.8344984319735175, 0.18744475363635515], [0.004768377764269971, 0.3011878083654256, 0.9204871188372717]], [[0.2626142180446358, 0.5034788381179114, 0.4072298443577044], [0.2942492583320867, 0.9273535786015709, 0.7889949080537266]], [[0.7619133153738572, 0.5261071244812398, 0.8248616737298372], [0.45842865821125367, 0.46518955047155564, 0.49377406341346375]], [[0.23691022522457095, 0.9236518593869899, 0.2587506748785492], [0.19815949993946502, 0.24375179333158525, 0.817352116565939]], [[0.7685456376763616, 0.4271068084560682, 0.013781904624582508], [0.9757350332508857, 0.13253097749036336, 0.8514226765922394]], [[0.7817230866307524, 0.938075781711365, 0.7733985390852888], [0.3313715908270286, 0.23191404341416944, 0.3776908204064149]], [[0.20308717051667458, 0.7195747477449508, 0.8265186324941105], [0.646438892397248, 0.1860927313091021, 0.03738471102864571]], [[0.5804012668569645, 0.46267310507961357, 0.19970392819903238], [0.3680839022202911, 0.5414662556089532, 0.6329171122765795]], [[0.4766437775428183, 0.9713928217354079, 0.04622640047085602], [0.6582079130268984, 0.9095579017878257, 0.236564211113225]], [[0.2137071880691377, 0.7622328074825822, 0.48637379410523596], [0.992177506697882, 0.5891236204917122, 0.9234419334879927]], [[0.012210519663421904, 0.15453962047570513, 0.6844190447515897], [0.416466369897446, 0.8359645694289802, 0.4288980925565181]], [[0.7129966963549856, 0.5661600170334582, 0.11990356732862284], [0.7179512067070324, 0.7063718013476981, 0.11571815121321471]], [[0.561911457807729, 0.33565001754871837, 0.45884978204577553], [0.42275869303077596, 0.1047744042491886, 0.15802298629127975]], [[0.08680861614365021, 0.19244701360336192, 0.8524443864977456], [0.024522649262932905, 0.43161725028685605, 0.8009363887030907]], [[0.1002582045273901, 0.22771359015896464, 0.7274397075582869], [0.6475524325933526, 0.5630238367151661, 0.17164081662818076]], [[0.7945310119658656, 0.14141411188129605, 0.13479789472306425], [0.7950350443033544, 0.3692233278840753, 0.31261711592334684]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(2)
    np.random.seed(0)
    a = np.array([[[0.7762115084700661, 0.9131505733137121], [0.6128359702284323, 0.10511822946280702], [0.5415846607086229, 0.6277788742244063]], [[0.3140526970069475, 0.8280003729268972], [0.7820788107571781, 0.5753067067202899], [0.1450155894271119, 0.6973814656840917]], [[0.8953486638415221, 0.2501011097732363], [0.9586858956840082, 0.7713023970302836], [0.30032157477911237, 0.6168211241115817]], [[0.3078479320806945, 0.09946787609389407], [0.8241486696206854, 0.6658070345090323], [0.6140006512807219, 0.14217288071323342]], [[0.37737711316979705, 0.8766360800049111], [0.1633044607769063, 0.04790288699711853], [0.1911514768901753, 0.250180007174864]], [[0.7836425237658834, 0.6481414711893314], [0.01734274680649217, 0.01728965274119665], [0.5668964288000554, 0.6332924423782887]], [[0.12542188091555395, 0.6104621520835593], [0.24035191041954007, 0.3367213424605472], [0.4088315803843413, 0.11619479623427964]], [[0.963093605444955, 0.973764453627561], [0.4450016890894074, 0.2574664780802747], [0.9585944465253112, 0.8180573965471908]], [[0.724228605558232, 0.4618117872776393], [0.41057870144117214, 0.7793492722768518], [0.5196136777646266, 0.6605821388208081]], [[0.5661929816084119, 0.7121854071513629], [0.09410500407840094, 0.3776210926357868], [0.1670891885098651, 0.2420439000235356]], [[0.2008242765381808, 0.5033222993038652], [0.018992988509918707, 0.9639676020084441], [0.5189638264095712, 0.05257151420438899]], [[0.6820538403617592, 0.26888805009787653], [0.10676759258842983, 0.8303036859749948], [0.1979076029143242, 0.10475426885963135]], [[0.05690645260383198, 0.728557743534167], [0.655271247322768, 0.008199140586074072], [0.22148054044830368, 0.7046820311167495]], [[0.15214085470395233, 0.5767507831261646], [0.2131564667521073, 0.4492342848107873], [0.8674230618017811, 0.302596427300986]], [[0.6859723899252312, 0.4382812327828012], [0.0961552543014883, 0.36063499365180096], [0.8412800663481076, 0.9730462422682282]], [[0.8450816706160053, 0.16222839077355067], [0.3455092984490846, 0.8311881586067501], [0.5538959343957655, 0.7761857971144082]], [[0.7777832666167901, 0.0710879006301196], [0.3424065656010231, 0.4790215054529672], [0.945224721580388, 0.8982288010160042]], [[0.4230319829312198, 0.09566592748691505], [0.40454228688038174, 0.5359033326412808], [0.9043971913990313, 0.29487926714121704]], [[0.30886414566898734, 0.627183234547841], [0.505191555071379, 0.19586895905880652], [0.14472724884257937, 0.4894972098053466]], [[0.7793909564002804, 0.7788312515567875], [0.9758036873205908, 0.3827181981579947], [0.391989326810261, 0.0018194947805292294]], [[0.8299173651954892, 0.6466284440680506], [0.7699221187318909, 0.47062319994480306], [0.9201934886408648, 0.029113797832714394]], [[0.11528118273788834, 0.37601733497150314], [0.0851059081135721, 0.08788788196507191], [0.5668726793505451, 0.2161220195699175]], [[0.6265352105571295, 0.9293998221452582], [0.8238822097031292, 0.2484303875538083], [0.08966292611132298, 0.9501924682159203]], [[0.9944959313733248, 0.3744948994651792], [0.460677261142561, 0.14533366133006653], [0.7101807927776813, 0.4218336068528409]], [[0.8030151452544093, 0.5772967114245704], [0.04278380916663371, 0.3349545405035974], [0.8085961706701537, 0.6881138813839268]], [[0.6325319473789155, 0.6725046423160782], [0.6050368756235982, 0.6411243265875745], [0.620421104640871, 0.5334279395046583]], [[0.7577471254274131, 0.36949256352123194], [0.4752383386405016, 0.40144955691968986], [0.20921049112192747, 0.3218889624998843]], [[0.05501507760990065, 0.32552763392261075], [0.3905830929331291, 0.09338409764882383], [0.2204551297120967, 0.24954174744284097]], [[0.2274702082086888, 0.35022170152394927], [0.14487610506997384, 0.7315013568444494], [0.3426548553177532, 0.12236523402169797]], [[0.5935997813267829, 0.1796481751174227], [0.05805632067769373, 0.16329214202474285], [0.4199948120491419, 0.6935089719274358]], [[0.6415008847712601, 0.005205979359825141], [0.793290652514086, 0.3356877784624941], [0.6797156909555698, 0.032673171706932846]], [[0.3937882433723108, 0.019610501319103024], [0.8163455351451152, 0.18696718051616434], [0.6745479075190918, 0.2770661627261115]], [[0.13535111433764768, 0.9302953390465766], [0.5950246157866221, 0.8906310472988932], [0.30659940165063915, 0.8298353336783945]], [[0.9416823334062824, 0.3951838267867882], [0.9041310511984469, 0.33508574267910995], [0.3245999991272911, 0.9957326721950958]], [[0.9524104481773523, 0.228618345971475], [0.8372020270371454, 0.3424578776409021], [0.9792433739780269, 0.8498176287600633]], [[0.9049193013125382, 0.5736735114895585], [0.2941513523211804, 0.19752500637671], [0.5278719205461331, 0.6715157252329823]], [[0.7417886351237006, 0.17038321256296285], [0.5358879925710621, 0.43610982009521804], [0.20822421097781196, 0.552962317358824]]])
    b = np.array([[[0.0, 0.0], [0.0, 0.0], [0.8953486638415221, 0.2501011097732363]], [[0.0, 0.0], [0.0, 0.0], [0.3078479320806945, 0.09946787609389407]], [[0.0, 0.0], [0.0, 0.0], [0.37737711316979705, 0.8766360800049111]], [[0.0, 0.0], [0.0, 0.0], [0.7836425237658834, 0.6481414711893314]], [[0.0, 0.0], [0.0, 0.0], [0.12542188091555395, 0.6104621520835593]], [[0.0, 0.0], [0.0, 0.0], [0.963093605444955, 0.973764453627561]], [[0.0, 0.0], [0.0, 0.0], [0.724228605558232, 0.4618117872776393]], [[0.0, 0.0], [0.0, 0.0], [0.5661929816084119, 0.7121854071513629]], [[0.0, 0.0], [0.0, 0.0], [0.2008242765381808, 0.5033222993038652]], [[0.0, 0.0], [0.0, 0.0], [0.6820538403617592, 0.26888805009787653]], [[0.0, 0.0], [0.0, 0.0], [0.05690645260383198, 0.728557743534167]], [[0.0, 0.0], [0.0, 0.0], [0.15214085470395233, 0.5767507831261646]], [[0.0, 0.0], [0.0, 0.0], [0.6859723899252312, 0.4382812327828012]], [[0.0, 0.0], [0.0, 0.0], [0.8450816706160053, 0.16222839077355067]], [[0.0, 0.0], [0.0, 0.0], [0.7777832666167901, 0.0710879006301196]], [[0.0, 0.0], [0.0, 0.0], [0.4230319829312198, 0.09566592748691505]], [[0.0, 0.0], [0.0, 0.0], [0.30886414566898734, 0.627183234547841]], [[0.0, 0.0], [0.0, 0.0], [0.7793909564002804, 0.7788312515567875]], [[0.0, 0.0], [0.0, 0.0], [0.8299173651954892, 0.6466284440680506]], [[0.0, 0.0], [0.0, 0.0], [0.11528118273788834, 0.37601733497150314]], [[0.0, 0.0], [0.0, 0.0], [0.6265352105571295, 0.9293998221452582]], [[0.0, 0.0], [0.0, 0.0], [0.9944959313733248, 0.3744948994651792]], [[0.0, 0.0], [0.0, 0.0], [0.8030151452544093, 0.5772967114245704]], [[0.0, 0.0], [0.0, 0.0], [0.6325319473789155, 0.6725046423160782]], [[0.0, 0.0], [0.0, 0.0], [0.7577471254274131, 0.36949256352123194]], [[0.0, 0.0], [0.0, 0.0], [0.05501507760990065, 0.32552763392261075]], [[0.0, 0.0], [0.0, 0.0], [0.2274702082086888, 0.35022170152394927]], [[0.0, 0.0], [0.0, 0.0], [0.5935997813267829, 0.1796481751174227]], [[0.0, 0.0], [0.0, 0.0], [0.6415008847712601, 0.005205979359825141]], [[0.0, 0.0], [0.0, 0.0], [0.3937882433723108, 0.019610501319103024]], [[0.0, 0.0], [0.0, 0.0], [0.13535111433764768, 0.9302953390465766]], [[0.0, 0.0], [0.0, 0.0], [0.9416823334062824, 0.3951838267867882]], [[0.0, 0.0], [0.0, 0.0], [0.9524104481773523, 0.228618345971475]], [[0.0, 0.0], [0.0, 0.0], [0.9049193013125382, 0.5736735114895585]], [[0.0, 0.0], [0.0, 0.0], [0.7417886351237006, 0.17038321256296285]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(1)
    np.random.seed(0)
    a = np.array([[[0.27591372180645746, 0.5350545571095502, 0.20010934490087728, 0.8999425369158052, 0.33810282491959054], [0.610334602657793, 0.12193298741989589, 0.6300171925284672, 0.27204033929140836, 0.9565315903711672], [0.39415426604133086, 0.607406556711858, 0.21581336566329634, 0.8614762028764, 0.8043329181204663], [0.2456353122757715, 0.9110485080061057, 0.040155022034127685, 0.7525731205167397, 0.4578687853426443], [0.835459394476964, 0.465485967436008, 0.06558209567040296, 0.22654553229584695, 0.9943748347169384], [0.3341776027693687, 0.16030521702543288, 0.8058308258054888, 0.045069827390500805, 0.06640875146876257]], [[0.2975187794543661, 0.04740097463539672, 0.9957126838923056, 0.6911288860821325, 0.5195864408573572], [0.8051663899562637, 0.6624868006119337, 0.17326495367589456, 0.2196337996488893, 0.8676942857212915], [0.3369613267738214, 0.4476403426248784, 0.3911357121233465, 0.05202981200504242, 0.7045737172836195], [0.5400740807862157, 0.6761400818139303, 0.27823138966714334, 0.4069139083269768, 0.19264976227164798], [0.41968263143719775, 0.6534914117970338, 0.944689043192468, 0.6634571998860077, 0.5251597299929988], [0.4163672224981614, 0.10554968426098033, 0.4770742969319903, 0.15510809316064378, 0.5821871830790901]], [[0.7302470776105839, 0.9464956116881924, 0.2968528676879666, 0.396905538757533, 0.18295193952533229], [0.8779405098804326, 0.8240772244494228, 0.7749598946732359, 0.057290038549901334, 0.5567194419749216], [0.23501356203546908, 0.11968519672230693, 0.7816131001833894, 0.21158137510768193, 0.5008116982476696], [0.5260963484005408, 0.21328200403897157, 0.49226116632238226, 0.052819897599996946, 7.2449638492178e-05], [0.8803219316643702, 0.4155887020861522, 0.9074197989533556, 0.49630735972825957, 0.4311082945881648], [0.29591214065860727, 0.08168893759303875, 0.30969464926452184, 0.6084702651738416, 0.7627863472229892]], [[0.5408255176538437, 0.7582558436964189, 0.15775159165898744, 0.5832399316791738, 0.8826032270257104], [0.21796020764080337, 0.2276689383929903, 0.7484325130680506, 0.8120567848487955, 0.24804632969409923], [0.3315698041877778, 0.6317694004506118, 0.3984317131891898, 0.6240109701292529, 0.4964300320967251], [0.773651309078725, 0.8458886469133242, 0.8638272093051601, 0.6115250777298431, 0.6125841045192504], [0.4496468988194058, 0.02761404496330544, 0.29918021946326245, 0.0636977185007408, 0.4377852488597531], [0.8494852489826142, 0.5968020177048212, 0.675532598269557, 0.18800797177707496, 0.26195314970279426]], [[0.16313215297289452, 0.8426887622604307, 0.28031301298749256, 0.5623263097012292, 0.14112861301900848], [0.12398890832731169, 0.34758336321601746, 0.3303531580600173, 0.32885323381140785, 0.6009327870197562], [0.31599015604044445, 0.7687358689747713, 0.09067076824664133, 0.3247858577376286, 0.6691931285020627], [0.60293211047753, 0.11951561836705538, 0.4394734931348375, 0.30922146287453667, 0.6318704323147726], [0.12987027957280362, 0.6705659229837077, 0.46383253126978974, 0.274889987919257, 0.7474439936640761], [0.1879098553132461, 0.1522379385630518, 0.015355936564545813, 0.861300356312702, 0.49236554071343774]], [[0.5167156093215455, 0.11476261670583532, 0.10777613604762737, 0.33378340489470293, 0.5162306440186114], [0.7008722190433495, 0.4992703565129284, 0.8315584310390406, 0.37739233174698905, 0.028087991954701463], [0.42615227502611275, 0.08500262931736602, 0.3220544273636916, 0.9851546831184075, 0.8573542571210433], [0.23645571315893898, 0.3759624313127088, 0.43116513094431075, 0.7638683777001858, 0.03345712782056509], [0.038622770027903375, 0.11711786752871545, 0.6283249825850742, 0.4145466172444473, 0.8489256287623339], [0.28405789022783723, 0.4892520298094337, 0.7067857215297443, 0.5452011971650093, 0.31679997775695934]], [[0.1525427686133508, 0.5406034186244121, 0.14215650226214827, 0.9393044596914456, 0.5398906106106404], [0.1749153048569262, 0.7206425469169074, 0.10354719431977222, 0.7716447899740201, 0.4572891110790437], [0.13266195551253201, 0.037211036308801515, 0.9933779936899051, 0.2743682900876313, 0.9522486220717061], [0.5018363367370507, 0.5030153839254815, 0.0910697183721334, 0.950705818837975, 0.7328958645500868], [0.5187278381595511, 0.12025713907388602, 0.17567656948828547, 0.43216660514178373, 0.36225882073221694], [0.5581380068713327, 0.07634397475720878, 0.04034601931833981, 0.5111030866900542, 0.028501380929072284]], [[0.0595519540101761, 0.3763414581904063, 0.06177906973480196, 0.3854696266163501, 0.24175051590943641], [0.18777029710908766, 0.40467983148626285, 0.11990390563125708, 0.3496393671192708, 0.4348736293666029], [0.8300029469601379, 0.9328061824822222, 0.30833843446623255, 0.2926420497404363, 0.5665182742712181], [0.13741442640032386, 0.34971218472805743, 0.05321637916190736, 0.3790681437821276, 0.11415134572311048], [0.561812911802296, 0.6415937343956617, 0.9870915366766958, 0.19513866225944, 0.2072021488024639], [0.9474195185897651, 0.8646408384568184, 0.6160540494372189, 0.841407236750209, 0.20969214472148845]], [[0.874028822863436, 0.8673075096746405, 0.24811224848006264, 0.5083733142598797, 0.9297742638910044], [0.6791499961674852, 0.6605191053207405, 0.5597646005643659, 0.2688315646932502, 0.9784153715112589], [0.44750964562218287, 0.31145009655296385, 0.7285807096817771, 0.6077048132604675, 0.3422413082046126], [0.30379159085703733, 0.21450668516253235, 0.07848643674025946, 0.6257109065192588, 0.5056936381437552], [0.23484841075284613, 0.05512452558336267, 0.0189010682637637, 0.7384959296651173, 0.18825318915516998], [0.26664361938950665, 0.01411219378059636, 0.15063905483217888, 0.8744457175624959, 0.24206083474245776]], [[0.9539581984830721, 0.16434683840013897, 0.25326145865964433, 0.8677099684769924, 0.42660833869182113], [0.26782893919360584, 0.6928137627201797, 0.05122840398223982, 0.8906051765785046, 0.8415615453566596], [0.08579703513243586, 0.7986187466244946, 0.9611704418831957, 0.49206961915489345, 0.5681533501260378], [0.6797967402259275, 0.266726943216011, 0.6496612589883748, 0.4748675001029421, 0.40554180461357825], [0.9028015595875049, 0.7979031099484839, 0.9346076282036271, 0.8366518248871061, 0.041810601153301374], [0.6065293910758234, 0.6976368815154709, 0.6648574757163, 0.27195643475835074, 0.4256303514649916]], [[0.03902913808359587, 0.09409412769567327, 0.5605119006191839, 0.5824117644655802, 0.2012292906236388], [0.44820272374154624, 0.47207725974866155, 0.011336777535180254, 0.14252078330249296, 0.6243000572826787], [0.9928201077976171, 0.6503917479374361, 0.12021666718785995, 0.8214402970991066, 0.43153772118158407], [0.08370020921444421, 0.5998245833260225, 0.22804609816491894, 0.41678174737952944, 0.3182942498743513], [0.6428539475072395, 0.431034672806622, 0.10398209321647645, 0.2156755661320542, 0.5004452736380616], [0.7891842270707597, 0.009743265237635246, 0.6124272839894, 0.11588175867566619, 0.6040494237681695]], [[0.836807635478249, 0.228482966476935, 0.49551475247726773, 0.7740529258445351, 0.17557747925462064], [0.15256114270196153, 0.9050458686392603, 0.6946466513738965, 0.7365733630422217, 0.8439686276120403], [0.5394257808850114, 0.4884054991924638, 0.5562573515833802, 0.7170179689321408, 0.39093730515226144], [0.09516824671698387, 0.13559688458288466, 0.9739029580424036, 0.051717662340782455, 0.7116193374491492], [0.9436815284210033, 0.12925954724058308, 0.7222643778520782, 0.30245659798031066, 0.2369650183111639], [0.8526226082130755, 0.9093536915859838, 0.34705050939238014, 0.6326475367092674, 0.1759376343344612]], [[0.7897594364262527, 0.8812398878757064, 0.3186723521815287, 0.6529669842474817, 0.8764176978914925], [0.01537490624975646, 0.855735262079755, 0.5721143441720545, 0.4140153847751511, 0.5226158468487513], [0.824062008061992, 0.7221295495500296, 0.5012648506822494, 0.487652325937422, 0.8992577126953837], [0.2323422036036078, 0.09570169580913968, 0.6786381186954319, 0.7022117122057644, 0.5683860268209586], [0.26253654507815605, 0.2959530604047663, 0.617043228861707, 0.2729583423480324, 0.4996212124009408], [0.33207434988458706, 0.5104381761346494, 0.2293638996894345, 0.19806047831528317, 0.7339983398129095]], [[0.38572753736040655, 0.23256619116471444, 0.8584204014821601, 0.40170047652019636, 0.11587016526054772], [0.7080479638455524, 0.2799719892417042, 0.5652422453590413, 0.6236930402621592, 0.9625743710919205], [0.1911012006151671, 0.28417205727033834, 0.9322198320783206, 0.7182929063140008, 0.44933099697521217], [0.7347733972292894, 0.41338512320963283, 0.41005152137897816, 0.15641675422411383, 0.5220482465927828], [0.26266441418502784, 0.6335934359532995, 0.39860618283936455, 0.8537210327292983, 0.7713625911305236], [0.1479332331935591, 0.5910919631856151, 0.7137406204838045, 0.5144409116098255, 0.11394728199082904]], [[0.5032473941239355, 0.4328989896562977, 0.3257544359864233, 0.5825355715461468, 0.32487233298764095], [0.23555668700529053, 0.7359012753843811, 0.21337102138254227, 0.8052882554318365, 0.97916100621838], [0.44123871645315926, 0.8123923859918668, 0.16836772838981873, 0.7973035022008037, 0.9624671585337337], [0.517023394169903, 0.2557198042079394, 0.1608262682766265, 0.9166268292838645, 0.3245725386866942], [0.49700373088306593, 0.43343155117184584, 0.43521552045635725, 0.7652582604512472, 0.9351583193150276], [0.636774677228067, 0.9571382224472131, 0.19044466860803377, 0.5639372766283968, 0.685506985378391]], [[0.7149763296261568, 0.7558474510997049, 0.3331501016341646, 0.882194579502589, 0.1317055624519009], [0.27853571434901214, 0.46871400057662516, 0.591998092587852, 0.2952841816429165, 0.9078256449513591], [0.45184683151759064, 0.1003373341156848, 0.8190517657862706, 0.9654538957507879, 0.3463276500858449], [0.5546435845852176, 0.5830706027877518, 0.8016209188013812, 0.15183827386157545, 0.841254064030045], [0.7216095012513192, 0.03492009594121803, 0.5669151712722333, 0.028033767108961993, 0.4964399473360398], [0.5994131178177925, 0.6348797056291805, 0.9268786686877112, 0.29705701886078384, 0.8445658597384956]], [[0.45222121337041465, 0.6669398595884487, 0.8079434229226331, 0.7240411659088121, 0.7955005888889377], [0.6360695072072, 0.8007806089049284, 0.9090134767736376, 0.9044188415515816, 0.32788821950417424], [0.9719728273552545, 0.0576669963120644, 0.6164026934321674, 0.49522455770192064, 0.230476070159513], [0.5351480485798903, 0.0659546597000894, 0.5537141575902743, 0.8544654418738471, 0.14097241256290083], [0.32535218674087174, 0.6311232710517998, 0.35930127868712947, 0.41500302714768234, 0.3384508981600203], [0.4826698956039609, 0.3731959537273051, 0.14424832324587533, 0.1988127961986741, 0.07924659002326262]], [[0.4676570677191002, 0.8454039345087339, 0.09055108338518902, 0.6587254975151682, 0.4202231604535025], [0.8713810215947371, 0.36331354583071906, 0.6944433887319533, 0.39911222653602896, 0.5419484409878162], [0.7749456414423113, 0.9678570834494661, 0.13488744756620685, 0.5290970608690453, 0.13226864238439728], [0.030503720142378787, 0.7479506202532099, 0.9832713188441309, 0.5954032831362801, 0.07243264500451607], [0.061727978911657044, 0.31454736366780933, 0.3808840604283622, 0.003866484241020429, 0.8426829031324989], [0.4685797663827802, 0.9957076820805172, 0.8841469350947452, 0.5007763078118548, 0.6270581276779179]], [[0.3145519992520861, 0.30335610441348615, 0.13020496221070255, 0.5454002163552302, 0.08167126508348677], [0.44685965922843884, 0.32172441992697687, 0.7905333354077368, 0.38144561378471853, 0.9014953018499317], [0.18953043009076098, 0.93054657416206, 0.5932866446040553, 0.12024160222586466, 0.5021501704999409], [0.2679181873907608, 0.7490364969626329, 0.6513094388112957, 0.06273651131791269, 0.41754621986829077], [0.8871362031077711, 0.40782699264407696, 0.7436305616542056, 0.11338257123155238, 0.8669166269037822], [0.5024317633850213, 0.9475721682300842, 0.5373211719029536, 0.7692256838949744, 0.9721138959242149]], [[0.7293470099299623, 0.577273336360849, 0.3667081396093276, 0.04252508752590867, 0.4325457091579801], [0.41248045793044885, 0.8230622576375538, 0.1892527061979694, 0.7426448519538486, 0.037563612888741216], [0.8863653280941995, 0.6679425961129916, 0.4224437872706094, 0.2655077221340201, 0.18440104009534442], [0.585645135679011, 0.4102386749667679, 0.7430228925332476, 0.9067745514875638, 0.2956515460524055], [0.6499003572033311, 0.4227221924900907, 0.04273899302080575, 0.6154326729856577, 0.36370256582690297], [0.013726045326379777, 0.4722799810652025, 0.09166890087206325, 0.6281696577304559, 0.5264963654092994]], [[0.5003487431628697, 0.9368792084893011, 0.8804273787161917, 0.7139339666114515, 0.577540710721839], [0.2523693137024965, 0.008162767446609265, 0.11963474024441834, 0.320294229962523, 0.19672784590885373], [0.5700038224788883, 0.5349498174948405, 0.389791444940793, 0.8005445255305743, 0.7311571458516333], [0.6878828659239009, 0.5026752474435031, 0.043445229423661136, 0.42802772907525244, 0.4991818345516955], [0.44784759633650517, 0.004474626711733043, 0.6524288587852523, 0.25739277533083826, 0.044658824359445126], [0.5034686093793187, 0.9205473826612222, 0.02944028336602822, 0.013741593071443292, 0.5877480868627315]], [[0.5429862373083882, 0.015706348512828594, 0.10306875067440213, 0.8363946422946935, 0.45263844649673934], [0.12438726664102684, 0.1559204841607894, 0.6114227359945645, 0.328665994778778, 0.025705232049547777], [0.6360184962179287, 0.032352926052939046, 0.11027994849288891, 0.15876824849159765, 0.14327791148182034], [0.761562946342432, 0.0934454558835478, 0.1486415913275414, 0.4470155689846399, 0.14008369087914851], [0.746936027517557, 0.48774585066948795, 0.879643396240148, 0.03811587523794735, 0.8551983882808056], [0.15381095449142868, 0.9256347358855043, 0.3260411094752952, 0.5107830381944564, 0.02369407638066834]], [[0.7291389103622584, 0.213771285424862, 0.9166167425100258, 0.6617870457098052, 0.2836191455309717], [0.2609085892286507, 0.17047921327901827, 0.8018705034394569, 0.4384767489946366, 0.27694561143975127], [0.9528195121200644, 0.802240832233182, 0.5863030105015549, 0.8024486556923616, 0.12012674395756762], [0.6721637765313696, 0.32415157494616786, 0.6875089728299585, 0.9616571294304682, 0.7803595907073239], [0.5655588372489639, 0.7455332082200743, 0.4683316669173232, 0.27994517865066093, 0.04063403997170012], [0.6772030452593735, 0.14259143461115809, 0.45934796084424934, 0.6667545429094478, 0.8912940059690603]], [[0.6093636372547342, 0.2177246793830825, 0.47405565586584864, 0.6676200688843181, 0.19531752237312883], [0.7321717956305757, 0.7638242372709222, 0.5225293579175383, 0.8588012394980442, 0.22473983809083076], [0.5377374935872099, 0.894164183762562, 0.7041515108727725, 0.8068743135696138, 0.2220930223168458], [0.5727805812768629, 0.32404271547176233, 0.6589164331843178, 0.5226096468822, 0.6254888050590407], [0.6176700243373133, 0.7364358207481377, 0.7988822867835662, 0.061877768458453164, 0.9483768496816916], [0.4064449124008854, 0.1700970121859906, 0.9219801187179109, 0.7839914153748908, 0.420353809437209]], [[0.5999145144686872, 0.226197261451772, 0.4131303277190288, 0.4009399651127772, 0.754040439417072], [0.4317229954617603, 0.7548712885119567, 0.7900794282391057, 0.385619861610651, 0.44006333135797315], [0.5207159938186551, 0.003510696044525141, 0.19505500018472055, 0.8471371472082502, 0.76094030253111], [0.07715158047521509, 0.6348976650794832, 0.020735353158175984, 0.5342036691279171, 0.16148162818349876], [0.8534523470310466, 0.6148152219392081, 0.06398226218648662, 0.6412538606417006, 0.8921982110925353], [0.7337064022325901, 0.11520230767278927, 0.6650932640952021, 0.6107026804586011, 0.6313518640485368]], [[0.7951621306965382, 0.304419139269518, 0.35546852734595125, 0.2018161374633567, 0.4571760830790651], [0.4098433616918413, 0.0841018432522711, 0.2426065143827414, 0.11992758304959594, 0.5545083973033134], [0.18726652626029783, 0.32560219913276156, 0.817053335823799, 0.5718492202749439, 0.5195832923153049], [0.9443627442890116, 0.43735139078251306, 0.8836410845930377, 0.5778540051170096, 0.40533548163208066], [0.3460720743301008, 0.9033779832128846, 0.565245357783107, 0.2517135644049552, 0.5194688609363887], [0.24977089352473847, 0.24066889673321867, 0.12914135191368392, 0.6893092537821236, 0.7810436077246344]], [[0.3236119729431979, 0.4092966507907204, 0.7930680917284937, 0.01630319946630754, 0.33283095496479487], [0.30759438411770046, 0.5434516951075146, 0.8948692396828983, 0.04051673614469664, 0.8427713553455266], [0.5571278058016171, 0.5876669265986314, 0.9569656367103522, 0.1282831064381995, 0.2766435649769482], [0.2300518096949531, 0.468839957890701, 0.5798298600121987, 0.7278629745496702, 0.05303920645675886], [0.4261294201663096, 0.9242743346141207, 0.46259277420988687, 0.8176227191769204, 0.11197980678486319], [0.2896816676667924, 0.7353968891860327, 0.6213542370919418, 0.4431526625579515, 0.6689140002469732]], [[0.7709683033402449, 0.8975087092539015, 0.4403551122190561, 0.6426096986453004, 0.3814602801848396], [0.9270498648543265, 0.48068369278584977, 0.4105229906934824, 0.9394712577708223, 0.001961281908088419], [0.33197109064231656, 0.8382055695407933, 0.4514483492772493, 0.34838638534422983, 0.5878164141171678], [0.4046758169978758, 0.32950361604644496, 0.26597330504456207, 0.31304547218650813, 0.924162029492106], [0.9596729314494371, 0.09883059664712424, 0.7354138828691462, 0.6577626876293591, 0.630968665404158], [0.03284334570370728, 0.27345391561770005, 0.7461028700926283, 0.49580682898716244, 0.02388834519882166]], [[0.5265155549162496, 0.8478048808856727, 0.8784202538807585, 0.8986259549179076, 0.527332384836509], [0.46696758969810803, 0.24434462826666647, 0.8660775723135234, 0.7998571753218278, 0.8635748641433973], [0.22594496569261435, 0.09790293216466206, 0.6984450683405525, 0.9131511770439525, 0.9165767655006917], [0.5286314711994123, 0.6421052190536091, 0.11208119285020302, 0.27528778539056553, 0.5377509775277578], [0.8807688859034987, 0.484139728190661, 0.5927082440735193, 0.05553643537566688, 0.9646539928350718], [0.4924272227573304, 0.16027042870417663, 0.33897097235409335, 0.5133073399059025, 0.1385143090566613]], [[0.19664682452455484, 0.915896904725474, 0.8725525901719886, 0.12230210793411844, 0.2789979054025671], [0.6355843417029102, 0.25975364773136134, 0.0020838787635798495, 0.7012145666228212, 0.19307857376341664], [0.3249555433254241, 0.28393643551046754, 0.15236919790259218, 0.13568510496356856, 0.1449134952643405], [0.9674916853073376, 0.7268508833172903, 0.9400753783706342, 0.5715399303238873, 0.3310087591609415], [0.16392685014813946, 0.4833562954578343, 0.4933985104124673, 0.7774698269400762, 0.528439483527963], [0.19485034627852338, 0.814190702784407, 0.14791601404784016, 0.5289140108012512, 0.04246919770645574]], [[0.3691809440992293, 0.6718731713210726, 0.13870850810653435, 0.5248799921284021, 0.5388391688458419], [0.9093551124642789, 0.4666293736999204, 0.07835088424931014, 0.14593729391312482, 0.27560864012991926], [0.7989540175588655, 0.2551083285673835, 0.6094292917812019, 0.07838168970193882, 0.20214541958645416], [0.6191428258133745, 0.09813875382961756, 0.7155425901754682, 0.44910020257175187, 0.27957525138584205], [0.8739002522646546, 0.673158146918348, 0.06418438235411827, 0.6701976378921904, 0.19837923659104706], [0.9202589125636921, 0.15373198946529187, 0.6166895563041491, 0.24240650415698517, 0.9421664820451573]], [[0.32446719552707715, 0.5896365630842033, 0.12950937628619286, 0.47937205575852804, 0.6088362892110891], [0.7706961891023262, 0.5570674938278416, 0.7035988520793304, 0.8590815047297518, 0.29855674489777073], [0.3401669339305281, 0.02957385115650779, 0.5542618128654195, 0.9715309283465463, 0.7361026993008667], [0.9925855204972936, 0.4543520763573199, 0.7474735784826665, 0.16120827226217105, 0.4220064644911017], [0.6436138727174525, 0.45031205804301244, 0.029722184121927397, 0.31684260950695975, 0.6760677570305994], [0.3951937205791538, 0.4484049445863276, 0.856179176233806, 0.26939083034449174, 0.6159316145282703]], [[0.8457705568383859, 0.8071506269519579, 0.23872366644551513, 0.05108977065763043, 0.27682779033352545], [0.17640340523260734, 0.02771074949814023, 0.3043616434857568, 0.5208113899890295, 0.6503189786097899], [0.37789523296801897, 0.20428292239636137, 0.5693060331951527, 0.75236630587641, 0.6949516877790678], [0.8569845569668989, 0.2638670246226983, 0.503009832220081, 0.4884374037445324, 0.32158258287848884], [0.6864209866220572, 0.1342342048147659, 0.8051491327144351, 0.036619174163297075, 0.3881798489827343], [0.6073203455652825, 0.42436408706519413, 0.6556921456790803, 0.0388006149131479, 0.8671605076394512]], [[0.07765712692326643, 0.2877463221161809, 0.29336891585600755, 0.011813637171465441, 0.0940238805164284], [0.8518839291320732, 0.7758148477628192, 0.7379934794637975, 0.6892962031094357, 0.07453008397307914], [0.298657434279867, 0.006573277650610443, 0.06052102078277488, 0.037887595790137785, 0.19893400432708475], [0.056283547133671674, 0.016883784429005844, 0.2449147316233382, 0.7988539235655333, 0.056311004679027166], [0.9845492343178498, 0.6575832364081544, 0.8668208805965696, 0.6607009575771983, 0.776873739863259], [0.30077885471146637, 0.2573246988236051, 0.6644249776889313, 0.5631543533959745, 0.5056632576911053]], [[0.1772552455503119, 0.23064852320499507, 0.5497251122414206, 0.409918041247717, 0.9625122942927633], [0.5528223556900267, 0.4317116640505323, 0.9505988532342335, 0.09161385081875306, 0.2717819914832693], [0.34639443568268435, 0.8535026178683808, 0.7664119839578025, 0.30471417482051466, 0.8725633575295845], [0.06255666512954305, 0.4934669400921148, 0.654684237674076, 0.3121943143752183, 0.06917107239102072], [0.2571603093695294, 0.4837717724502756, 0.31810636007108817, 0.41567185646575766, 0.09312461771485603], [0.014273543491684637, 0.8776126475866897, 0.07811174585382918, 0.29282457597048817, 0.6640453737502613]], [[0.8445044303175884, 0.3212627366825419, 0.6520685017691679, 0.4721312932373858, 0.05101303307194649], [0.4083630031615427, 0.029848052465646147, 0.9641902975068014, 0.7621837999945748, 0.3392923295762893], [0.23474043001400113, 0.40032716873111773, 0.31616445726221376, 0.37079440882134285, 0.9187144294578184], [0.40452514359347935, 0.7413994912071714, 0.15681302089280846, 0.5336810764982988, 0.49373396347063037], [0.5912319467043519, 0.679887489864292, 0.8610194418145972, 0.22996724673665703, 0.3815341106582597], [0.057182787986143735, 0.6241812798877413, 0.934759914336219, 0.39619710872664193, 0.9717510813438395]], [[0.5978752446681308, 0.2112467092930197, 0.5295290252524105, 0.6400455455225241, 0.6662728323728844], [0.63804180835565, 0.18961396933845598, 0.2083105865383229, 0.24146305084159747, 0.7329939155277158], [0.4993545241525672, 0.6712555744068802, 0.7993634104207149, 0.5640695204012681, 0.4711410409176189], [0.4025150969950012, 0.5362628700975675, 0.1495784803877107, 0.7864455027447715, 0.912759237011567], [0.8123650360504925, 0.8218955666615354, 0.8294014126443887, 0.17564911571237385, 0.9958127294832733], [0.6571857904622997, 0.4209270640798972, 0.8880238522670358, 0.5823512729892273, 0.9936245090735015]], [[0.7520736944502041, 0.3675107092597262, 0.7425622253025, 0.7301099722250616, 0.31299077777679774], [0.8841752408568262, 0.1407649163672936, 0.36527351480394266, 0.6362741910278085, 0.4791391192082748], [0.6781558975859113, 0.9973536810729767, 0.0779966370611127, 0.7589688588327588, 0.8174245085509352], [0.28220144131343083, 0.2551560524061398, 0.4413576227998247, 0.39385675759328875, 0.5078190675621553], [0.21158420154225877, 0.4938004750350413, 0.8127524228070271, 0.8828833922678256, 0.6667622624685676], [0.2881304639480625, 0.8732451183417509, 0.42122791099470425, 0.23180719026488483, 0.13459730900796885]], [[0.9616688579428034, 0.08797915446473725, 0.5297604649347278, 0.20217727155719156, 0.8682803954620041], [0.19452669350945884, 0.736479759383793, 0.1651159684116591, 0.9381122486966124, 0.6633249994426855], [0.4151208649677005, 0.9624825097357574, 0.5240508615579871, 0.384073729311766, 0.16247550340774553], [0.7210893163713941, 0.5963329437895811, 0.2228928469779945, 0.2499618346489212, 0.2203821282570425], [0.4958418649817937, 0.04728931296200378, 0.2892474845576688, 0.7366239439973583, 0.6212299033326748], [0.8185961445046029, 0.7448249549157927, 0.021277337360341098, 0.5695691341122411, 0.4384167268033342]], [[0.36130004377240055, 0.9923815864613245, 0.6569633707552449, 0.2510700731386869, 0.5328660587046653], [0.09523193310604094, 0.74527327977779, 0.34765173962032714, 0.16888337283883592, 0.16242146297944748], [0.015228865370231603, 0.7778802532570951, 0.7286998756944413, 0.48502589249959716, 0.30596475590393424], [0.3916116527302088, 0.8840884919405085, 0.12129977222287758, 0.029564740126206024, 0.2157244497097106], [0.5206856333138149, 0.007682918194944266, 0.10426473414343551, 0.6978639818667118, 0.44806285712189364], [0.9486389600142845, 0.9107665676026114, 0.2764578964010457, 0.37771593005899584, 0.9181717313376463]], [[0.5792575947174932, 0.36972190776523073, 0.8004067053549497, 0.9245041076022759, 0.6734930647035785], [0.23090357775390158, 0.8192605158457326, 0.420526161414014, 0.6980465799124734, 0.48635361638350205], [0.9408649044174376, 0.06837524051873833, 0.15579670440750393, 0.19456826181614306, 0.22100050665950122], [0.2354276183604621, 0.1528502048557333, 0.692917552350085, 0.21815574826780815, 0.23545348102221586], [0.19738826222211403, 0.398687219691122, 0.9585931029863481, 0.3667802195520107, 0.29762417966413823], [0.06859959090399603, 0.3525275316392329, 0.23219604629767487, 0.7629273380216685, 0.11162829985626133]]])
    b = np.array([[[0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]], [[0.27591372180645746, 0.5350545571095502, 0.20010934490087728, 0.8999425369158052, 0.33810282491959054], [0.610334602657793, 0.12193298741989589, 0.6300171925284672, 0.27204033929140836, 0.9565315903711672], [0.39415426604133086, 0.607406556711858, 0.21581336566329634, 0.8614762028764, 0.8043329181204663], [0.2456353122757715, 0.9110485080061057, 0.040155022034127685, 0.7525731205167397, 0.4578687853426443], [0.835459394476964, 0.465485967436008, 0.06558209567040296, 0.22654553229584695, 0.9943748347169384], [0.3341776027693687, 0.16030521702543288, 0.8058308258054888, 0.045069827390500805, 0.06640875146876257]], [[0.2975187794543661, 0.04740097463539672, 0.9957126838923056, 0.6911288860821325, 0.5195864408573572], [0.8051663899562637, 0.6624868006119337, 0.17326495367589456, 0.2196337996488893, 0.8676942857212915], [0.3369613267738214, 0.4476403426248784, 0.3911357121233465, 0.05202981200504242, 0.7045737172836195], [0.5400740807862157, 0.6761400818139303, 0.27823138966714334, 0.4069139083269768, 0.19264976227164798], [0.41968263143719775, 0.6534914117970338, 0.944689043192468, 0.6634571998860077, 0.5251597299929988], [0.4163672224981614, 0.10554968426098033, 0.4770742969319903, 0.15510809316064378, 0.5821871830790901]], [[0.7302470776105839, 0.9464956116881924, 0.2968528676879666, 0.396905538757533, 0.18295193952533229], [0.8779405098804326, 0.8240772244494228, 0.7749598946732359, 0.057290038549901334, 0.5567194419749216], [0.23501356203546908, 0.11968519672230693, 0.7816131001833894, 0.21158137510768193, 0.5008116982476696], [0.5260963484005408, 0.21328200403897157, 0.49226116632238226, 0.052819897599996946, 7.2449638492178e-05], [0.8803219316643702, 0.4155887020861522, 0.9074197989533556, 0.49630735972825957, 0.4311082945881648], [0.29591214065860727, 0.08168893759303875, 0.30969464926452184, 0.6084702651738416, 0.7627863472229892]], [[0.5408255176538437, 0.7582558436964189, 0.15775159165898744, 0.5832399316791738, 0.8826032270257104], [0.21796020764080337, 0.2276689383929903, 0.7484325130680506, 0.8120567848487955, 0.24804632969409923], [0.3315698041877778, 0.6317694004506118, 0.3984317131891898, 0.6240109701292529, 0.4964300320967251], [0.773651309078725, 0.8458886469133242, 0.8638272093051601, 0.6115250777298431, 0.6125841045192504], [0.4496468988194058, 0.02761404496330544, 0.29918021946326245, 0.0636977185007408, 0.4377852488597531], [0.8494852489826142, 0.5968020177048212, 0.675532598269557, 0.18800797177707496, 0.26195314970279426]], [[0.16313215297289452, 0.8426887622604307, 0.28031301298749256, 0.5623263097012292, 0.14112861301900848], [0.12398890832731169, 0.34758336321601746, 0.3303531580600173, 0.32885323381140785, 0.6009327870197562], [0.31599015604044445, 0.7687358689747713, 0.09067076824664133, 0.3247858577376286, 0.6691931285020627], [0.60293211047753, 0.11951561836705538, 0.4394734931348375, 0.30922146287453667, 0.6318704323147726], [0.12987027957280362, 0.6705659229837077, 0.46383253126978974, 0.274889987919257, 0.7474439936640761], [0.1879098553132461, 0.1522379385630518, 0.015355936564545813, 0.861300356312702, 0.49236554071343774]], [[0.5167156093215455, 0.11476261670583532, 0.10777613604762737, 0.33378340489470293, 0.5162306440186114], [0.7008722190433495, 0.4992703565129284, 0.8315584310390406, 0.37739233174698905, 0.028087991954701463], [0.42615227502611275, 0.08500262931736602, 0.3220544273636916, 0.9851546831184075, 0.8573542571210433], [0.23645571315893898, 0.3759624313127088, 0.43116513094431075, 0.7638683777001858, 0.03345712782056509], [0.038622770027903375, 0.11711786752871545, 0.6283249825850742, 0.4145466172444473, 0.8489256287623339], [0.28405789022783723, 0.4892520298094337, 0.7067857215297443, 0.5452011971650093, 0.31679997775695934]], [[0.1525427686133508, 0.5406034186244121, 0.14215650226214827, 0.9393044596914456, 0.5398906106106404], [0.1749153048569262, 0.7206425469169074, 0.10354719431977222, 0.7716447899740201, 0.4572891110790437], [0.13266195551253201, 0.037211036308801515, 0.9933779936899051, 0.2743682900876313, 0.9522486220717061], [0.5018363367370507, 0.5030153839254815, 0.0910697183721334, 0.950705818837975, 0.7328958645500868], [0.5187278381595511, 0.12025713907388602, 0.17567656948828547, 0.43216660514178373, 0.36225882073221694], [0.5581380068713327, 0.07634397475720878, 0.04034601931833981, 0.5111030866900542, 0.028501380929072284]], [[0.0595519540101761, 0.3763414581904063, 0.06177906973480196, 0.3854696266163501, 0.24175051590943641], [0.18777029710908766, 0.40467983148626285, 0.11990390563125708, 0.3496393671192708, 0.4348736293666029], [0.8300029469601379, 0.9328061824822222, 0.30833843446623255, 0.2926420497404363, 0.5665182742712181], [0.13741442640032386, 0.34971218472805743, 0.05321637916190736, 0.3790681437821276, 0.11415134572311048], [0.561812911802296, 0.6415937343956617, 0.9870915366766958, 0.19513866225944, 0.2072021488024639], [0.9474195185897651, 0.8646408384568184, 0.6160540494372189, 0.841407236750209, 0.20969214472148845]], [[0.874028822863436, 0.8673075096746405, 0.24811224848006264, 0.5083733142598797, 0.9297742638910044], [0.6791499961674852, 0.6605191053207405, 0.5597646005643659, 0.2688315646932502, 0.9784153715112589], [0.44750964562218287, 0.31145009655296385, 0.7285807096817771, 0.6077048132604675, 0.3422413082046126], [0.30379159085703733, 0.21450668516253235, 0.07848643674025946, 0.6257109065192588, 0.5056936381437552], [0.23484841075284613, 0.05512452558336267, 0.0189010682637637, 0.7384959296651173, 0.18825318915516998], [0.26664361938950665, 0.01411219378059636, 0.15063905483217888, 0.8744457175624959, 0.24206083474245776]], [[0.9539581984830721, 0.16434683840013897, 0.25326145865964433, 0.8677099684769924, 0.42660833869182113], [0.26782893919360584, 0.6928137627201797, 0.05122840398223982, 0.8906051765785046, 0.8415615453566596], [0.08579703513243586, 0.7986187466244946, 0.9611704418831957, 0.49206961915489345, 0.5681533501260378], [0.6797967402259275, 0.266726943216011, 0.6496612589883748, 0.4748675001029421, 0.40554180461357825], [0.9028015595875049, 0.7979031099484839, 0.9346076282036271, 0.8366518248871061, 0.041810601153301374], [0.6065293910758234, 0.6976368815154709, 0.6648574757163, 0.27195643475835074, 0.4256303514649916]], [[0.03902913808359587, 0.09409412769567327, 0.5605119006191839, 0.5824117644655802, 0.2012292906236388], [0.44820272374154624, 0.47207725974866155, 0.011336777535180254, 0.14252078330249296, 0.6243000572826787], [0.9928201077976171, 0.6503917479374361, 0.12021666718785995, 0.8214402970991066, 0.43153772118158407], [0.08370020921444421, 0.5998245833260225, 0.22804609816491894, 0.41678174737952944, 0.3182942498743513], [0.6428539475072395, 0.431034672806622, 0.10398209321647645, 0.2156755661320542, 0.5004452736380616], [0.7891842270707597, 0.009743265237635246, 0.6124272839894, 0.11588175867566619, 0.6040494237681695]], [[0.836807635478249, 0.228482966476935, 0.49551475247726773, 0.7740529258445351, 0.17557747925462064], [0.15256114270196153, 0.9050458686392603, 0.6946466513738965, 0.7365733630422217, 0.8439686276120403], [0.5394257808850114, 0.4884054991924638, 0.5562573515833802, 0.7170179689321408, 0.39093730515226144], [0.09516824671698387, 0.13559688458288466, 0.9739029580424036, 0.051717662340782455, 0.7116193374491492], [0.9436815284210033, 0.12925954724058308, 0.7222643778520782, 0.30245659798031066, 0.2369650183111639], [0.8526226082130755, 0.9093536915859838, 0.34705050939238014, 0.6326475367092674, 0.1759376343344612]], [[0.7897594364262527, 0.8812398878757064, 0.3186723521815287, 0.6529669842474817, 0.8764176978914925], [0.01537490624975646, 0.855735262079755, 0.5721143441720545, 0.4140153847751511, 0.5226158468487513], [0.824062008061992, 0.7221295495500296, 0.5012648506822494, 0.487652325937422, 0.8992577126953837], [0.2323422036036078, 0.09570169580913968, 0.6786381186954319, 0.7022117122057644, 0.5683860268209586], [0.26253654507815605, 0.2959530604047663, 0.617043228861707, 0.2729583423480324, 0.4996212124009408], [0.33207434988458706, 0.5104381761346494, 0.2293638996894345, 0.19806047831528317, 0.7339983398129095]], [[0.38572753736040655, 0.23256619116471444, 0.8584204014821601, 0.40170047652019636, 0.11587016526054772], [0.7080479638455524, 0.2799719892417042, 0.5652422453590413, 0.6236930402621592, 0.9625743710919205], [0.1911012006151671, 0.28417205727033834, 0.9322198320783206, 0.7182929063140008, 0.44933099697521217], [0.7347733972292894, 0.41338512320963283, 0.41005152137897816, 0.15641675422411383, 0.5220482465927828], [0.26266441418502784, 0.6335934359532995, 0.39860618283936455, 0.8537210327292983, 0.7713625911305236], [0.1479332331935591, 0.5910919631856151, 0.7137406204838045, 0.5144409116098255, 0.11394728199082904]], [[0.5032473941239355, 0.4328989896562977, 0.3257544359864233, 0.5825355715461468, 0.32487233298764095], [0.23555668700529053, 0.7359012753843811, 0.21337102138254227, 0.8052882554318365, 0.97916100621838], [0.44123871645315926, 0.8123923859918668, 0.16836772838981873, 0.7973035022008037, 0.9624671585337337], [0.517023394169903, 0.2557198042079394, 0.1608262682766265, 0.9166268292838645, 0.3245725386866942], [0.49700373088306593, 0.43343155117184584, 0.43521552045635725, 0.7652582604512472, 0.9351583193150276], [0.636774677228067, 0.9571382224472131, 0.19044466860803377, 0.5639372766283968, 0.685506985378391]], [[0.7149763296261568, 0.7558474510997049, 0.3331501016341646, 0.882194579502589, 0.1317055624519009], [0.27853571434901214, 0.46871400057662516, 0.591998092587852, 0.2952841816429165, 0.9078256449513591], [0.45184683151759064, 0.1003373341156848, 0.8190517657862706, 0.9654538957507879, 0.3463276500858449], [0.5546435845852176, 0.5830706027877518, 0.8016209188013812, 0.15183827386157545, 0.841254064030045], [0.7216095012513192, 0.03492009594121803, 0.5669151712722333, 0.028033767108961993, 0.4964399473360398], [0.5994131178177925, 0.6348797056291805, 0.9268786686877112, 0.29705701886078384, 0.8445658597384956]], [[0.45222121337041465, 0.6669398595884487, 0.8079434229226331, 0.7240411659088121, 0.7955005888889377], [0.6360695072072, 0.8007806089049284, 0.9090134767736376, 0.9044188415515816, 0.32788821950417424], [0.9719728273552545, 0.0576669963120644, 0.6164026934321674, 0.49522455770192064, 0.230476070159513], [0.5351480485798903, 0.0659546597000894, 0.5537141575902743, 0.8544654418738471, 0.14097241256290083], [0.32535218674087174, 0.6311232710517998, 0.35930127868712947, 0.41500302714768234, 0.3384508981600203], [0.4826698956039609, 0.3731959537273051, 0.14424832324587533, 0.1988127961986741, 0.07924659002326262]], [[0.4676570677191002, 0.8454039345087339, 0.09055108338518902, 0.6587254975151682, 0.4202231604535025], [0.8713810215947371, 0.36331354583071906, 0.6944433887319533, 0.39911222653602896, 0.5419484409878162], [0.7749456414423113, 0.9678570834494661, 0.13488744756620685, 0.5290970608690453, 0.13226864238439728], [0.030503720142378787, 0.7479506202532099, 0.9832713188441309, 0.5954032831362801, 0.07243264500451607], [0.061727978911657044, 0.31454736366780933, 0.3808840604283622, 0.003866484241020429, 0.8426829031324989], [0.4685797663827802, 0.9957076820805172, 0.8841469350947452, 0.5007763078118548, 0.6270581276779179]], [[0.3145519992520861, 0.30335610441348615, 0.13020496221070255, 0.5454002163552302, 0.08167126508348677], [0.44685965922843884, 0.32172441992697687, 0.7905333354077368, 0.38144561378471853, 0.9014953018499317], [0.18953043009076098, 0.93054657416206, 0.5932866446040553, 0.12024160222586466, 0.5021501704999409], [0.2679181873907608, 0.7490364969626329, 0.6513094388112957, 0.06273651131791269, 0.41754621986829077], [0.8871362031077711, 0.40782699264407696, 0.7436305616542056, 0.11338257123155238, 0.8669166269037822], [0.5024317633850213, 0.9475721682300842, 0.5373211719029536, 0.7692256838949744, 0.9721138959242149]], [[0.7293470099299623, 0.577273336360849, 0.3667081396093276, 0.04252508752590867, 0.4325457091579801], [0.41248045793044885, 0.8230622576375538, 0.1892527061979694, 0.7426448519538486, 0.037563612888741216], [0.8863653280941995, 0.6679425961129916, 0.4224437872706094, 0.2655077221340201, 0.18440104009534442], [0.585645135679011, 0.4102386749667679, 0.7430228925332476, 0.9067745514875638, 0.2956515460524055], [0.6499003572033311, 0.4227221924900907, 0.04273899302080575, 0.6154326729856577, 0.36370256582690297], [0.013726045326379777, 0.4722799810652025, 0.09166890087206325, 0.6281696577304559, 0.5264963654092994]], [[0.5003487431628697, 0.9368792084893011, 0.8804273787161917, 0.7139339666114515, 0.577540710721839], [0.2523693137024965, 0.008162767446609265, 0.11963474024441834, 0.320294229962523, 0.19672784590885373], [0.5700038224788883, 0.5349498174948405, 0.389791444940793, 0.8005445255305743, 0.7311571458516333], [0.6878828659239009, 0.5026752474435031, 0.043445229423661136, 0.42802772907525244, 0.4991818345516955], [0.44784759633650517, 0.004474626711733043, 0.6524288587852523, 0.25739277533083826, 0.044658824359445126], [0.5034686093793187, 0.9205473826612222, 0.02944028336602822, 0.013741593071443292, 0.5877480868627315]], [[0.5429862373083882, 0.015706348512828594, 0.10306875067440213, 0.8363946422946935, 0.45263844649673934], [0.12438726664102684, 0.1559204841607894, 0.6114227359945645, 0.328665994778778, 0.025705232049547777], [0.6360184962179287, 0.032352926052939046, 0.11027994849288891, 0.15876824849159765, 0.14327791148182034], [0.761562946342432, 0.0934454558835478, 0.1486415913275414, 0.4470155689846399, 0.14008369087914851], [0.746936027517557, 0.48774585066948795, 0.879643396240148, 0.03811587523794735, 0.8551983882808056], [0.15381095449142868, 0.9256347358855043, 0.3260411094752952, 0.5107830381944564, 0.02369407638066834]], [[0.7291389103622584, 0.213771285424862, 0.9166167425100258, 0.6617870457098052, 0.2836191455309717], [0.2609085892286507, 0.17047921327901827, 0.8018705034394569, 0.4384767489946366, 0.27694561143975127], [0.9528195121200644, 0.802240832233182, 0.5863030105015549, 0.8024486556923616, 0.12012674395756762], [0.6721637765313696, 0.32415157494616786, 0.6875089728299585, 0.9616571294304682, 0.7803595907073239], [0.5655588372489639, 0.7455332082200743, 0.4683316669173232, 0.27994517865066093, 0.04063403997170012], [0.6772030452593735, 0.14259143461115809, 0.45934796084424934, 0.6667545429094478, 0.8912940059690603]], [[0.6093636372547342, 0.2177246793830825, 0.47405565586584864, 0.6676200688843181, 0.19531752237312883], [0.7321717956305757, 0.7638242372709222, 0.5225293579175383, 0.8588012394980442, 0.22473983809083076], [0.5377374935872099, 0.894164183762562, 0.7041515108727725, 0.8068743135696138, 0.2220930223168458], [0.5727805812768629, 0.32404271547176233, 0.6589164331843178, 0.5226096468822, 0.6254888050590407], [0.6176700243373133, 0.7364358207481377, 0.7988822867835662, 0.061877768458453164, 0.9483768496816916], [0.4064449124008854, 0.1700970121859906, 0.9219801187179109, 0.7839914153748908, 0.420353809437209]], [[0.5999145144686872, 0.226197261451772, 0.4131303277190288, 0.4009399651127772, 0.754040439417072], [0.4317229954617603, 0.7548712885119567, 0.7900794282391057, 0.385619861610651, 0.44006333135797315], [0.5207159938186551, 0.003510696044525141, 0.19505500018472055, 0.8471371472082502, 0.76094030253111], [0.07715158047521509, 0.6348976650794832, 0.020735353158175984, 0.5342036691279171, 0.16148162818349876], [0.8534523470310466, 0.6148152219392081, 0.06398226218648662, 0.6412538606417006, 0.8921982110925353], [0.7337064022325901, 0.11520230767278927, 0.6650932640952021, 0.6107026804586011, 0.6313518640485368]], [[0.7951621306965382, 0.304419139269518, 0.35546852734595125, 0.2018161374633567, 0.4571760830790651], [0.4098433616918413, 0.0841018432522711, 0.2426065143827414, 0.11992758304959594, 0.5545083973033134], [0.18726652626029783, 0.32560219913276156, 0.817053335823799, 0.5718492202749439, 0.5195832923153049], [0.9443627442890116, 0.43735139078251306, 0.8836410845930377, 0.5778540051170096, 0.40533548163208066], [0.3460720743301008, 0.9033779832128846, 0.565245357783107, 0.2517135644049552, 0.5194688609363887], [0.24977089352473847, 0.24066889673321867, 0.12914135191368392, 0.6893092537821236, 0.7810436077246344]], [[0.3236119729431979, 0.4092966507907204, 0.7930680917284937, 0.01630319946630754, 0.33283095496479487], [0.30759438411770046, 0.5434516951075146, 0.8948692396828983, 0.04051673614469664, 0.8427713553455266], [0.5571278058016171, 0.5876669265986314, 0.9569656367103522, 0.1282831064381995, 0.2766435649769482], [0.2300518096949531, 0.468839957890701, 0.5798298600121987, 0.7278629745496702, 0.05303920645675886], [0.4261294201663096, 0.9242743346141207, 0.46259277420988687, 0.8176227191769204, 0.11197980678486319], [0.2896816676667924, 0.7353968891860327, 0.6213542370919418, 0.4431526625579515, 0.6689140002469732]], [[0.7709683033402449, 0.8975087092539015, 0.4403551122190561, 0.6426096986453004, 0.3814602801848396], [0.9270498648543265, 0.48068369278584977, 0.4105229906934824, 0.9394712577708223, 0.001961281908088419], [0.33197109064231656, 0.8382055695407933, 0.4514483492772493, 0.34838638534422983, 0.5878164141171678], [0.4046758169978758, 0.32950361604644496, 0.26597330504456207, 0.31304547218650813, 0.924162029492106], [0.9596729314494371, 0.09883059664712424, 0.7354138828691462, 0.6577626876293591, 0.630968665404158], [0.03284334570370728, 0.27345391561770005, 0.7461028700926283, 0.49580682898716244, 0.02388834519882166]], [[0.5265155549162496, 0.8478048808856727, 0.8784202538807585, 0.8986259549179076, 0.527332384836509], [0.46696758969810803, 0.24434462826666647, 0.8660775723135234, 0.7998571753218278, 0.8635748641433973], [0.22594496569261435, 0.09790293216466206, 0.6984450683405525, 0.9131511770439525, 0.9165767655006917], [0.5286314711994123, 0.6421052190536091, 0.11208119285020302, 0.27528778539056553, 0.5377509775277578], [0.8807688859034987, 0.484139728190661, 0.5927082440735193, 0.05553643537566688, 0.9646539928350718], [0.4924272227573304, 0.16027042870417663, 0.33897097235409335, 0.5133073399059025, 0.1385143090566613]], [[0.19664682452455484, 0.915896904725474, 0.8725525901719886, 0.12230210793411844, 0.2789979054025671], [0.6355843417029102, 0.25975364773136134, 0.0020838787635798495, 0.7012145666228212, 0.19307857376341664], [0.3249555433254241, 0.28393643551046754, 0.15236919790259218, 0.13568510496356856, 0.1449134952643405], [0.9674916853073376, 0.7268508833172903, 0.9400753783706342, 0.5715399303238873, 0.3310087591609415], [0.16392685014813946, 0.4833562954578343, 0.4933985104124673, 0.7774698269400762, 0.528439483527963], [0.19485034627852338, 0.814190702784407, 0.14791601404784016, 0.5289140108012512, 0.04246919770645574]], [[0.3691809440992293, 0.6718731713210726, 0.13870850810653435, 0.5248799921284021, 0.5388391688458419], [0.9093551124642789, 0.4666293736999204, 0.07835088424931014, 0.14593729391312482, 0.27560864012991926], [0.7989540175588655, 0.2551083285673835, 0.6094292917812019, 0.07838168970193882, 0.20214541958645416], [0.6191428258133745, 0.09813875382961756, 0.7155425901754682, 0.44910020257175187, 0.27957525138584205], [0.8739002522646546, 0.673158146918348, 0.06418438235411827, 0.6701976378921904, 0.19837923659104706], [0.9202589125636921, 0.15373198946529187, 0.6166895563041491, 0.24240650415698517, 0.9421664820451573]], [[0.32446719552707715, 0.5896365630842033, 0.12950937628619286, 0.47937205575852804, 0.6088362892110891], [0.7706961891023262, 0.5570674938278416, 0.7035988520793304, 0.8590815047297518, 0.29855674489777073], [0.3401669339305281, 0.02957385115650779, 0.5542618128654195, 0.9715309283465463, 0.7361026993008667], [0.9925855204972936, 0.4543520763573199, 0.7474735784826665, 0.16120827226217105, 0.4220064644911017], [0.6436138727174525, 0.45031205804301244, 0.029722184121927397, 0.31684260950695975, 0.6760677570305994], [0.3951937205791538, 0.4484049445863276, 0.856179176233806, 0.26939083034449174, 0.6159316145282703]], [[0.8457705568383859, 0.8071506269519579, 0.23872366644551513, 0.05108977065763043, 0.27682779033352545], [0.17640340523260734, 0.02771074949814023, 0.3043616434857568, 0.5208113899890295, 0.6503189786097899], [0.37789523296801897, 0.20428292239636137, 0.5693060331951527, 0.75236630587641, 0.6949516877790678], [0.8569845569668989, 0.2638670246226983, 0.503009832220081, 0.4884374037445324, 0.32158258287848884], [0.6864209866220572, 0.1342342048147659, 0.8051491327144351, 0.036619174163297075, 0.3881798489827343], [0.6073203455652825, 0.42436408706519413, 0.6556921456790803, 0.0388006149131479, 0.8671605076394512]], [[0.07765712692326643, 0.2877463221161809, 0.29336891585600755, 0.011813637171465441, 0.0940238805164284], [0.8518839291320732, 0.7758148477628192, 0.7379934794637975, 0.6892962031094357, 0.07453008397307914], [0.298657434279867, 0.006573277650610443, 0.06052102078277488, 0.037887595790137785, 0.19893400432708475], [0.056283547133671674, 0.016883784429005844, 0.2449147316233382, 0.7988539235655333, 0.056311004679027166], [0.9845492343178498, 0.6575832364081544, 0.8668208805965696, 0.6607009575771983, 0.776873739863259], [0.30077885471146637, 0.2573246988236051, 0.6644249776889313, 0.5631543533959745, 0.5056632576911053]], [[0.1772552455503119, 0.23064852320499507, 0.5497251122414206, 0.409918041247717, 0.9625122942927633], [0.5528223556900267, 0.4317116640505323, 0.9505988532342335, 0.09161385081875306, 0.2717819914832693], [0.34639443568268435, 0.8535026178683808, 0.7664119839578025, 0.30471417482051466, 0.8725633575295845], [0.06255666512954305, 0.4934669400921148, 0.654684237674076, 0.3121943143752183, 0.06917107239102072], [0.2571603093695294, 0.4837717724502756, 0.31810636007108817, 0.41567185646575766, 0.09312461771485603], [0.014273543491684637, 0.8776126475866897, 0.07811174585382918, 0.29282457597048817, 0.6640453737502613]], [[0.8445044303175884, 0.3212627366825419, 0.6520685017691679, 0.4721312932373858, 0.05101303307194649], [0.4083630031615427, 0.029848052465646147, 0.9641902975068014, 0.7621837999945748, 0.3392923295762893], [0.23474043001400113, 0.40032716873111773, 0.31616445726221376, 0.37079440882134285, 0.9187144294578184], [0.40452514359347935, 0.7413994912071714, 0.15681302089280846, 0.5336810764982988, 0.49373396347063037], [0.5912319467043519, 0.679887489864292, 0.8610194418145972, 0.22996724673665703, 0.3815341106582597], [0.057182787986143735, 0.6241812798877413, 0.934759914336219, 0.39619710872664193, 0.9717510813438395]], [[0.5978752446681308, 0.2112467092930197, 0.5295290252524105, 0.6400455455225241, 0.6662728323728844], [0.63804180835565, 0.18961396933845598, 0.2083105865383229, 0.24146305084159747, 0.7329939155277158], [0.4993545241525672, 0.6712555744068802, 0.7993634104207149, 0.5640695204012681, 0.4711410409176189], [0.4025150969950012, 0.5362628700975675, 0.1495784803877107, 0.7864455027447715, 0.912759237011567], [0.8123650360504925, 0.8218955666615354, 0.8294014126443887, 0.17564911571237385, 0.9958127294832733], [0.6571857904622997, 0.4209270640798972, 0.8880238522670358, 0.5823512729892273, 0.9936245090735015]], [[0.7520736944502041, 0.3675107092597262, 0.7425622253025, 0.7301099722250616, 0.31299077777679774], [0.8841752408568262, 0.1407649163672936, 0.36527351480394266, 0.6362741910278085, 0.4791391192082748], [0.6781558975859113, 0.9973536810729767, 0.0779966370611127, 0.7589688588327588, 0.8174245085509352], [0.28220144131343083, 0.2551560524061398, 0.4413576227998247, 0.39385675759328875, 0.5078190675621553], [0.21158420154225877, 0.4938004750350413, 0.8127524228070271, 0.8828833922678256, 0.6667622624685676], [0.2881304639480625, 0.8732451183417509, 0.42122791099470425, 0.23180719026488483, 0.13459730900796885]], [[0.9616688579428034, 0.08797915446473725, 0.5297604649347278, 0.20217727155719156, 0.8682803954620041], [0.19452669350945884, 0.736479759383793, 0.1651159684116591, 0.9381122486966124, 0.6633249994426855], [0.4151208649677005, 0.9624825097357574, 0.5240508615579871, 0.384073729311766, 0.16247550340774553], [0.7210893163713941, 0.5963329437895811, 0.2228928469779945, 0.2499618346489212, 0.2203821282570425], [0.4958418649817937, 0.04728931296200378, 0.2892474845576688, 0.7366239439973583, 0.6212299033326748], [0.8185961445046029, 0.7448249549157927, 0.021277337360341098, 0.5695691341122411, 0.4384167268033342]], [[0.36130004377240055, 0.9923815864613245, 0.6569633707552449, 0.2510700731386869, 0.5328660587046653], [0.09523193310604094, 0.74527327977779, 0.34765173962032714, 0.16888337283883592, 0.16242146297944748], [0.015228865370231603, 0.7778802532570951, 0.7286998756944413, 0.48502589249959716, 0.30596475590393424], [0.3916116527302088, 0.8840884919405085, 0.12129977222287758, 0.029564740126206024, 0.2157244497097106], [0.5206856333138149, 0.007682918194944266, 0.10426473414343551, 0.6978639818667118, 0.44806285712189364], [0.9486389600142845, 0.9107665676026114, 0.2764578964010457, 0.37771593005899584, 0.9181717313376463]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(5)
    np.random.seed(0)
    a = np.array([[[0.14368104195420506, 0.2785103008781139], [0.2880268293353051, 0.846304936696113], [0.7912836564504873, 0.5786356332052254], [0.2885886788600466, 0.31887835321099234], [0.5922182749826447, 0.739866558764824]], [[0.3840980551084494, 0.5095620286443752], [0.888033136532694, 0.6497908567084307], [0.5355501320419, 0.07122246114189124], [0.17601521177791102, 0.20099158381562332], [0.6231482924522946, 0.10811275170455004]], [[0.02899486998162648, 0.3603505576518653], [0.7188591785088077, 0.6932493543020594], [0.7926703519503892, 0.6962482562693095], [0.6132855786014619, 0.4861620967576452], [0.20849832048797057, 0.568548055856618]], [[0.6366247482083411, 0.12374332841471625], [0.5651473386031348, 0.0977487131935516], [0.5470768023064918, 0.15891889101864154], [0.11901354720833301, 0.11310005601383666], [0.9110253128309069, 0.5980873174524421]], [[0.250158722202139, 0.07144887799209143], [0.5361814185121025, 0.1448029708768086], [0.7784029344045007, 0.4961096566018073], [0.7264488848573398, 0.39572659882014205], [0.7023227446203606, 0.6846143563430122]], [[0.5614162080757035, 0.8457396341581295], [0.5824735736023768, 0.5781104107798223], [0.3079831073423336, 0.9315062661175667], [0.5171395715537852, 0.3917146575735714], [0.5416422915626176, 0.14524213873473746]], [[0.26512523712120484, 0.3066818621698084], [0.5151587691813213, 0.6955108338077768], [0.2872024621277156, 0.13576599558889135], [0.5592181827752403, 0.8546498313787537], [0.41823208636807807, 0.4757729089470616]], [[0.28920851215486254, 0.8088341233160536], [0.12066494538423844, 0.17108871769211698], [0.999956612757725, 0.68221575262952], [0.5480524065767105, 0.7951079451583122], [0.9968824546714417, 0.1908742808507543]], [[0.7913930387577761, 0.34216208258716074], [0.7312326849852712, 0.707659727537777], [0.9983300427980413, 0.11187205183646587], [0.002125394816527737, 0.7477844646111228], [0.5687769182988068, 0.6908741279616568]], [[0.7535250348263978, 0.49350655177583624], [0.35653452504058447, 0.7703758863024983], [0.38012992866605444, 0.6221922694904162], [0.8934060265156545, 0.15839147210138893], [0.008906159891957532, 0.2567566111986991]], [[0.7974719434465888, 0.5668256424901608], [0.9461608635354319, 0.5478740998616793], [0.2657813825886495, 0.7658853046993359], [0.6575503859150104, 0.8206833599615864], [0.6679984760224175, 0.4519490103695154]], [[0.2770826690937104, 0.05560046476925895], [0.30793625267536595, 0.046258477566618716], [0.4300270707520374, 0.22579991189048032], [0.7036476082919896, 0.22017852655650105], [0.08143183556633804, 0.8387972783999728]], [[0.06003286029426502, 0.7509584593494921], [0.9294253259816334, 0.10712911868137465], [0.5596679298690939, 0.45172671025336775], [0.7987100587162235, 0.6234800061046875], [0.27827343657115255, 0.0014690061423702216]], [[0.48286772884151574, 0.8941088823934664], [0.9053631703226672, 0.12529698305349435], [0.8606769673586889, 0.034431285796814204], [0.0923492753402122, 0.9662208123645003], [0.38696740719155476, 0.07078389665272089]], [[0.47045535435352137, 0.04613701973475881], [0.016370154899359557, 0.5617502294358646], [0.21120621979509668, 0.6219125897882664], [0.3346992638436814, 0.13247703288460277], [0.9844018582283378, 0.24994141548209736]], [[0.06197714607419669, 0.2788366202003293], [0.2517000559002116, 0.29964630421758], [0.35567423120074626, 0.805165180779569], [0.05978443594780192, 0.3545326700657575], [0.1037455429652312, 0.98219664609004]], [[0.14397173231415317, 0.47903494480879594], [0.48004343260390914, 0.7811782085684592], [0.2721458712913333, 0.7377738575166696], [0.026338559140857365, 0.9271504376473235], [0.09895565125791772, 0.4808295043785561]], [[0.173429713261673, 0.3686167729658242], [0.6420205167694868, 0.14247217497645148], [0.28910851993044273, 0.6791823327035098], [0.8445445475971349, 0.5928977624010155], [0.5229846652790235, 0.10960901226998943]], [[0.14654046155326628, 0.9581913711575495], [0.002624860083645486, 0.48441868634742913], [0.7563424807421246, 0.20996303020627838], [0.4595637163278635, 0.49306119094522105], [0.26039715770152805, 0.8787512510661757]], [[0.9251561800722323, 0.7493368504188268], [0.008636591717047004, 0.6289255677324158], [0.23211186798059924, 0.2671846591139656], [0.1838039549041236, 0.5724114284565913], [0.44671865595349747, 0.1935641093694338]], [[0.9326409310201179, 0.23922315331943134], [0.7787389035071219, 0.0246909002536293], [0.1834801085039569, 0.8188660675130984], [0.5364265561008478, 0.6461075337502055], [0.4288983913728056, 0.43563212969053056]], [[0.12540401379846733, 0.17099264596837205], [0.9189970768861909, 0.4576321023341422], [0.47245508902480304, 0.6663307728957538], [0.014126955040330125, 0.5326941533974526], [0.8853355518909605, 0.4173045001510062]], [[0.4126036845593929, 0.4533102546064802], [0.855102052504438, 0.6100010861688293], [0.7473509030134442, 0.7181501574265468], [0.050859749137671106, 0.9766996259784294], [0.7062081723958772, 0.5801252461787159]], [[0.04517657994964286, 0.9180811903386481], [0.46955681635503677, 0.9111923814169858], [0.41840693357402226, 0.5773050001280438], [0.8937179295227337, 0.4608309328740219], [0.179531403193542, 0.425064913413416]], [[0.3816266291686622, 0.7308630646988544], [0.8407336265712709, 0.011332262308606733], [0.4948151340913788, 0.2672670392793085], [0.1644326896777859, 0.6657056675713746], [0.8355456411719434, 0.5444057539893283]], [[0.19379415706109637, 0.7512853270023069], [0.521332668957369, 0.8046381267954097], [0.9647228264676314, 0.4193509917347735], [0.31900209544614655, 0.28207950904934764], [0.6909864666521672, 0.9718774081798304]], [[0.28581895410133673, 0.4622782156644186], [0.5763309264619612, 0.953923591046441], [0.24714516599113512, 0.9616329756751311], [0.5240260945909234, 0.7283869620900051], [0.7813408967587969, 0.16460922889673513]], [[0.9747446050002133, 0.9761205778081664], [0.8661700552572066, 0.8433548154726485], [0.32626442173019976, 0.8520664607012145], [0.888327957126259, 0.26652645122604], [0.17065621992700863, 0.7569787491436959]], [[0.5777352938932433, 0.10786319983515924], [0.39950559905810434, 0.3319999451656266], [0.6606908139969728, 0.42040515401811773], [0.6486762994843933, 0.7993880680782421], [0.7070725522656809, 0.6175353429074992]], [[0.9064677298230023, 0.24778175672116975], [0.5075564988529657, 0.7561116530041684], [0.2240343969920071, 0.21169364161314275], [0.6842730451542361, 0.7806391567523404], [0.8863647883097012, 0.448313688960427]], [[0.7162960923749074, 0.17094955422760316], [0.31475925240046, 0.6321208142767394], [0.14788355200649672, 0.9556823886948198], [0.12785747778850032, 0.7767641682552443], [0.3186138552686252, 0.7329052810947219]], [[0.4047577078817064, 0.7476288452455946], [0.9003383427056294, 0.596143336808424], [0.16392806682708638, 0.9510694250493024], [0.5324855828460552, 0.23942739403832702], [0.40842730056298027, 0.7210925516817865]], [[0.9353004083865615, 0.906586317718425], [0.1402892979004947, 0.8717895851144974], [0.5901671803162138, 0.4096794649589717], [0.4643670243334074, 0.7946117182649748], [0.8447750794029858, 0.6578968947929291]], [[0.05846129302789316, 0.8084636732940402], [0.02574421374986946, 0.38776814202180654], [0.4441674377121183, 0.5061066941653564], [0.25595339279506435, 0.41906619138035706], [0.7872984265883982, 0.2712664066841647]], [[0.813250761971703, 0.01257585087361901], [0.1427988669081106, 0.9253006741749734], [0.470399929220913, 0.0507976399034783], [0.6104432526277288, 0.45600704079758625], [0.08858766880180191, 0.3479624931488631]], [[0.6144260843539989, 0.6277085445621183], [0.8869030296057585, 0.4925060893830898], [0.10473779394108029, 0.11355310707342303], [0.41680330673072363, 0.18532113872958167], [0.920953832813547, 0.21207824268878284]], [[0.37636975659376704, 0.5123818824025214], [0.3304022373824873, 0.6645962662177829], [0.6052555559952119, 0.9393676947880834], [0.8319590605471314, 0.602961688608744], [0.44671171264723797, 0.6147746872507094]], [[0.6230659995840971, 0.26957759993600894], [0.17801758545621216, 0.5190075537779674], [0.30726313050546394, 0.38523044669218276], [0.0016636236770103396, 0.6816779778478236], [0.05801545716674017, 0.7354714682019439]], [[0.20795985807265882, 0.16476490315500458], [0.6005562261662398, 0.983472938004841], [0.422069590165532, 0.8693191020642691], [0.06184087559631579, 0.5086682574346568], [0.6817658642516381, 0.37538921899023237]], [[0.12946952245179288, 0.015406445826905868], [0.386742336087597, 0.7427384671441736], [0.9905517338292045, 0.463072623691111], [0.29491717747170043, 0.3466668410446121], [0.0919310791981881, 0.4501132322637529]], [[0.6271286230489581, 0.6235774122370806], [0.012769027512908315, 0.6337319645410171], [0.6656864286583842, 0.5020245284001009], [0.9448792994203108, 0.2580447441626178], [0.8519159086521346, 0.17422156381205622]], [[0.26195517446124195, 0.20489877507182785], [0.8853194963608946, 0.7935256794748252], [0.45048377510744886, 0.3780230719022343], [0.012901289752904943, 0.7019395885371039], [0.9649381252645671, 0.7785193236144732]], [[0.23307662621872693, 0.26450203141016915], [0.42280286547876544, 0.40773168314327146], [0.23233768146807765, 0.7916177877945543], [0.7860856998841623, 0.7064708347768158], [0.004960601569080403, 0.9173782984001366]], [[0.33755810510619455, 0.02881875534567513], [0.6374190342166811, 0.7375992951678767], [0.6709610146245125, 0.390916248130311], [0.8611660005168904, 0.3565085103885969], [0.5382582499869688, 0.9217565393954021]], [[0.7278953217243236, 0.09466832290906735], [0.7771386408104728, 0.9016909835425745], [0.8253882832161519, 0.476765285507181], [0.825147791285258, 0.07562909096681703], [0.2542266118257689, 0.8668668960548604]], [[0.041387811207380776, 0.398054019170217], [0.8604698857564332, 0.4458547688324669], [0.08462076875400237, 0.4591125232267155], [0.7322159326873108, 0.316391974184027], [0.9065309185714046, 0.9407964010550062]], [[0.16776558081439097, 0.09338643816287384], [0.29935680334672377, 0.4690426473292233], [0.1570140717954216, 0.2415683130951558], [0.9332987532821024, 0.714880021494959], [0.597945994636332, 0.7079557172208512]], [[0.0027258690094982274, 0.14552136695687945], [0.6917502243332091, 0.714968497917107], [0.8529729216982259, 0.5855502284762111], [0.5572500439659939, 0.39763773907824995], [0.8165560804305209, 0.8520230521498826]]])
    b = np.array([[[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

    tform = ndl.data.RandomCrop(8)
    np.random.seed(0)
    a = np.array([[[0.45159296307332175, 0.37559286160656025], [0.05040509231333379, 0.7920765760385999], [0.6730570500331025, 0.43920197072177647], [0.5046853734140418, 0.8960522514968512], [0.8776740768408433, 0.1790835184065669]], [[0.8490094926927774, 0.509738943367244], [0.10611794902967975, 0.31148371881176407], [0.6869457399805178, 0.8934339104024174], [0.10834973446285923, 0.6096531986075768], [0.6781289258578433, 0.2761770062776606]], [[0.7566405960191488, 0.10332831380885199], [0.23967688804073872, 0.0004909638000434313], [0.5027379168011387, 0.2634359551967086], [0.07806747249987345, 0.8808814535788626], [0.1986649848355725, 0.5673197885761175]], [[0.27146543026999426, 0.5974995756611501], [0.6542966336978888, 0.7255912918109767], [0.2957260786883503, 0.04725511839745611], [0.8572716479467147, 0.9692937868690089], [0.8862247187814873, 0.0826100486635939]], [[0.7851361948225405, 0.48600346460569954], [0.6321213368990781, 0.6117152506448345], [0.5350312900861803, 0.6750779395188993], [0.6163214285246219, 0.5768407836404841], [0.14282453313212085, 0.8649374486927179]], [[0.7534954225564147, 0.9643691999319113], [0.7917430034231375, 0.5825212709808835], [0.9171675510894148, 0.6542627086309983], [0.3101296897160739, 0.1755034140755074], [0.6043077792236501, 0.7361741349383045]], [[0.8241621349141813, 0.28528793945030007], [0.9020001416262257, 0.57797127623333], [0.7230930546644189, 0.8081328331130814], [0.9312819841207534, 0.289990347100786], [0.3924666186260425, 0.8999673054988357]], [[0.8344761384536681, 0.39913624400713854], [0.46733826584618987, 0.7171476260735233], [0.06124964610168604, 0.36731861557505674], [0.20623020019896543, 0.5187951836942049], [0.7721024261558168, 0.1299248666153754]], [[0.9867344571607256, 0.4671117103789836], [0.7730166870108943, 0.3524163469707189], [0.48813677815867584, 0.9648642416539138], [0.6902621570556147, 0.02565322014334337], [0.2319821333724862, 0.2592607569900818]], [[0.9589069246037626, 0.7695686699742229], [0.6786306171329429, 0.06965073866338123], [0.8038145253872696, 0.18167326150400886], [0.1487804745516349, 0.868849903679928], [0.005037143947434819, 0.06327988410322205]], [[0.919405988910597, 0.25155543032465877], [0.7743382743639662, 0.6571731874206858], [0.11223236229024414, 0.7949289033455931], [0.20739098558191005, 0.6954265810380523], [0.38085334257877945, 0.5447598583067481]], [[0.9462064596611349, 0.25917989038013245], [0.30109945732901333, 0.29252541670034893], [0.3700227270988288, 0.5766234372999974], [0.8002511926974083, 0.8931135181516047], [0.06118888421400459, 0.6500965350470767]], [[0.5924045964074958, 0.6009390590127149], [0.7933333118398577, 0.9378562651668003], [0.7482561622209642, 0.1716247004468472], [0.9546511627778134, 0.8652060263692287], [0.29965542624871067, 0.12225233413187131]], [[0.8059906020292564, 0.9763518248874802], [0.1274871080121842, 0.6513593483108809], [0.00983688804630789, 0.03549290758599155], [0.7851822102803689, 0.8155835834987643], [0.34934616318525513, 0.4479603705550499]], [[0.7794772004204293, 0.8577046552353005], [0.27610073226945986, 0.7842878718629166], [0.20087805194596364, 0.447342247226134], [0.7188972518081809, 0.6857984253448808], [0.5022890565359853, 0.6698734051908288]], [[0.05053289068985545, 0.28826725656167684], [0.21627296766803839, 0.0817930757153571], [0.20768913531876532, 0.860030137795244], [0.8962794072271126, 0.5331062449547115], [0.4843951385234718, 0.46316769990572126]], [[0.9590449876995076, 0.9408186758646101], [0.21648792168083886, 0.09499174929295195], [0.05438317079697519, 0.35766335219883605], [0.41754285101884936, 0.24767574408395998], [0.9202250725598798, 0.8371540042881199]], [[0.7444630740477364, 0.48389639682963925], [0.8864957683891219, 0.9451873550852263], [0.8876720001167115, 0.26136122759829694], [0.864227373869638, 0.350367111892548], [0.12326822327950848, 0.7436223991939167]], [[0.8088845605762284, 0.9867807625065831], [0.48095748408864913, 0.2510225380451314], [0.0653915207119099, 0.41318356937840384], [0.5774286250578069, 0.4964980821673213], [0.16278764942333757, 0.37154547043351427]], [[0.9179064455809042, 0.4592938600860984], [0.5122234455782525, 0.47191161877427], [0.3847152628605611, 0.06062709089521778], [0.22918450794406842, 0.49999783633137496], [0.5844328307136614, 0.4781379595073937]], [[0.363892774321953, 0.8034974713723212], [0.6947656127138895, 0.9454201508592324], [0.027735566309419535, 0.7440794496231079], [0.061375868570569536, 0.2909794376105618], [0.9171019676668435, 0.7753552964263154]], [[0.6620191624972286, 0.3996964716026705], [0.04982754879289264, 0.2602528047561462], [0.4808688173492526, 0.4227783928943333], [0.45813251100300023, 0.03031092932806112], [0.6330741052292851, 0.450965581916813]], [[0.016788717539566234, 0.9392133419198854], [0.19770042310267877, 0.16958959459097844], [0.7550940452057819, 0.3486631545579384], [0.6115483804677544, 0.005966140818971066], [0.4314338935964921, 0.024834011636247877]], [[0.2095618519843735, 0.19471741385123165], [0.9709267592269815, 0.3024130864849103], [0.8392513859259818, 0.4207565814952615], [0.8621293303877573, 0.662787229420753], [0.007092424504005601, 0.11160022513888179]], [[0.03134500685342623, 0.09044505460036967], [0.2203140698441196, 0.7855826878141747], [0.7336806308500963, 0.24471355617311696], [0.3904229415533713, 0.8594879351582494], [0.07232115926078597, 0.5648157586952375]], [[0.1150280632258407, 0.9940547264647431], [0.44164615237650484, 0.9152712849542888], [0.15298271232517446, 0.9903061733476891], [0.05930393369777698, 0.058922322349716394], [0.823237135957988, 0.7765922415254272]], [[0.2479367890394144, 0.24684592050718746], [0.47265508002614975, 0.9436025391802001], [0.6258865252974882, 0.83252965742245], [0.8671034216437681, 0.13444939263333489], [0.5788085311721809, 0.9869407771310376]], [[0.09564526644980575, 0.4435464415583168], [0.7648533177618654, 0.9895770615282798], [0.11971610468122029, 0.4044393011192855], [0.7529605618077507, 0.594079939445616], [0.878653066661659, 0.10214669075144611]], [[0.5425125613300261, 0.6091939126032528], [0.8142645395964124, 0.8456225589346785], [0.4741650601753056, 0.6043249058245652], [0.007852729347862963, 0.6890290240813922], [0.015446074678692634, 0.647088366463697]], [[0.5058960465114158, 0.9540597188367179], [0.1630740136830937, 0.3837767279336953], [0.8572975468766105, 0.5140953731250966], [0.8146243357120594, 0.5074254509305223], [0.6824019963534126, 0.8815425960548838]], [[0.054815826810139856, 0.8808580146316157], [0.17896065132071692, 0.7552970782992712], [0.5658311157694909, 0.33292240379798466], [0.958509719514732, 0.8414333018803417], [0.28555721607880014, 0.2026831541573314]], [[0.35899052869808656, 0.3321158147944514], [0.15975718713646014, 0.9374075729287451], [0.8876249722927216, 0.8748449947174181], [0.4557113195189696, 0.7896001398250442], [0.3603576642479248, 0.8605987936330923]], [[0.9064449642233711, 0.5382999249678899], [0.47619222605502154, 0.5326990745980137], [0.23812221804384903, 0.09185868065826786], [0.3869199915771737, 0.7840746259144714], [0.6817517685017292, 0.8408727234633308]], [[0.45146826478665736, 0.12427198034602849], [0.5226252331424385, 0.039490009784763136], [0.4308684180710993, 0.2014168609502891], [0.8442479168661324, 0.12892590586785047], [0.47463742271165144, 0.38513768759421674]], [[0.8453850946993839, 0.5616247030681413], [0.474954644495594, 0.5961940429332528], [0.23214111172609309, 0.5213835409110541], [0.3500375382514712, 0.10891793499403313], [0.7914985973135433, 0.3607954228610627]], [[0.2789112105308523, 0.0005696174167706403], [0.038004487981462276, 0.25184447127852916], [0.3295302892589168, 0.6991276180280982], [0.36845606233299866, 0.796524887914078], [0.5871662145403442, 0.35056705308389646]], [[0.15739744875697415, 0.0013694093405861585], [0.3831142751656631, 0.4067203069274563], [0.363891243584077, 0.8024040447137513], [0.09555528063360996, 0.11490222417943807], [0.2334633085686435, 0.5137327034226876]], [[0.7259014005916505, 0.9036637406018898], [0.2670948352502299, 0.1277993516828676], [0.5092144995565676, 0.29959241038929285], [0.9844920388544546, 0.03984251236828018], [0.19089503111390738, 0.7535587527636661]], [[0.3863775742798433, 0.5622381594924495], [0.8154518104347863, 0.6668632040987817], [0.6035510202410393, 0.6818236385748889], [0.06424465693991199, 0.0977992667178742], [0.607548945297341, 0.3678443386510687]], [[0.9957141910034085, 0.820659020038398], [0.9264784449316783, 0.1804632918399286], [0.6247302916366014, 0.02787741540551636], [0.7351423202400316, 0.04222165222392127], [0.6740795417269506, 0.21236884535128964]], [[0.591190988408334, 0.2759746873859379], [0.022402813798596766, 0.6855370491014435], [0.4486591441719292, 0.7242306625065876], [0.05628449839196492, 0.5302034215504031], [0.054266394648734284, 0.14384704566014284]], [[0.7844132574359453, 0.22867230474585065], [0.09332351731567312, 0.14180871772763115], [0.14143220951443436, 0.8438238909215371], [0.5899425367026359, 0.7923490214866913], [0.2572190963807842, 0.6263408324595985]], [[0.898907590987738, 0.533955490750817], [0.8707340561600945, 0.2180457146282806], [0.9669267000130077, 0.07969248856433797], [0.7611083597328594, 0.20171882428585908], [0.11688770194339293, 0.5590259315099929]], [[0.3170222825992334, 0.22251995129483693], [0.43912328973052506, 0.9884214329976069], [0.6326775584564301, 0.2786029655745439], [0.9859022031764596, 0.27916668089676155], [0.7196516118981996, 0.26333281453095747]], [[0.7743064479265209, 0.6439841243857556], [0.5727068625777555, 0.4588948742637152], [0.24284325984597044, 0.6094272384712242], [0.8743475491172846, 0.03130541405087395], [0.7326697388286103, 0.8799225351602699]], [[0.6168877802531492, 0.2584306324083787], [0.351475059441982, 0.7488048209052919], [0.36682236439769855, 0.008073156093916567], [0.10551829464223716, 0.285340370117794], [0.393169803189385, 0.36432472307178065]], [[0.806427721142235, 0.2215827361724947], [0.410313315633288, 0.8142268941187296], [0.793437280534362, 0.2052253062336432], [0.3640730122648922, 0.15631314954288356], [0.09009998820237053, 0.5541931862447058]], [[0.3194922423549149, 0.513689216526149], [0.5879098985780701, 0.6061922676092604], [0.9407652066938389, 0.2346492197003105], [0.8980852932299614, 0.05130866183311378], [0.03038283911238404, 0.10876806974633213]], [[0.6436891470845285, 0.5302935174584055], [0.16212318310708873, 0.14790494742126536], [0.5294293084233084, 0.9590058987642642], [0.18273000593743582, 0.25912951022509767], [0.12058329235131116, 0.5946018436715242]], [[0.9267692898592671, 0.23801514139715152], [0.47242126318133415, 0.9076145585613595], [0.7082831405747101, 0.5282866634645071], [0.6393067680449909, 0.7308395702343208], [0.7284784520843665, 0.4849771083474669]]])
    b = np.array([[[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]])
    np.testing.assert_allclose(tform(a), b)

def submit_random_crop():
    np.random.seed(0)
    tform = ndl.data.RandomCrop(0)
    for _ in range(2):
        size_a, size_b, size_c = np.random.randint(4,5), np.random.randint(4,6), np.random.randint(4,7)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))

    tform = ndl.data.RandomCrop(2)
    for _ in range(2):
        size_a, size_b, size_c = np.random.randint(4,5), np.random.randint(4,6), np.random.randint(4,7)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))


    tform = ndl.data.RandomCrop(3)
    for _ in range(2):
        ize_a, size_b, size_c = np.random.randint(4,5), np.random.randint(4,6), np.random.randint(4,7)
        mugrade.submit(tform(np.random.rand(size_a, size_b,size_c)))






def test_mnist_dataset():
    # Test dataset sizing
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz")
    assert len(mnist_train_dataset) == 60000

    sample_norms = np.array([np.linalg.norm(mnist_train_dataset[idx][0]) for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_against = np.array([10.188792, 6.261355, 8.966858, 9.4346485, 9.086626, 9.214664, 10.208544, 10.649756])
    sample_labels = np.array([mnist_train_dataset[idx][1] for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_labels = np.array([0,7,0,5,9,7,7,8])

    np.testing.assert_allclose(sample_norms, compare_against)
    np.testing.assert_allclose(sample_labels, compare_labels)

    mnist_train_dataset = ndl.data.MNISTDataset("data/t10k-images-idx3-ubyte.gz",
                                               "data/t10k-labels-idx1-ubyte.gz")
    assert len(mnist_train_dataset) == 10000

    sample_norms = np.array([np.linalg.norm(mnist_train_dataset[idx][0]) for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_against = np.array([9.857545, 8.980832, 8.57207 , 6.891522, 8.192135, 9.400087, 8.645003, 7.405202])
    sample_labels = np.array([mnist_train_dataset[idx][1] for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_labels = np.array([2, 4, 9, 6, 6, 9, 3, 1])

    np.testing.assert_allclose(sample_norms, compare_against, rtol=1e-5, atol=1e-5)
    np.testing.assert_allclose(sample_labels, compare_labels)

    # test a transform
    np.random.seed(0)
    tforms = [ndl.data.RandomCrop(28), ndl.data.RandomFlipHorizontal()]
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz",
                                                transforms=tforms)

    sample_norms = np.array([np.linalg.norm(mnist_train_dataset[idx][0]) for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_against = np.array([2.0228338 ,0.        ,7.4892044 ,0.,0.,3.8012788,9.583429,4.2152724])
    sample_labels = np.array([mnist_train_dataset[idx][1] for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_labels = np.array([0,7,0,5,9,7,7,8])

    np.testing.assert_allclose(sample_norms, compare_against)
    np.testing.assert_allclose(sample_labels, compare_labels)


    # test a transform
    tforms = [ndl.data.RandomCrop(12), ndl.data.RandomFlipHorizontal(0.4)]
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz",
                                                transforms=tforms)
    sample_norms = np.array([np.linalg.norm(mnist_train_dataset[idx][0]) for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_against = np.array([5.369537, 5.5454974, 8.966858, 7.547235, 8.785921, 7.848442, 7.1654058, 9.361828])
    sample_labels = np.array([mnist_train_dataset[idx][1] for idx in [1,42,1000,2000,3000,4000,5000,5005]])
    compare_labels = np.array([0,7,0,5,9,7,7,8])

    np.testing.assert_allclose(sample_norms, compare_against, rtol=1e-5, atol=1e-5)
    np.testing.assert_allclose(sample_labels, compare_labels)


def submit_mnist_dataset():
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz")
    mugrade.submit(mnist_train_dataset[69][:25])
    mugrade.submit(len(mnist_train_dataset))
    np.random.seed(0)
    tforms = [ndl.data.RandomFlipHorizontal()]
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz",
                                                transforms=tforms)

    for i in [822, 69, 420, 96]:
        mugrade.submit(mnist_train_dataset[i][:-25])


    tforms = [ndl.data.RandomCrop(15), ndl.data.RandomFlipHorizontal()]
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz",
                                                transforms=tforms)

    for i in [822, 69, 420, 96]:
        mugrade.submit(mnist_train_dataset[i][:-25])



def test_dataloader_mnist():
    batch_size = 1
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz")
    mnist_train_dataloader = ndl.data.DataLoader(dataset=mnist_train_dataset,
                                                 batch_size=batch_size,
                                                 shuffle=False)

    for i, batch in enumerate(mnist_train_dataloader):
        batch_x, batch_y = batch[0].numpy(), batch[1].numpy()
        truth = mnist_train_dataset[i * batch_size:(i + 1) * batch_size]
        truth_x = truth[0] if truth[0].shape[0] > 1 else truth[0].reshape(-1)
        truth_y = truth[1] if truth[1].shape[0] > 1 else truth[1].reshape(-1)

        np.testing.assert_allclose(truth_x, batch_x.flatten())
        np.testing.assert_allclose(batch_y, truth_y)

    batch_size = 5
    mnist_test_dataset = ndl.data.MNISTDataset("data/t10k-images-idx3-ubyte.gz",
                                               "data/t10k-labels-idx1-ubyte.gz")
    mnist_test_dataloader = ndl.data.DataLoader(dataset=mnist_test_dataset,
                                                batch_size=batch_size,
                                                shuffle=False)

    for i, batch in enumerate(mnist_test_dataloader):
        batch_x, batch_y = batch[0].numpy(), batch[1].numpy()
        truth = mnist_test_dataset[i * batch_size:(i + 1) * batch_size]
        truth_x = truth[0]
        truth_y = truth[1]

        np.testing.assert_allclose(truth_x, batch_x)
        np.testing.assert_allclose(batch_y, truth_y)



    noshuf = bat9 = ndl.data.DataLoader(dataset=mnist_test_dataset,
                                        batch_size=10,
                                        shuffle=False)
    shuf = bat9 = ndl.data.DataLoader(dataset=mnist_test_dataset,
                                      batch_size=10,
                                      shuffle=True)
    diff = False
    for i, j in zip(shuf, noshuf):
        if i != j:
            diff = True
            break
    assert diff, 'shuffling had no effect on the dataloader.'


def test_dataloader_ndarray():
    for batch_size in [1,10,100]:
      np.random.seed(0)
    
      train_dataset = ndl.data.NDArrayDataset(np.random.rand(100,10,10))
      train_dataloader = ndl.data.DataLoader(dataset=train_dataset,
                                                 batch_size=batch_size,
                                                 shuffle=False)

      for i, batch in enumerate(train_dataloader):
        batch_x  = batch[0].numpy()
        truth_x = train_dataset[i * batch_size:(i + 1) * batch_size][0].reshape((batch_size,10,10))
        np.testing.assert_allclose(truth_x, batch_x)

    batch_size = 1
    np.random.seed(0)
    train_dataset = ndl.data.NDArrayDataset(np.arange(100,))
    train_dataloader = iter(ndl.data.DataLoader(dataset=train_dataset,
                                                 batch_size=batch_size,
                                                 shuffle=True))

    elements = np.array([next(train_dataloader)[0].numpy().item() for _ in range(10)])
    np.testing.assert_allclose(elements, np.array([26, 86,  2, 55, 75, 93, 16, 73, 54, 95]))

    batch_size = 10
    train_dataset = ndl.data.NDArrayDataset(np.arange(100,))
    train_dataloader = iter(ndl.data.DataLoader(dataset=train_dataset,
                                                 batch_size=batch_size,
                                                 shuffle=True))

    elements = np.array([np.linalg.norm(next(train_dataloader)[0].numpy()) for _ in range(10)])
    np.testing.assert_allclose(elements, np.array([164.805946, 173.43875 , 169.841102, 189.050258, 195.880065, 206.387984, 209.909504, 185.776748, 145.948621, 160.252925]))

        




def submit_dataloader():
    batch_size = 1
    mnist_train_dataset = ndl.data.MNISTDataset("data/train-images-idx3-ubyte.gz",
                                                "data/train-labels-idx1-ubyte.gz")
    mnist_train_dataloader = ndl.data.DataLoader(dataset=mnist_train_dataset,
                                                 batch_size=batch_size,
                                                 shuffle=False)
    subl = []
    for i, batch in enumerate(mnist_train_dataloader):
        batch_x, batch_y = batch[0].numpy(), batch[1].numpy()
        subl.append(np.sum(batch_x[10:15,10:15]))
        subl.append(np.sum(batch_y))
        if i > 2:
            break
    mugrade.submit(subl)

    batch_size = 5
    mnist_test_dataset = ndl.data.MNISTDataset("data/t10k-images-idx3-ubyte.gz",
                                               "data/t10k-labels-idx1-ubyte.gz")
    mnist_test_dataloader = ndl.data.DataLoader(dataset=mnist_test_dataset,
                                                batch_size=batch_size,
                                                shuffle=False)

    subl_x = []
    subl_y = []
    for i, batch in enumerate(mnist_test_dataloader):
        batch_x, batch_y = batch[0].numpy(), batch[1].numpy()
        subl_x.append(batch_x[10:15,10:15])
        subl_y.append(batch_y)

    mugrade.submit(subl_x[-2:])
    mugrade.submit(subl_y[-2:])

    np.random.seed(0)
    shuf = ndl.data.DataLoader(dataset=mnist_test_dataset,
                               batch_size=10,
                               shuffle=True)
    subl_x = []
    subl_y = []
    for i, batch in enumerate(mnist_test_dataloader):
        batch_x, batch_y = batch[0].numpy(), batch[1].numpy()
        subl_x.append(batch_x[10:15,10:15])
        subl_y.append(batch_y)
        if i > 2:
            break
    mugrade.submit(subl_x)
    mugrade.submit(subl_y)



if __name__ == "__main__":
    test_flip_horizontal()
    test_random_crop()
    test_sequential_sampler()
    test_random_sampler()
    test_batch_sampler()
    test_collate_mnist()
    test_mnist_dataset()
    test_dataloader()
